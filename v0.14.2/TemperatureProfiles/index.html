<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Temperature Profiles · Thermodynamics.jl</title><meta name="title" content="Temperature Profiles · Thermodynamics.jl"/><meta property="og:title" content="Temperature Profiles · Thermodynamics.jl"/><meta property="twitter:title" content="Temperature Profiles · Thermodynamics.jl"/><meta name="description" content="Documentation for Thermodynamics.jl."/><meta property="og:description" content="Documentation for Thermodynamics.jl."/><meta property="twitter:description" content="Documentation for Thermodynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../src/assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Thermodynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Thermodynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Formulation/">Mathematical Formulation</a></li><li><a class="tocitem" href="../API/">API Reference</a></li><li><a class="tocitem" href="../HowToGuide/">How-To Guide</a></li><li class="is-active"><a class="tocitem" href>Temperature Profiles</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Available-Profiles"><span>Available Profiles</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li><li><a class="tocitem" href="#Applications"><span>Applications</span></a></li><li><a class="tocitem" href="#Integration-with-Thermodynamic-States"><span>Integration with Thermodynamic States</span></a></li><li><a class="tocitem" href="#Extending-the-Module"><span>Extending the Module</span></a></li></ul></li><li><a class="tocitem" href="../TestedProfiles/">Tested Profiles</a></li><li><a class="tocitem" href="../Clausius_Clapeyron/">Clausius-Clapeyron Validation</a></li><li><a class="tocitem" href="../SaturationAdjustmentConvergence/">Saturation Adjustment Convergence</a></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Temperature Profiles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Temperature Profiles</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl/blob/main/docs/src/TemperatureProfiles.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Atmospheric-Temperature-Profiles"><a class="docs-heading-anchor" href="#Atmospheric-Temperature-Profiles">Atmospheric Temperature Profiles</a><a id="Atmospheric-Temperature-Profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Atmospheric-Temperature-Profiles" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The <code>Thermodynamics.TemperatureProfiles</code> module provides pre-defined atmospheric temperature profiles for testing and validation purposes, and to be used as reference states in atmosphere models. These profiles represent idealized atmospheric conditions commonly used in climate modeling and thermodynamic testing.</p><h2 id="Available-Profiles"><a class="docs-heading-anchor" href="#Available-Profiles">Available Profiles</a><a id="Available-Profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Profiles" title="Permalink"></a></h2><p>Three temperature profiles are currently available:</p><ol><li><strong>IsothermalProfile</strong>: Constant temperature with height</li><li><strong>DecayingTemperatureProfile</strong>: Temperature decreases smoothly with height</li><li><strong>DryAdiabaticProfile</strong>: Temperature follows dry adiabatic lapse rate</li></ol><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><p>Each profile constructor requires two arguments:</p><ul><li><code>param_set</code>: A thermodynamic parameter set from <a href="https://github.com/CliMA/ClimaParams.jl">ClimaParams.jl</a></li><li><code>z</code>: Altitude (height above surface)</li></ul><p>The profiles return both temperature and pressure as a function of altitude.</p><h3 id="Isothermal-Profile"><a class="docs-heading-anchor" href="#Isothermal-Profile">Isothermal Profile</a><a id="Isothermal-Profile-1"></a><a class="docs-heading-anchor-permalink" href="#Isothermal-Profile" title="Permalink"></a></h3><p>A constant temperature profile, useful for testing thermodynamic calculations under uniform conditions.</p><pre><code class="language-julia hljs">import Thermodynamics as TD
import Plots
import ClimaParams as CP
import Thermodynamics.Parameters as TP
FT = Float64
param_set = TP.ThermodynamicsParameters(FT)
z = range(FT(0), stop = FT(2.5e4), length = 50);

isothermal = TD.TemperatureProfiles.IsothermalProfile(param_set, FT);
args = isothermal.(Ref(param_set), z);
T = first.(args);
p = last.(args);

p1 = Plots.plot(T, z./10^3, xlabel=&quot;Temperature [K]&quot;);
p2 = Plots.plot(p./10^3, z./10^3, xlabel=&quot;Pressure [kPa]&quot;);
Plots.plot(p1, p2, layout=(1,2), title=&quot;Isothermal&quot;, ylabel=&quot;z [km]&quot;);
Plots.savefig(&quot;isothermal.svg&quot;);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/Thermodynamics.jl/Thermodynamics.jl/docs/build/isothermal.svg&quot;</code></pre><p><img src="../isothermal.svg" alt/></p><h3 id="Decaying-Temperature-Profile"><a class="docs-heading-anchor" href="#Decaying-Temperature-Profile">Decaying Temperature Profile</a><a id="Decaying-Temperature-Profile-1"></a><a class="docs-heading-anchor-permalink" href="#Decaying-Temperature-Profile" title="Permalink"></a></h3><p>A profile where temperature decreases smoothly with height, representing typical atmospheric conditions.</p><pre><code class="language-julia hljs">import Thermodynamics as TD
import Plots
import ClimaParams as CP
import Thermodynamics.Parameters as TP
FT = Float64
param_set = TP.ThermodynamicsParameters(FT)
z = range(FT(0), stop = FT(2.5e4), length = 50);

decaying = TD.TemperatureProfiles.DecayingTemperatureProfile{FT}(param_set);
args = decaying.(Ref(param_set), z);
T = first.(args);
p = last.(args);

p1 = Plots.plot(T, z./10^3, xlabel=&quot;Temperature [K]&quot;);
p2 = Plots.plot(p./10^3, z./10^3, xlabel=&quot;Pressure [kPa]&quot;);
Plots.plot(p1, p2, layout=(1,2), ylabel=&quot;z [km]&quot;, title=&quot;Decaying&quot;);
Plots.savefig(&quot;decaying.svg&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/Thermodynamics.jl/Thermodynamics.jl/docs/build/decaying.svg&quot;</code></pre><p><img src="../decaying.svg" alt/></p><h3 id="Dry-Adiabatic-Profile"><a class="docs-heading-anchor" href="#Dry-Adiabatic-Profile">Dry Adiabatic Profile</a><a id="Dry-Adiabatic-Profile-1"></a><a class="docs-heading-anchor-permalink" href="#Dry-Adiabatic-Profile" title="Permalink"></a></h3><p>A profile following the dry adiabatic lapse rate, where potential temperature is constant with height.</p><pre><code class="language-julia hljs">import Thermodynamics as TD
import Plots
import ClimaParams as CP
import Thermodynamics.Parameters as TP
FT = Float64
param_set = TP.ThermodynamicsParameters(FT)
z = range(FT(0), stop = FT(2.5e4), length = 50);

dry_adiabatic = TD.TemperatureProfiles.DryAdiabaticProfile{FT}(param_set);
args = dry_adiabatic.(Ref(param_set), z)
T = first.(args)
p = last.(args)
θ_dry = TD.dry_pottemp_given_pressure.(Ref(param_set), T, p)

p1 = Plots.plot(T, z./10^3, xlabel=&quot;Temperature [K]&quot;);
p2 = Plots.plot(p./10^3, z./10^3, xlabel=&quot;Pressure [kPa]&quot;);
p3 = Plots.plot(θ_dry, z./10^3, xlabel=&quot;Potential temperature [K]&quot;);
Plots.plot(p1, p2, p3, layout=(1,3), ylabel=&quot;z [km]&quot;, title=&quot;Dry adiabatic&quot;)
Plots.savefig(&quot;dry_adiabatic.svg&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/Thermodynamics.jl/Thermodynamics.jl/docs/build/dry_adiabatic.svg&quot;</code></pre><p><img src="../dry_adiabatic.svg" alt/></p><h2 id="Applications"><a class="docs-heading-anchor" href="#Applications">Applications</a><a id="Applications-1"></a><a class="docs-heading-anchor-permalink" href="#Applications" title="Permalink"></a></h2><p>These temperature profiles are useful for:</p><ul><li><strong>Testing thermodynamic calculations</strong> under controlled conditions</li><li><strong>Benchmarking performance</strong> across different atmospheric conditions</li><li><strong>Educational purposes</strong> to understand atmospheric thermodynamics</li></ul><h2 id="Integration-with-Thermodynamic-States"><a class="docs-heading-anchor" href="#Integration-with-Thermodynamic-States">Integration with Thermodynamic States</a><a id="Integration-with-Thermodynamic-States-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-Thermodynamic-States" title="Permalink"></a></h2><p>Temperature profiles can be combined with thermodynamic state calculations:</p><pre><code class="language-julia hljs"># Example: Create thermodynamic states along a temperature profile
z = range(0, 25e3, length=100)  # 0 to 25 km
profile = TD.TemperatureProfiles.DryAdiabaticProfile{Float64}(param_set)

# Get temperature and pressure at each altitude
T_pairs = profile.(Ref(param_set), z)
T = first.(T_pairs)
p = last.(T_pairs)

# Create thermodynamic states
ts_states = [TD.PhaseDry_pT(param_set, p[i], T[i]) for i in 1:length(z)]</code></pre><h2 id="Extending-the-Module"><a class="docs-heading-anchor" href="#Extending-the-Module">Extending the Module</a><a id="Extending-the-Module-1"></a><a class="docs-heading-anchor-permalink" href="#Extending-the-Module" title="Permalink"></a></h2><p>Additional temperature profiles can be added by:</p><ol><li><strong>Creating a struct</strong> containing the parameters needed for the profile</li><li><strong>Implementing a functor</strong> that takes <code>(param_set, z)</code> and returns <code>(T, p)</code></li></ol><p>Example structure:</p><pre><code class="language-julia hljs">struct CustomProfile{FT} &lt;: TemperatureProfile{FT}
    # Profile parameters
end

function (profile::CustomProfile{FT})(param_set, z) where {FT}
    # Calculate T and p based on z
    return (T, p)
end</code></pre><div class="admonition is-info" id="Implementation-Details-95bd50a0113e564b"><header class="admonition-header">Implementation Details<a class="admonition-anchor" href="#Implementation-Details-95bd50a0113e564b" title="Permalink"></a></header><div class="admonition-body"><p>All profiles implement the <code>TemperatureProfile</code> interface and return temperature-pressure pairs as a function of altitude. The profiles are designed to be composable with other thermodynamic calculations.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../HowToGuide/">« How-To Guide</a><a class="docs-footer-nextpage" href="../TestedProfiles/">Tested Profiles »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 30 September 2025 06:55">Tuesday 30 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Thermodynamics.jl</title><meta name="title" content="API · Thermodynamics.jl"/><meta property="og:title" content="API · Thermodynamics.jl"/><meta property="twitter:title" content="API · Thermodynamics.jl"/><meta name="description" content="Documentation for Thermodynamics.jl."/><meta property="og:description" content="Documentation for Thermodynamics.jl."/><meta property="twitter:description" content="Documentation for Thermodynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Thermodynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Thermodynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Installation/">Installation</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Thermodynamics-Parameters"><span>Thermodynamics Parameters</span></a></li><li><a class="tocitem" href="#Thermodynamic-State-Constructors"><span>Thermodynamic State Constructors</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Thermodynamic-state-methods"><span>Thermodynamic state methods</span></a></li><li><a class="tocitem" href="#Internal-methods"><span>Internal methods</span></a></li><li><a class="tocitem" href="#Dispatch-types"><span>Dispatch types</span></a></li><li><a class="tocitem" href="#Temperature-Profiles"><span>Temperature Profiles</span></a></li><li><a class="tocitem" href="#Tested-profiles"><span>Tested profiles</span></a></li><li><a class="tocitem" href="#Data-collection"><span>Data collection</span></a></li></ul></li><li><a class="tocitem" href="../HowToGuide/">How-to-guide</a></li><li><a class="tocitem" href="../TestedProfiles/">Tested profiles</a></li><li><a class="tocitem" href="../TemperatureProfiles/">Temperature profiles</a></li><li><a class="tocitem" href="../DevDocs/">Developer docs</a></li><li><a class="tocitem" href="../Clausius_Clapeyron/">Clausius Clapeyron relation</a></li><li><a class="tocitem" href="../Formulation/">Thermodynamics overview</a></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl/blob/main/docs/src/API.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Thermodynamics"><a class="docs-heading-anchor" href="#Thermodynamics">Thermodynamics</a><a id="Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.Thermodynamics" href="#Thermodynamics.Thermodynamics"><code>Thermodynamics.Thermodynamics</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">Thermodynamics</code></pre><p>Moist thermodynamic functions, e.g., for air pressure (atmosphere equation of state), latent heats of phase transitions, saturation vapor pressures, and saturation specific humidities.</p><p><strong>AbstractParameterSet&#39;s</strong></p><p>Many functions defined in this module rely on CLIMAParameters.jl. CLIMAParameters.jl defines several functions (e.g., many planet parameters). For example, to compute the mole-mass ratio:</p><pre><code class="language-julia hljs">import CLIMAParameters as CP
import Thermodynamics.Parameters as TP
toml_dict = CP.create_toml_dict(FT; dict_type = &quot;alias&quot;)
aliases = string.(fieldnames(TP.ThermodynamicsParameters))
param_pairs = CP.get_parameter_values!(toml_dict, aliases, &quot;Thermodynamics&quot;)
param_set = TP.ThermodynamicsParameters{FT}(; param_pairs...)
_molmass_ratio = TP.molmass_ratio(param_set)</code></pre><p>Because these parameters are widely used throughout this module, <code>param_set</code> is an argument for many Thermodynamics functions.</p><p><strong>Numerical methods for saturation adjustment</strong></p><p>Saturation adjustment function are designed to accept</p><ul><li><code>sat_adjust_method</code> a type used to dispatch which numerical method to use</li></ul><p>and a function to return an instance of the numerical method. For example:</p><ul><li><code>sa_numerical_method_ρpq</code> returns an instance of the numerical  method. One of these functions must be defined for the particular  numerical method and the particular formulation (<code>ρ-p-q_tot</code> in this case).</li></ul><p>The currently supported numerical methods, in RootSolvers.jl, are:</p><ul><li><code>NewtonsMethod</code> uses Newton method with analytic gradients</li><li><code>NewtonsMethodAD</code> uses Newton method with autodiff</li><li><code>SecantMethod</code> uses Secant method</li><li><code>RegulaFalsiMethod</code> uses Regula-Falsi method</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/Thermodynamics.jl#L1-L44">source</a></section></article><h2 id="Thermodynamics-Parameters"><a class="docs-heading-anchor" href="#Thermodynamics-Parameters">Thermodynamics Parameters</a><a id="Thermodynamics-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics-Parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.Parameters.ThermodynamicsParameters" href="#Thermodynamics.Parameters.ThermodynamicsParameters"><code>Thermodynamics.Parameters.ThermodynamicsParameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ThermodynamicsParameters</code></pre><p>Parameters for Thermodynamics.jl.</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">import CLIMAParameters as CP
import Thermodynamics.Parameters as TP
FT = Float64;
toml_dict = CP.create_toml_dict(FT; dict_type = &quot;alias&quot;);
aliases = string.(fieldnames(TP.ThermodynamicsParameters));
param_pairs = CP.get_parameter_values!(toml_dict, aliases, &quot;Thermodynamics&quot;);
param_set = TP.ThermodynamicsParameters{FT}(; param_pairs...);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/Parameters.jl#L5-L20">source</a></section></article><h2 id="Thermodynamic-State-Constructors"><a class="docs-heading-anchor" href="#Thermodynamic-State-Constructors">Thermodynamic State Constructors</a><a id="Thermodynamic-State-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamic-State-Constructors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhasePartition" href="#Thermodynamics.PhasePartition"><code>Thermodynamics.PhasePartition</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PhasePartition</code></pre><p>Represents the mass fractions of the moist air mixture.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhasePartition(q_tot::Real[, q_liq::Real[, q_ice::Real]])
PhasePartition(param_set::APS, ts::ThermodynamicState)</code></pre><p>See also <a href="#Thermodynamics.PhasePartition_equil"><code>PhasePartition_equil</code></a></p><p><strong>Fields</strong></p><ul><li><p><code>tot</code>: total specific humidity</p></li><li><p><code>liq</code>: liquid water specific humidity (default: <code>0</code>)</p></li><li><p><code>ice</code>: ice specific humidity (default: <code>0</code>)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L47-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.ThermodynamicState" href="#Thermodynamics.ThermodynamicState"><code>Thermodynamics.ThermodynamicState</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ThermodynamicState{FT}</code></pre><p>A thermodynamic state, which can be initialized for various thermodynamic formulations (via its sub-types). All <code>ThermodynamicState</code>&#39;s have access to functions to compute all other thermodynamic properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L31-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry" href="#Thermodynamics.PhaseDry"><code>Thermodynamics.PhaseDry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PhaseDry{FT} &lt;: AbstractPhaseDry</code></pre><p>A dry thermodynamic state (<code>q_tot = 0</code>).</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhaseDry(param_set, e_int, ρ)</code></pre><p><strong>Fields</strong></p><ul><li><p><code>e_int</code>: internal energy</p></li><li><p><code>ρ</code>: density of dry air</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L93-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_ρe" href="#Thermodynamics.PhaseDry_ρe"><code>Thermodynamics.PhaseDry_ρe</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_ρe(param_set, ρ, e_int)</code></pre><p>A dry thermodynamic state (<code>q_tot = 0</code>) from</p><ul><li><code>param_set</code> an <a href="#Thermodynamics.Parameters.ThermodynamicsParameters"><code>ThermodynamicsParameters</code></a> for more details</li><li><code>ρ</code></li><li><code>e_int</code> internal energy</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L117-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_pT" href="#Thermodynamics.PhaseDry_pT"><code>Thermodynamics.PhaseDry_pT</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_pT(param_set, p, T)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L129-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_pθ" href="#Thermodynamics.PhaseDry_pθ"><code>Thermodynamics.PhaseDry_pθ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_pθ(param_set, p, θ_dry)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>θ_dry</code> dry potential temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L190-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_pe" href="#Thermodynamics.PhaseDry_pe"><code>Thermodynamics.PhaseDry_pe</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_pe(param_set, p, e_int)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>e_int</code> internal energy</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L144-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_ph" href="#Thermodynamics.PhaseDry_ph"><code>Thermodynamics.PhaseDry_ph</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_ph(param_set, p, h)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>h</code> specific enthalpy</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L159-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_ρθ" href="#Thermodynamics.PhaseDry_ρθ"><code>Thermodynamics.PhaseDry_ρθ</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_ρθ(param_set, ρ, θ_dry)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>θ_dry</code> dry potential temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L175-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_ρT" href="#Thermodynamics.PhaseDry_ρT"><code>Thermodynamics.PhaseDry_ρT</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_ρT(param_set, ρ, T)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L206-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseDry_ρp" href="#Thermodynamics.PhaseDry_ρp"><code>Thermodynamics.PhaseDry_ρp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseDry_ρp(param_set, ρ, p)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>p</code> pressure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L220-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil" href="#Thermodynamics.PhaseEquil"><code>Thermodynamics.PhaseEquil</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil{FT} &lt;: AbstractPhaseEquil</code></pre><p>A thermodynamic state assuming thermodynamic equilibrium (therefore, saturation adjustment may be needed).</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhaseEquil(param_set, ρ, e_int, q_tot)</code></pre><p><strong>Fields</strong></p><ul><li><p><code>ρ</code>: density of air (potentially moist)</p></li><li><p><code>p</code>: air pressure</p></li><li><p><code>e_int</code>: internal energy</p></li><li><p><code>q_tot</code>: total specific humidity</p></li><li><p><code>T</code>: temperature: computed via <a href="#Thermodynamics.saturation_adjustment"><code>saturation_adjustment</code></a></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L239-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_ρeq" href="#Thermodynamics.PhaseEquil_ρeq"><code>Thermodynamics.PhaseEquil_ρeq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_ρeq(param_set, ρ, e_int, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Moist thermodynamic phase, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>e_int</code> internal energy</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for saturation adjustment</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment</li><li><code>sat_adjust_method</code> the numerical method to use.  See the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L268-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_ρTq" href="#Thermodynamics.PhaseEquil_ρTq"><code>Thermodynamics.PhaseEquil_ρTq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_ρTq(param_set, ρ, T, q_tot)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from temperature.</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>T</code> temperature</li><li><code>q_tot</code> total specific humidity</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L381-L390">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_pTq" href="#Thermodynamics.PhaseEquil_pTq"><code>Thermodynamics.PhaseEquil_pTq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_pTq(param_set, p, T, q_tot)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from temperature.</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li><li><code>q_tot</code> total specific humidity</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L404-L413">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_pθq" href="#Thermodynamics.PhaseEquil_pθq"><code>Thermodynamics.PhaseEquil_pθq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_pθq(param_set, θ_liq_ice, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> air pressure</li><li><code>θ_liq_ice</code> liquid-ice potential temperature</li><li><code>q_tot</code> total specific humidity</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment</li><li><code>maxiter</code> maximum iterations for saturation adjustment</li><li><code>sat_adjust_method</code> the numerical method to use.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L569-L582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_peq" href="#Thermodynamics.PhaseEquil_peq"><code>Thermodynamics.PhaseEquil_peq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_peq(param_set, p, e_int, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from temperature.</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>e_int</code> temperature</li><li><code>q_tot</code> total specific humidity</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L428-L438">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_phq" href="#Thermodynamics.PhaseEquil_phq"><code>Thermodynamics.PhaseEquil_phq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_phq(param_set, p, h, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from temperature.</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>h</code> specific enthalpy</li><li><code>q_tot</code> total specific humidity</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L471-L481">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_ρθq" href="#Thermodynamics.PhaseEquil_ρθq"><code>Thermodynamics.PhaseEquil_ρθq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_ρθq(param_set, ρ, θ_liq_ice, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>θ_liq_ice</code> liquid-ice potential temperature</li><li><code>q_tot</code> total specific humidity</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment</li><li><code>maxiter</code> maximum iterations for saturation adjustment</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L338-L350">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseEquil_ρpq" href="#Thermodynamics.PhaseEquil_ρpq"><code>Thermodynamics.PhaseEquil_ρpq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseEquil_ρpq(param_set, ρ, p, q_tot[, perform_sat_adjust=true, maxiter, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from temperature.</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>p</code> pressure</li><li><code>q_tot</code> total specific humidity</li><li><code>perform_sat_adjust</code> Bool indicating to perform saturation adjustment</li><li><code>maxiter</code> maximum number of iterations to perform in saturation adjustment</li><li><code>sat_adjust_method</code> the numerical method to use.  See the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>TODO: change input argument order: perform<em>sat</em>adjust is       unique to this constructor, so it should be last.       (breaking change)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L514-L532">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil" href="#Thermodynamics.PhaseNonEquil"><code>Thermodynamics.PhaseNonEquil</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs"> PhaseNonEquil{FT} &lt;: ThermodynamicState</code></pre><p>A thermodynamic state assuming thermodynamic non-equilibrium (therefore, temperature can be computed directly).</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhaseNonEquil(param_set, e_int, q::PhasePartition, ρ)</code></pre><p><strong>Fields</strong></p><ul><li><p><code>e_int</code>: internal energy</p></li><li><p><code>ρ</code>: density of air (potentially moist)</p></li><li><p><code>q</code>: phase partition</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L620-L634">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_ρTq" href="#Thermodynamics.PhaseNonEquil_ρTq"><code>Thermodynamics.PhaseNonEquil_ρTq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_ρTq(param_set, ρ, T, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>T</code> temperature</li><li><code>q_pt</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L655-L664">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_pTq" href="#Thermodynamics.PhaseNonEquil_pTq"><code>Thermodynamics.PhaseNonEquil_pTq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_pTq(param_set, p, T, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> air temperature</li><li><code>q_pt</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L732-L741">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_ρθq" href="#Thermodynamics.PhaseNonEquil_ρθq"><code>Thermodynamics.PhaseNonEquil_ρθq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_ρθq(param_set, ρ, θ_liq_ice, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>θ_liq_ice</code> liquid-ice potential temperature</li><li><code>q_pt</code> phase partition</li></ul><p>and, optionally</p><ul><li><code>relative_temperature_tol</code> potential temperature for non-linear equation solve</li><li><code>maxiter</code> maximum iterations for non-linear equation solve</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L675-L687">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_pθq" href="#Thermodynamics.PhaseNonEquil_pθq"><code>Thermodynamics.PhaseNonEquil_pθq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_pθq(param_set, p, θ_liq_ice, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>θ_liq_ice</code> liquid-ice potential temperature</li><li><code>q_pt</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L710-L719">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_peq" href="#Thermodynamics.PhaseNonEquil_peq"><code>Thermodynamics.PhaseNonEquil_peq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_peq(param_set, p, e_int, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>e_int</code> internal energy</li><li><code>q_pt</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L753-L762">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_phq" href="#Thermodynamics.PhaseNonEquil_phq"><code>Thermodynamics.PhaseNonEquil_phq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_phq(param_set, p, e_int, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>h</code> specific enthalpy</li><li><code>q_pt</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L774-L783">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhaseNonEquil_ρpq" href="#Thermodynamics.PhaseNonEquil_ρpq"><code>Thermodynamics.PhaseNonEquil_ρpq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhaseNonEquil_ρpq(param_set, ρ, p, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from:</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>p</code> pressure</li><li><code>q_pt</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/states.jl#L796-L805">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.Ice" href="#Thermodynamics.Ice"><code>Thermodynamics.Ice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Ice &lt;: Phase</code></pre><p>An ice phase, to dispatch over <a href="#Thermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a> and <a href="#Thermodynamics.q_vap_saturation_generic"><code>q_vap_saturation_generic</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L847-L853">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.Liquid" href="#Thermodynamics.Liquid"><code>Thermodynamics.Liquid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Liquid &lt;: Phase</code></pre><p>A liquid phase, to dispatch over <a href="#Thermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a> and <a href="#Thermodynamics.q_vap_saturation_generic"><code>q_vap_saturation_generic</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L838-L844">source</a></section></article><h2 id="Thermodynamic-state-methods"><a class="docs-heading-anchor" href="#Thermodynamic-state-methods">Thermodynamic state methods</a><a id="Thermodynamic-state-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamic-state-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.air_density" href="#Thermodynamics.air_density"><code>Thermodynamics.air_density</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">air_density(param_set, T, p[, q::PhasePartition])</code></pre><p>The (moist-)air density from the equation of state (ideal gas law) where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> air temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L131-L142">source</a></section><section><div><pre><code class="language-julia hljs">air_density(param_set::APS, ts::ThermodynamicState)</code></pre><p>The (moist-)air density, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L152-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.air_pressure" href="#Thermodynamics.air_pressure"><code>Thermodynamics.air_pressure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">air_pressure(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The air pressure from the equation of state (ideal gas law) where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> air temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L95-L106">source</a></section><section><div><pre><code class="language-julia hljs">air_pressure(param_set::APS, ts::ThermodynamicState)</code></pre><p>The air pressure from the equation of state (ideal gas law), given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L116-L121">source</a></section><section><div><pre><code class="language-julia hljs">air_pressure(param_set, T::FT, T∞::FT, p∞::FT, ::DryAdiabaticProcess)</code></pre><p>The air pressure for an isentropic process, where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>T∞</code> ambient temperature</li><li><code>p∞</code> ambient pressure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/isentropic.jl#L37-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.air_temperature" href="#Thermodynamics.air_temperature"><code>Thermodynamics.air_temperature</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">air_temperature(param_set, e_int, q::PhasePartition)</code></pre><p>The air temperature, where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_int</code> internal energy per unit mass</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L349-L358">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set::APS, ts::ThermodynamicState)</code></pre><p>The air temperature, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L402-L406">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, p::FT, θ::FT, Φ::FT, ::DryAdiabaticProcess)</code></pre><p>The air temperature for an isentropic process, where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>θ</code> potential temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/isentropic.jl#L58-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.condensate" href="#Thermodynamics.condensate"><code>Thermodynamics.condensate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">condensate(q::PhasePartition{FT})
condensate(param_set::APS, ts::ThermodynamicState)</code></pre><p>Condensate of the phase partition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1251-L1256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.cp_m" href="#Thermodynamics.cp_m"><code>Thermodynamics.cp_m</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cp_m(param_set, q::PhasePartition)</code></pre><p>The isobaric specific heat capacity of moist air given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L250-L256">source</a></section><section><div><pre><code class="language-julia hljs">cp_m(param_set::APS, ts::ThermodynamicState)</code></pre><p>The isobaric specific heat capacity of moist air, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L271-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.cv_m" href="#Thermodynamics.cv_m"><code>Thermodynamics.cv_m</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cv_m(param_set, q::PhasePartition)</code></pre><p>The isochoric specific heat capacity of moist air given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L281-L287">source</a></section><section><div><pre><code class="language-julia hljs">cv_m(param_set::APS, ts::ThermodynamicState)</code></pre><p>The isochoric specific heat capacity of moist air, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L302-L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.dry_pottemp" href="#Thermodynamics.dry_pottemp"><code>Thermodynamics.dry_pottemp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dry_pottemp(param_set, T, ρ[, q::PhasePartition, cpm])</code></pre><p>The dry potential temperature where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul><pre><code class="nohighlight hljs"></code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2247-L2257">source</a></section><section><div><pre><code class="language-julia hljs">dry_pottemp(param_set::APS, ts::ThermodynamicState)</code></pre><p>The dry potential temperature, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2289-L2293">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.exner" href="#Thermodynamics.exner"><code>Thermodynamics.exner</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">exner(param_set, T, ρ[, q::PhasePartition)])</code></pre><p>The Exner function where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2651-L2660">source</a></section><section><div><pre><code class="language-julia hljs">exner(param_set::APS, ts::ThermodynamicState)</code></pre><p>The Exner function, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2672-L2676">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.gas_constant_air" href="#Thermodynamics.gas_constant_air"><code>Thermodynamics.gas_constant_air</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gas_constant_air(param_set, [q::PhasePartition])</code></pre><p>The specific gas constant of moist air given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L66-L72">source</a></section><section><div><pre><code class="language-julia hljs">gas_constant_air(param_set::APS, ts::ThermodynamicState)</code></pre><p>The specific gas constant of moist air given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.gas_constants" href="#Thermodynamics.gas_constants"><code>Thermodynamics.gas_constants</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">(R_m, cp_m, cv_m, γ_m) = gas_constants(param_set, q::PhasePartition)</code></pre><p>Wrapper to compute all gas constants at once, where optionally,</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul><p>The function returns a tuple of</p><ul><li><code>R_m</code> <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>cp_m</code> <a href="#Thermodynamics.cp_m"><code>cp_m</code></a></li><li><code>cv_m</code> <a href="#Thermodynamics.cv_m"><code>cv_m</code></a></li><li><code>γ_m = cp_m/cv_m</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L313-L325">source</a></section><section><div><pre><code class="language-julia hljs">(R_m, cp_m, cv_m, γ_m) = gas_constants(param_set::APS, ts::ThermodynamicState)</code></pre><p>Wrapper to compute all gas constants at once, given a thermodynamic state <code>ts</code>.</p><p>The function returns a tuple of</p><ul><li><code>R_m</code> <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>cp_m</code> <a href="#Thermodynamics.cp_m"><code>cp_m</code></a></li><li><code>cv_m</code> <a href="#Thermodynamics.cv_m"><code>cv_m</code></a></li><li><code>γ_m = cp_m/cv_m</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L334-L345">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.has_condensate" href="#Thermodynamics.has_condensate"><code>Thermodynamics.has_condensate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">has_condensate(q::PhasePartition{FT})
has_condensate(param_set::APS, ts::ThermodynamicState)</code></pre><p>Bool indicating if condensate exists in the phase partition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1261-L1267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.ice_specific_humidity" href="#Thermodynamics.ice_specific_humidity"><code>Thermodynamics.ice_specific_humidity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ice_specific_humidity(param_set::APS, ts::ThermodynamicState)
ice_specific_humidity(q::PhasePartition)</code></pre><p>Ice specific humidity given</p><ul><li><code>ts</code> a thermodynamic state</li></ul><p>or</p><ul><li><code>q</code> a <code>PhasePartition</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L200-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.internal_energy" href="#Thermodynamics.internal_energy"><code>Thermodynamics.internal_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">internal_energy(param_set, T[, q::PhasePartition])</code></pre><p>The internal energy per unit mass, given a thermodynamic state <code>ts</code> or</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L435-L444">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy(param_set::APS, ts::ThermodynamicState)</code></pre><p>The internal energy per unit mass, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L458-L462">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy(ρ::FT, ρe::FT, ρu::AbstractVector{FT}, e_pot::FT)</code></pre><p>The internal energy per unit mass, given</p><ul><li><code>ρ</code> (moist-)air density</li><li><code>ρe</code> total energy per unit volume</li><li><code>ρu</code> momentum vector</li><li><code>e_pot</code> potential energy (e.g., gravitational) per unit mass</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L465-L473">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.internal_energy_dry" href="#Thermodynamics.internal_energy_dry"><code>Thermodynamics.internal_energy_dry</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">internal_energy_dry(param_set, T)</code></pre><p>The dry air internal energy</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L488-L495">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_dry(param_set::APS, ts::ThermodynamicState)</code></pre><p>The the dry air internal energy, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L503-L507">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.internal_energy_vapor" href="#Thermodynamics.internal_energy_vapor"><code>Thermodynamics.internal_energy_vapor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">internal_energy_vapor(param_set, T)</code></pre><p>The water vapor internal energy</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L511-L518">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_vapor(param_set::APS, ts::ThermodynamicState)</code></pre><p>The the water vapor internal energy, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L527-L531">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.internal_energy_liquid" href="#Thermodynamics.internal_energy_liquid"><code>Thermodynamics.internal_energy_liquid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">internal_energy_liquid(param_set, T)</code></pre><p>The liquid water internal energy</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L535-L542">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_liquid(param_set::APS, ts::ThermodynamicState)</code></pre><p>The the liquid water internal energy, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L550-L554">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.internal_energy_ice" href="#Thermodynamics.internal_energy_ice"><code>Thermodynamics.internal_energy_ice</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">internal_energy_ice(param_set, T)</code></pre><p>The ice internal energy</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L558-L565">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_ice(param_set::APS, ts::ThermodynamicState)</code></pre><p>The the ice internal energy, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L574-L578">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.internal_energy_sat" href="#Thermodynamics.internal_energy_sat"><code>Thermodynamics.internal_energy_sat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">internal_energy_sat(param_set, T, ρ, q_tot, phase_type)</code></pre><p>The internal energy per unit mass in thermodynamic equilibrium at saturation where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L582-L592">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_sat(param_set::APS, ts::ThermodynamicState)</code></pre><p>The internal energy per unit mass in thermodynamic equilibrium at saturation, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L611-L617">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.latent_heat_fusion" href="#Thermodynamics.latent_heat_fusion"><code>Thermodynamics.latent_heat_fusion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">latent_heat_fusion(param_set, T::FT) where {FT&lt;:Real}</code></pre><p>The specific latent heat of fusion where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L768-L774">source</a></section><section><div><pre><code class="language-julia hljs">latent_heat_fusion(param_set::APS, ts::ThermodynamicState)</code></pre><p>The specific latent heat of fusion given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L782-L787">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.latent_heat_liq_ice" href="#Thermodynamics.latent_heat_liq_ice"><code>Thermodynamics.latent_heat_liq_ice</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">latent_heat_liq_ice(param_set, q::PhasePartition{FT})</code></pre><p>Effective latent heat of condensate (weighted sum of liquid and ice), with specific latent heat evaluated at reference temperature <code>T_0</code> given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2166-L2173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.latent_heat_sublim" href="#Thermodynamics.latent_heat_sublim"><code>Thermodynamics.latent_heat_sublim</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">latent_heat_sublim(param_set, T::FT) where {FT&lt;:Real}</code></pre><p>The specific latent heat of sublimation where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L745-L751">source</a></section><section><div><pre><code class="language-julia hljs">latent_heat_sublim(param_set::APS, ts::ThermodynamicState)</code></pre><p>The specific latent heat of sublimation given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L759-L764">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.latent_heat_vapor" href="#Thermodynamics.latent_heat_vapor"><code>Thermodynamics.latent_heat_vapor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">latent_heat_vapor(param_set, T::FT) where {FT&lt;:Real}</code></pre><p>The specific latent heat of vaporization where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L722-L728">source</a></section><section><div><pre><code class="language-julia hljs">latent_heat_vapor(param_set::APS, ts::ThermodynamicState)</code></pre><p>The specific latent heat of vaporization given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L736-L741">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.liquid_fraction" href="#Thermodynamics.liquid_fraction"><code>Thermodynamics.liquid_fraction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">liquid_fraction(param_set, T, phase_type[, q])</code></pre><p>The fraction of condensate that is liquid where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p><strong>PhaseNonEquil behavior</strong></p><p>If <code>q.liq</code> or <code>q.ice</code> are nonzero, the liquid fraction is computed from them.</p><p><strong>ThermodynamicState</strong></p><p>Otherwise, phase equilibrium is assumed so that the fraction of liquid is a function that is 1 above <code>T_freeze</code> and goes to zero below <code>T_icenuc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1274-L1289">source</a></section><section><div><pre><code class="language-julia hljs">liquid_fraction(param_set::APS, ts::ThermodynamicState)</code></pre><p>The fraction of condensate that is liquid given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1327-L1331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.liquid_ice_pottemp" href="#Thermodynamics.liquid_ice_pottemp"><code>Thermodynamics.liquid_ice_pottemp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp(param_set, T, ρ[, q::PhasePartition, cpm])</code></pre><p>The liquid-ice potential temperature where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2208-L2217">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp(param_set::APS, ts::ThermodynamicState)</code></pre><p>The liquid-ice potential temperature, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2234-L2239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.liquid_ice_pottemp_sat" href="#Thermodynamics.liquid_ice_pottemp_sat"><code>Thermodynamics.liquid_ice_pottemp_sat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_sat(param_set, T, ρ, phase_type[, q::PhasePartition, cpm])</code></pre><p>The saturated liquid ice potential temperature where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2567-L2578">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_sat(param_set, T, ρ, phase_type, q_tot)</code></pre><p>The saturated liquid ice potential temperature where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>q_tot</code> total specific humidity</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2591-L2601">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_sat(param_set::APS, ts::ThermodynamicState)</code></pre><p>The liquid potential temperature given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2614-L2618">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.liquid_specific_humidity" href="#Thermodynamics.liquid_specific_humidity"><code>Thermodynamics.liquid_specific_humidity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">liquid_specific_humidity(param_set::APS, ts::ThermodynamicState)
liquid_specific_humidity(q::PhasePartition)</code></pre><p>Liquid specific humidity given</p><ul><li><code>ts</code> a thermodynamic state</li></ul><p>or</p><ul><li><code>q</code> a <code>PhasePartition</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L184-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.mixing_ratios" href="#Thermodynamics.mixing_ratios"><code>Thermodynamics.mixing_ratios</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mixing_ratios(q::PhasePartition)</code></pre><p>Mixing ratios</p><ul><li><code>r.tot</code> total mixing ratio</li><li><code>r.liq</code> liquid mixing ratio</li><li><code>r.ice</code> ice mixing ratio</li></ul><p>given a phase partition, <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2695-L2703">source</a></section><section><div><pre><code class="language-julia hljs">mixing_ratios(param_set::APS, ts::ThermodynamicState)</code></pre><p>Mixing ratios stored, in a phase partition, for</p><ul><li>total specific humidity</li><li>liquid specific humidity</li><li>ice specific humidity</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2712-L2719">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.vol_vapor_mixing_ratio" href="#Thermodynamics.vol_vapor_mixing_ratio"><code>Thermodynamics.vol_vapor_mixing_ratio</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vol_vapor_mixing_ratio(param_set, q::PhasePartition)</code></pre><p>Volume mixing ratio of water vapor given a parameter set <code>param_set</code> and a phase partition, <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2723-L2729">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.moist_static_energy" href="#Thermodynamics.moist_static_energy"><code>Thermodynamics.moist_static_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">moist_static_energy(param_set, ts, e_pot)</code></pre><p>Moist static energy, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ts</code> a thermodynamic state</li><li><code>e_pot</code> potential energy (e.g., gravitational) per unit mass</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2885-L2892">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.virtual_dry_static_energy" href="#Thermodynamics.virtual_dry_static_energy"><code>Thermodynamics.virtual_dry_static_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_dry_static_energy(param_set, ts, e_pot)</code></pre><p>Virtual dry static energy, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ts</code> a thermodynamic state</li><li><code>e_pot</code> gravitational potential energy per unit mass</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2901-L2908">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.q_vap_saturation" href="#Thermodynamics.q_vap_saturation"><code>Thermodynamics.q_vap_saturation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">q_vap_saturation(param_set, T, ρ, phase_type[, q::PhasePartition])</code></pre><p>Compute the saturation specific humidity, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>If the <code>PhasePartition</code> <code>q</code> is given, the saturation specific humidity is that of a mixture of liquid and ice, computed in a thermodynamically consistent way from the weighted sum of the latent heats of the respective phase transitions (Pressel et al., JAMES, 2015). That is, the saturation vapor pressure and from it the saturation specific humidity are computed from a weighted mean of the latent heats of vaporization and sublimation, with the weights given by the fractions of condensates <code>q.liq/(q.liq + q.ice)</code> and <code>q.ice/(q.liq + q.ice)</code> that are liquid and ice, respectively.</p><p>If the <code>PhasePartition</code> <code>q</code> is not given, or has zero liquid and ice specific humidities, the saturation specific humidity is that over a mixture of liquid and ice, with the fraction of liquid given by temperature dependent <code>liquid_fraction(param_set, T, phase_type)</code> and the fraction of ice by the complement <code>1 - liquid_fraction(param_set, T, phase_type)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1013-L1037">source</a></section><section><div><pre><code class="language-julia hljs">q_vap_saturation(param_set::APS, ts::ThermodynamicState)</code></pre><p>Compute the saturation specific humidity, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1050-L1054">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.q_vap_saturation_liquid" href="#Thermodynamics.q_vap_saturation_liquid"><code>Thermodynamics.q_vap_saturation_liquid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">q_vap_saturation_liquid(param_set::APS, ts::ThermodynamicState)</code></pre><p>Compute the saturation specific humidity over liquid, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1063-L1068">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.q_vap_saturation_ice" href="#Thermodynamics.q_vap_saturation_ice"><code>Thermodynamics.q_vap_saturation_ice</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">q_vap_saturation_ice(param_set::APS, ts::ThermodynamicState)</code></pre><p>Compute the saturation specific humidity over ice, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1076-L1081">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.relative_humidity" href="#Thermodynamics.relative_humidity"><code>Thermodynamics.relative_humidity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">relative_humidity(param_set, T, p, phase_type, q::PhasePartition)</code></pre><p>The relative humidity, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul><pre><code class="nohighlight hljs"></code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2739-L2748">source</a></section><section><div><pre><code class="language-julia hljs">relative_humidity(param_set::APS, ts::ThermodynamicState)</code></pre><p>The relative humidity, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2763-L2767">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.saturated" href="#Thermodynamics.saturated"><code>Thermodynamics.saturated</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">saturated(param_set::APS, ts::ThermodynamicState)</code></pre><p>Boolean indicating if thermodynamic state is saturated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L3039-L3044">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.saturation_adjustment" href="#Thermodynamics.saturation_adjustment"><code>Thermodynamics.saturation_adjustment</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    sat_adjust_method,
    param_set,
    e_int,
    ρ,
    q_tot,
    phase_type,
    maxiter,
    relative_temperature_tol,
    T_guess,
)</code></pre><p>Compute the temperature that is consistent with</p><ul><li><code>sat_adjust_method</code> the numerical method to use.  See the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_int</code> internal energy</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>maxiter</code> maximum iterations for non-linear equation solve</li><li><code>relative_temperature_tol</code> relative temperature tolerance</li><li><code>T_guess</code> initial temperature guess</li></ul><p>by finding the root of</p><p><code>e_int - internal_energy_sat(param_set, T, ρ, q_tot, phase_type) = 0</code></p><p>using the given numerical method <code>sat_adjust_method</code>.</p><p>See also <a href="#Thermodynamics.saturation_adjustment"><code>saturation_adjustment</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1491-L1524">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.saturation_excess" href="#Thermodynamics.saturation_excess"><code>Thermodynamics.saturation_excess</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">saturation_excess(param_set, T, ρ, phase_type, q::PhasePartition)</code></pre><p>The saturation excess in equilibrium where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>The saturation excess is the difference between the total specific humidity <code>q.tot</code> and the saturation specific humidity in equilibrium, and it is defined to be nonzero only if this difference is positive.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1193-L1207">source</a></section><section><div><pre><code class="language-julia hljs">saturation_excess(param_set::APS, ts::ThermodynamicState)</code></pre><p>Compute the saturation excess in equilibrium, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1237-L1242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.saturation_vapor_pressure" href="#Thermodynamics.saturation_vapor_pressure"><code>Thermodynamics.saturation_vapor_pressure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(param_set, T, Liquid())</code></pre><p>Return the saturation vapor pressure over a plane liquid surface given</p><ul><li><p><code>T</code> temperature</p></li><li><p><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</p><p><code>saturation_vapor_pressure(param_set, T, Ice())</code></p></li></ul><p>Return the saturation vapor pressure over a plane ice surface given</p><ul><li><p><code>T</code> temperature</p></li><li><p><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</p><p><code>saturation_vapor_pressure(param_set, T, LH_0, Δcp)</code></p></li></ul><p>Compute the saturation vapor pressure over a plane surface by integration of the Clausius-Clapeyron relation.</p><p>The Clausius-Clapeyron relation</p><pre><code class="nohighlight hljs">`dlog(p_v_sat)/dT = [LH_0 + Δcp * (T-T_0)]/(R_v*T^2)`</code></pre><p>is integrated from the triple point temperature <code>T_triple</code>, using Kirchhoff&#39;s relation</p><pre><code class="nohighlight hljs">`L = LH_0 + Δcp * (T - T_0)`</code></pre><p>for the specific latent heat <code>L</code> with constant isobaric specific heats of the phases. The linear dependence of the specific latent heat on temperature <code>T</code> allows analytic integration of the Clausius-Clapeyron relation to obtain the saturation vapor pressure <code>p_v_sat</code> as a function of the triple point pressure <code>press_triple</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L856-L889">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.soundspeed_air" href="#Thermodynamics.soundspeed_air"><code>Thermodynamics.soundspeed_air</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">soundspeed_air(param_set, T[, q::PhasePartition])</code></pre><p>The speed of sound in unstratified air, where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L691-L699">source</a></section><section><div><pre><code class="language-julia hljs">soundspeed_air(param_set::APS, ts::ThermodynamicState)</code></pre><p>The speed of sound in unstratified air given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L710-L714">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.specific_enthalpy" href="#Thermodynamics.specific_enthalpy"><code>Thermodynamics.specific_enthalpy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">specific_enthalpy(e_int, R_m, T)</code></pre><p>Specific enthalpy, given</p><ul><li><code>e_int</code> internal specific energy</li><li><code>R_m</code> <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>T</code> air temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2812-L2819">source</a></section><section><div><pre><code class="language-julia hljs">specific_enthalpy(param_set, ts)</code></pre><p>Specific enthalpy, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2824-L2828">source</a></section><section><div><pre><code class="language-julia hljs">specific_enthalpy(param_set, T[, q::PhasePartition])</code></pre><p>The specific_enthalpy per unit mass, given a thermodynamic state <code>ts</code> or</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2839-L2848">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.specific_volume" href="#Thermodynamics.specific_volume"><code>Thermodynamics.specific_volume</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">specific_volume(param_set::APS, ts::ThermodynamicState)</code></pre><p>The (moist-)air specific volume, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L159-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.supersaturation" href="#Thermodynamics.supersaturation"><code>Thermodynamics.supersaturation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">supersaturation(param_set, q, ρ, T, Liquid())
supersaturation(param_set, q, ρ, T, Ice())
supersaturation(ts, Ice())
supersaturation(ts, Liquid())</code></pre><ul><li><code>param_set</code> - abstract set with earth parameters</li><li><code>q</code> - phase partition</li><li><code>ρ</code> - air density,</li><li><code>T</code> - air temperature</li><li><code>Liquid()</code>, <code>Ice()</code> - liquid or ice phase to dispatch over.</li><li><code>ts</code> thermodynamic state</li></ul><p>Returns supersaturation (pv/pv_sat -1) over water or ice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1144-L1158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.total_energy" href="#Thermodynamics.total_energy"><code>Thermodynamics.total_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">total_energy(param_set, e_kin, e_pot, T[, q::PhasePartition])</code></pre><p>The total energy per unit mass, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_kin</code> kinetic energy per unit mass</li><li><code>e_pot</code> potential energy per unit mass</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L628-L640">source</a></section><section><div><pre><code class="language-julia hljs">total_energy(param_set::APS, ts::ThermodynamicState, e_kin, e_pot)</code></pre><p>The total energy per unit mass given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L651-L656">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.total_specific_enthalpy" href="#Thermodynamics.total_specific_enthalpy"><code>Thermodynamics.total_specific_enthalpy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">total_specific_enthalpy(e_tot, R_m, T)</code></pre><p>Total specific enthalpy, given</p><ul><li><code>e_tot</code> total specific energy</li><li><code>R_m</code> <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>T</code> air temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2782-L2789">source</a></section><section><div><pre><code class="language-julia hljs">total_specific_enthalpy(param_set, ts, e_tot::Real)</code></pre><p>Total specific enthalpy, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ts</code> a thermodynamic state</li><li><code>e_tot</code> total specific energy</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2794-L2801">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.total_specific_humidity" href="#Thermodynamics.total_specific_humidity"><code>Thermodynamics.total_specific_humidity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">total_specific_humidity(param_set::APS, ts::ThermodynamicState)
total_specific_humidity(param_set, T, p, relative_humidity)</code></pre><p>Total specific humidity given</p><ul><li><code>ts</code> a thermodynamic state</li></ul><p>or</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> pressure</li><li><code>relative_humidity</code> relative humidity (can exceed 1 when there is super saturation/condensate)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L167-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.vapor_specific_humidity" href="#Thermodynamics.vapor_specific_humidity"><code>Thermodynamics.vapor_specific_humidity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vapor_specific_humidity(q::PhasePartition{FT})</code></pre><p>The vapor specific humidity, given a <code>PhasePartition</code> <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L216-L220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.virtual_pottemp" href="#Thermodynamics.virtual_pottemp"><code>Thermodynamics.virtual_pottemp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_pottemp(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The virtual potential temperature where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2495-L2505">source</a></section><section><div><pre><code class="language-julia hljs">virtual_pottemp(param_set::APS, ts::ThermodynamicState)</code></pre><p>The virtual potential temperature, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2518-L2523">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.virtual_temperature" href="#Thermodynamics.virtual_temperature"><code>Thermodynamics.virtual_temperature</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">virtual_temperature(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The virtual temperature where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2531-L2541">source</a></section><section><div><pre><code class="language-julia hljs">virtual_temperature(param_set::APS, ts::ThermodynamicState)</code></pre><p>The virtual temperature, given a thermodynamic state <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2552-L2557">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.specific_entropy" href="#Thermodynamics.specific_entropy"><code>Thermodynamics.specific_entropy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">specific_entropy(param_set, p, T, q)
specific_entropy(param_set, ts)</code></pre><p>Specific entropy, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li><li><code>q</code> phase partition</li></ul><p>following equations (29)-(33) of <a href="../References/#Pressel2015">[1]</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2919-L2930">source</a></section></article><h2 id="Internal-methods"><a class="docs-heading-anchor" href="#Internal-methods">Internal methods</a><a id="Internal-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.shum_to_mixing_ratio" href="#Thermodynamics.shum_to_mixing_ratio"><code>Thermodynamics.shum_to_mixing_ratio</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">shum_to_mixing_ratio(q, q_tot)</code></pre><p>Mixing ratio, from specific humidity</p><ul><li><code>q</code> specific humidity</li><li><code>q_tot</code> total specific humidity</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L2684-L2690">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.q_vap_saturation_generic" href="#Thermodynamics.q_vap_saturation_generic"><code>Thermodynamics.q_vap_saturation_generic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">q_vap_saturation_generic(param_set, T, ρ[, phase=Liquid()])</code></pre><p>Compute the saturation specific humidity over a plane surface of condensate, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>Liquid()</code> indicating condensate is liquid</li><li><code>Ice()</code> indicating condensate is ice</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L991-L1002">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.q_vap_saturation_from_pressure" href="#Thermodynamics.q_vap_saturation_from_pressure"><code>Thermodynamics.q_vap_saturation_from_pressure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">q_vap_saturation_from_pressure(param_set, q_tot, p, T, phase_type)</code></pre><p>Compute the saturation specific humidity, given</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q_tot</code> total water specific humidity,</li><li><code>p</code> air pressure,</li><li><code>T</code> air tempearture</li><li><code>phase_type</code> a thermodynamic state type</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1109-L1118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhasePartition_equil" href="#Thermodynamics.PhasePartition_equil"><code>Thermodynamics.PhasePartition_equil</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhasePartition_equil(param_set, T, ρ, q_tot, phase_type)
PhasePartition_equil(param_set, T, ρ, q_tot, p_vap_sat, λ)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a> object using the <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a> function where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>p_vap_sat</code> saturation vapor pressure</li><li><code>λ</code> liquid fraction</li></ul><p>The residual <code>q.tot - q.liq - q.ice</code> is the vapor specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1339-L1355">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.PhasePartition_equil_given_p" href="#Thermodynamics.PhasePartition_equil_given_p"><code>Thermodynamics.PhasePartition_equil_given_p</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">PhasePartition_equil_given_p(param_set, T, p, q_tot, phase_type)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a> object using the <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a> function where</p><ul><li><code>param_set</code> an <code>AbstractParameterSet</code>, see the <a href="#Thermodynamics.Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> air pressure</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>The residual <code>q.tot - q.liq - q.ice</code> is the vapor specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/relations.jl#L1398-L1408">source</a></section></article><h2 id="Dispatch-types"><a class="docs-heading-anchor" href="#Dispatch-types">Dispatch types</a><a id="Dispatch-types-1"></a><a class="docs-heading-anchor-permalink" href="#Dispatch-types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.DryAdiabaticProcess" href="#Thermodynamics.DryAdiabaticProcess"><code>Thermodynamics.DryAdiabaticProcess</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DryAdiabaticProcess</code></pre><p>For dispatching to isentropic formulas</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/isentropic.jl#L9-L13">source</a></section></article><h2 id="Temperature-Profiles"><a class="docs-heading-anchor" href="#Temperature-Profiles">Temperature Profiles</a><a id="Temperature-Profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Profiles" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.TemperatureProfiles.IsothermalProfile" href="#Thermodynamics.TemperatureProfiles.IsothermalProfile"><code>Thermodynamics.TemperatureProfiles.IsothermalProfile</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">IsothermalProfile(param_set, T_virt)
IsothermalProfile(param_set, ::Type{FT&lt;:AbstractFloat})</code></pre><p>A uniform virtual temperature profile, which is implemented as a special case of <a href="#Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile"><code>DecayingTemperatureProfile</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/TemperatureProfiles.jl#L26-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.TemperatureProfiles.TemperatureProfile" href="#Thermodynamics.TemperatureProfiles.TemperatureProfile"><code>Thermodynamics.TemperatureProfiles.TemperatureProfile</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TemperatureProfile</code></pre><p>Specifies the temperature or virtual temperature profile for a reference state.</p><p>Instances of this type are required to be callable objects with the following signature</p><pre><code class="nohighlight hljs">T,p = (::TemperatureProfile)(param_set::APS, z::FT) where {FT}</code></pre><p>where <code>T</code> is the temperature or virtual temperature (in K), and <code>p</code> is the pressure (in Pa).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/TemperatureProfiles.jl#L13-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.TemperatureProfiles.DryAdiabaticProfile" href="#Thermodynamics.TemperatureProfiles.DryAdiabaticProfile"><code>Thermodynamics.TemperatureProfiles.DryAdiabaticProfile</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DryAdiabaticProfile{FT} &lt;: TemperatureProfile{FT}</code></pre><p>A temperature profile that has uniform dry potential temperature <code>θ</code></p><p><strong>Fields</strong></p><ul><li><p><code>T_surface</code>: Surface temperature (K)</p></li><li><p><code>T_min_ref</code>: Minimum temperature (K)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/TemperatureProfiles.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile" href="#Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile"><code>Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DecayingTemperatureProfile{F} &lt;: TemperatureProfile{FT}</code></pre><p>A virtual temperature profile that decays smoothly with height <code>z</code>, from <code>T_virt_surf</code> to <code>T_min_ref</code> over a height scale <code>H_t</code>. The default height scale <code>H_t</code> is the density scale height evaluated with <code>T_virt_surf</code>.</p><p class="math-container">\[T_{\text{v}}(z) = \max(T_{\text{v, sfc}} − (T_{\text{v, sfc}} - T_{\text{v, min}}) \tanh(z/H_{\text{t}})\]</p><p><strong>Fields</strong></p><ul><li><p><code>T_virt_surf</code>: Virtual temperature at surface (K)</p></li><li><p><code>T_min_ref</code>: Minimum virtual temperature at the top of the atmosphere (K)</p></li><li><p><code>H_t</code>: Height scale over which virtual temperature drops (m)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/TemperatureProfiles.jl#L96-L110">source</a></section></article><h2 id="Tested-profiles"><a class="docs-heading-anchor" href="#Tested-profiles">Tested profiles</a><a id="Tested-profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Tested-profiles" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.TestedProfiles" href="#Thermodynamics.TestedProfiles"><code>Thermodynamics.TestedProfiles</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">TestedProfiles</code></pre><p>Tested thermodynamic profiles</p><p>This module contains functions to compute all of the thermodynamic <em>states</em> that Thermodynamics is tested with in runtests.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/TestedProfiles.jl#L1-L9">source</a></section></article><h2 id="Data-collection"><a class="docs-heading-anchor" href="#Data-collection">Data collection</a><a id="Data-collection-1"></a><a class="docs-heading-anchor-permalink" href="#Data-collection" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Thermodynamics.DataCollection" href="#Thermodynamics.DataCollection"><code>Thermodynamics.DataCollection</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">DataCollection</code></pre><p>This module is designed to help judge the accuracy and performance for a particular formulation, tolerance, and or solver configuration, by providing tools to collect various statistics when Thermodynamic <code>saturation_adjustment</code> is called.</p><p><strong>Example:</strong></p><pre><code class="nohighlight hljs">import Thermodynamics as TD
import RootSolvers as RS

function do_work()
    # Calls TD.PhaseEquil_ρeq()..., possibly many times
end

TD.solution_type() = RS.VerboseSolution()
do_work()
TD.DataCollection.print_summary()</code></pre><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>This data collection was designed for unthreaded single processor runs, and may not work correctly for threaded / multi-processor runs.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/96f3bcff0b029882a1228643b883117d1fd6313e/src/DataCollection.jl#L1-L25">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Installation/">« Installation</a><a class="docs-footer-nextpage" href="../HowToGuide/">How-to-guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Tuesday 10 October 2023 23:45">Tuesday 10 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

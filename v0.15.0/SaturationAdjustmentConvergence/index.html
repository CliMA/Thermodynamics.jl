<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Saturation Adjustment Convergence · Thermodynamics.jl</title><meta name="title" content="Saturation Adjustment Convergence · Thermodynamics.jl"/><meta property="og:title" content="Saturation Adjustment Convergence · Thermodynamics.jl"/><meta property="twitter:title" content="Saturation Adjustment Convergence · Thermodynamics.jl"/><meta name="description" content="Documentation for Thermodynamics.jl."/><meta property="og:description" content="Documentation for Thermodynamics.jl."/><meta property="twitter:description" content="Documentation for Thermodynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../src/assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Thermodynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Thermodynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Formulation/">Mathematical Formulation</a></li><li><a class="tocitem" href="../API/">API Reference</a></li><li><a class="tocitem" href="../HowToGuide/">How-To Guide</a></li><li><a class="tocitem" href="../TemperatureProfiles/">Temperature Profiles</a></li><li><a class="tocitem" href="../TestedProfiles/">Tested Profiles</a></li><li><a class="tocitem" href="../Clausius_Clapeyron/">Clausius-Clapeyron Validation</a></li><li class="is-active"><a class="tocitem" href>Saturation Adjustment Convergence</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Purpose"><span>Purpose</span></a></li><li><a class="tocitem" href="#Convergence-Maps"><span>Convergence Maps</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Interpretation"><span>Interpretation</span></a></li><li><a class="tocitem" href="#Numerical-Methods-Tested"><span>Numerical Methods Tested</span></a></li><li><a class="tocitem" href="#Usage-Guidelines"><span>Usage Guidelines</span></a></li></ul></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Saturation Adjustment Convergence</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Saturation Adjustment Convergence</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl/blob/main/docs/src/SaturationAdjustmentConvergence.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Saturation-Adjustment-Convergence-Testing"><a class="docs-heading-anchor" href="#Saturation-Adjustment-Convergence-Testing">Saturation Adjustment Convergence Testing</a><a id="Saturation-Adjustment-Convergence-Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-Adjustment-Convergence-Testing" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The saturation adjustment procedure requires solving a non-linear equation to find the temperature that satisfies thermodynamic equilibrium conditions. This document describes the convergence testing framework used to validate the robustness of different numerical methods across the input parameter space.</p><h2 id="Purpose"><a class="docs-heading-anchor" href="#Purpose">Purpose</a><a id="Purpose-1"></a><a class="docs-heading-anchor-permalink" href="#Purpose" title="Permalink"></a></h2><p>While the <a href="../TestedProfiles/">Tested Profiles</a> section shows physically meaningful thermodynamic states, this section explores convergence behavior across a broader parameter space. We test all permutations of inputs within given ranges of density (<span>$\rho$</span>), internal energy (<span>$e_{int}$</span>), and total specific humidity (<span>$q_t$</span>), including combinations that may not be physically meaningful but help identify the boundaries where convergence fails.</p><p>This testing framework is dedicated to monitoring and improving the performance and robustness of various numerical methods in solving saturation adjustment equations.</p><div class="admonition is-info" id="Performance-Note-8a47de23c23d6980"><header class="admonition-header">Performance Note<a class="admonition-anchor" href="#Performance-Note-8a47de23c23d6980" title="Permalink"></a></header><div class="admonition-body"><p>The <code>dims</code> parameter in <code>docs/src/saturation_adjustment.jl</code> is currently set to <code>dims = (6, 6, 6)</code> to avoid heavy computations during documentation builds. For higher resolution testing, increase it to <code>dims = (10, 10, 10)</code> or higher when running locally.</p></div></div><h2 id="Convergence-Maps"><a class="docs-heading-anchor" href="#Convergence-Maps">Convergence Maps</a><a id="Convergence-Maps-1"></a><a class="docs-heading-anchor-permalink" href="#Convergence-Maps" title="Permalink"></a></h2><h3 id="3D-Parameter-Space"><a class="docs-heading-anchor" href="#3D-Parameter-Space">3D Parameter Space</a><a id="3D-Parameter-Space-1"></a><a class="docs-heading-anchor-permalink" href="#3D-Parameter-Space" title="Permalink"></a></h3><p>The following maps show convergence behavior across the full 3D parameter space:</p><table><tr><th style="text-align: center">Numerical Method</th><th style="text-align: center">Converged Cases</th><th style="text-align: center">Non-converged Cases</th></tr><tr><td style="text-align: center">SecantMethod</td><td style="text-align: center"><img src="../3DSpace_converged_SecantMethod.svg" alt/></td><td style="text-align: center"><img src="../3DSpace_non_converged_SecantMethod.svg" alt/></td></tr><tr><td style="text-align: center">NewtonsMethod</td><td style="text-align: center"><img src="../3DSpace_converged_NewtonsMethod.svg" alt/></td><td style="text-align: center"><img src="../3DSpace_non_converged_NewtonsMethod.svg" alt/></td></tr></table><h3 id="2D-Slices-by-Total-Specific-Humidity"><a class="docs-heading-anchor" href="#2D-Slices-by-Total-Specific-Humidity">2D Slices by Total Specific Humidity</a><a id="2D-Slices-by-Total-Specific-Humidity-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Slices-by-Total-Specific-Humidity" title="Permalink"></a></h3><p>These maps show convergence behavior in 2D slices, binned by total specific humidity:</p><table><tr><th style="text-align: center">Numerical Method</th><th style="text-align: center">Converged Cases</th><th style="text-align: center">Non-converged Cases</th></tr><tr><td style="text-align: center">SecantMethod</td><td style="text-align: center"><img src="../2DSlice_converged_SecantMethod.svg" alt/></td><td style="text-align: center"><img src="../2DSlice_non_converged_SecantMethod.svg" alt/></td></tr><tr><td style="text-align: center">NewtonsMethod</td><td style="text-align: center"><img src="../2DSlice_converged_NewtonsMethod.svg" alt/></td><td style="text-align: center"><img src="../2DSlice_non_converged_NewtonsMethod.svg" alt/></td></tr></table><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The convergence testing is implemented in the following code:</p><pre><code class="language-julia hljs">include(&quot;saturation_adjustment.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Convergence percentages:
RootSolvers.NewtonsMethod = 0.5370370370370371
RootSolvers.SecantMethod = 0.8101851851851852</code></pre><h2 id="Interpretation"><a class="docs-heading-anchor" href="#Interpretation">Interpretation</a><a id="Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Interpretation" title="Permalink"></a></h2><ul><li><strong>Converged regions</strong> (green/blue areas) indicate parameter combinations where the numerical method successfully finds a solution</li><li><strong>Non-converged regions</strong> (red areas) indicate parameter combinations where the method fails to converge</li><li><strong>Boundary regions</strong> help identify the robustness limits of each numerical method</li><li><strong>Physical relevance</strong> should be considered when interpreting results - some non-converged regions may correspond to unphysical parameter combinations</li></ul><h2 id="Numerical-Methods-Tested"><a class="docs-heading-anchor" href="#Numerical-Methods-Tested">Numerical Methods Tested</a><a id="Numerical-Methods-Tested-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Methods-Tested" title="Permalink"></a></h2><ol><li><strong>SecantMethod</strong>: A derivative-free method that uses finite differences to approximate derivatives</li><li><strong>NewtonsMethod</strong>: Uses analytical derivatives for potentially faster convergence</li></ol><h2 id="Usage-Guidelines"><a class="docs-heading-anchor" href="#Usage-Guidelines">Usage Guidelines</a><a id="Usage-Guidelines-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Guidelines" title="Permalink"></a></h2><ul><li>Use these maps to understand the convergence characteristics of different numerical methods</li><li>Consider the trade-offs between robustness (SecantMethod) and efficiency (NewtonsMethod)</li><li>The tested parameter ranges should cover your expected simulation conditions</li><li>For production use, ensure your parameter combinations fall within well-converged regions </li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Clausius_Clapeyron/">« Clausius-Clapeyron Validation</a><a class="docs-footer-nextpage" href="../References/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 8 October 2025 05:57">Wednesday 8 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

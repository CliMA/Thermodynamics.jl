var documenterSearchIndex = {"docs":
[{"location":"References/#References","page":"References","title":"References","text":"D. Yatunin, S. Byrne, C. Kawczynski, S. Kandala, G. Bozzola, A. Sridhar, Z. Shen, A. Jaruga, J. Sloan, J. He, D. Z. Huang, V. Barra, R. Chew, A. Boral, Y.-f. Chen, O. Knoth, P. Ullrich, C. Mbengue and T. Schneider. The Climate Modeling Alliance Atmosphere Dynamical Core: Concepts, Numerics, and Scaling. J. Adv. Model. Earth Sys. in press (2026).\n\n\n\nD. M. Romps. The Rankine–Kirchhoff approximations for moist thermodynamics. Quart. J. Roy. Meteor. Soc. 147, 3493–3497 (2021).\n\n\n\nD. M. Romps. The dry-entropy budget of a moist atmosphere. Journal of the Atmospheric Sciences 65, 3779–3799 (2008).\n\n\n\nM. H. Ambaum. Accurate, simple equation for saturated vapour pressure over water and ice. Quart. J. Roy. Meteor. Soc. 146, 3888–3896 (2020).\n\n\n\nJ. D. Neelin and I. M. Held. Modeling tropical convergence based on the moist static energy budget. Monthly Weather Review 115, 3–12 (1987).\n\n\n\nD. M. Romps. MSE minus CAPE is the true conserved variable for an adiabatically lifted parcel. Journal of the Atmospheric Sciences 72, 3639–3646 (2015).\n\n\n\nK. G. Pressel, C. M. Kaul, T. Schneider, Z. Tan and S. Mishra. Large-eddy simulation in an anelastic framework with closed water and entropy balances. Journal of Advances in Modeling Earth Systems 7, 1425–1456 (2015).\n\n\n\nC. M. Kaul, J. Teixeira and M. J. Richardson. Sensitivities in large-eddy simulations of mixed-phase Arctic stratocumulus clouds using a simple microphysics approach. Monthly Weather Review 143, 4393–4421 (2015).\n\n\n\nG. J. Tripoli and W. R. Cotton. The use of lce-liquid water potential temperature as a thermodynamic variable in deep atmospheric models. Monthly Weather Review 109, 1094–1102 (1981).\n\n\n\nG. H. Bryan and J. M. Fritsch. A reevaluation of ice–liquid water potential temperature. Monthly weather review 132, 2421–2431 (2004).\n\n\n\nD. R. Durran. Finite-Volume Methods. In: Numerical Methods for Wave Equations in Geophysical Fluid Dynamics (Springer, 1999); pp. 241–302.\n\n\n\nA. Bott. Theoretical considerations on the mass and energy consistent treatment of precipitation in cloudy atmospheres. Atmos. Res. 89, 252–269 (2008).\n\n\n\nP. Marquet and J.-F. Geleyn. Formulations of moist thermodynamics for atmospheric modelling. In: Parameterization of Atmospheric Convection, Vol. 2, edited by R. S. Plant and J.-I. Yano (Imperial College Press, London, UK, 2016); Chapter 22, pp. 221–274.\n\n\n\n","category":"section"},{"location":"TestedProfiles/#Tested-Profiles","page":"Tested Profiles","title":"Tested Profiles","text":"warning: Internal Testing Only\nThese profiles are primarily intended for internal testing of the package. They are not guaranteed to be physically consistent or stable for general use.","category":"section"},{"location":"TestedProfiles/#Overview","page":"Tested Profiles","title":"Overview","text":"Thermodynamics.jl is tested using a set of thermodynamic profiles specified in test/TestedProfiles.jl. These profiles represent a range of atmospheric conditions and are used to validate the thermodynamic calculations.\n\nThe tested profiles serve several functions:\n\nValidation: Ensure thermodynamic calculations are correct across diverse conditions\nCoverage: Test the full range of atmospheric temperatures and humidities, including both phase equilibrium and intentional phase non-equilibrium states.\nRobustness: Verify numerical stability under various thermodynamic states\nBenchmarking: Provide consistent test cases for performance evaluation\n\nnote: Related Testing Tools\nFor additional testing scenarios, see Temperature Profiles for pre-defined atmospheric temperature profiles.","category":"section"},{"location":"TestedProfiles/#Profile-Characteristics","page":"Tested Profiles","title":"Profile Characteristics","text":"The tested profiles cover:\n\nAltitude range: 0 to 25 km (surface to upper troposphere)\nTemperature range: 150 K to 340 K (cryogenic to hot conditions)\nHumidity range: 0 to 102% relative saturation (RS) applied to q_v mathrmsat\nDensity range: Full atmospheric density variation with height (approximately 0.05 to 1.5 kg/m³)","category":"section"},{"location":"TestedProfiles/#Dry-Phase-Profiles","page":"Tested Profiles","title":"Dry Phase Profiles","text":"Dry phase profiles test thermodynamic calculations without moisture, ensuring the dry air thermodynamics are correctly implemented.\n\nimport Thermodynamics as TD\nimport Plots\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\ninclude(\"../../test/TestedProfiles.jl\")\nimport .TestedProfiles\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\n\nprofiles = TestedProfiles.PhaseDryProfiles(param_set, Array{FT});\n(;T, ρ, z) = profiles\np1 = Plots.scatter(ρ, z./10^3, xlabel=\"Density [kg/m^3]\", ylabel=\"z [km]\", title=\"Density\");\np2 = Plots.scatter(T, z./10^3, xlabel=\"Temperature [K]\", ylabel=\"z [km]\", title=\"Temperature\");\nPlots.plot(p1, p2, layout=(1,2));\nPlots.savefig(\"tested_profiles_dry.svg\");\nnothing # hide\n\n(Image: Dry phase profiles)","category":"section"},{"location":"TestedProfiles/#Key-Features-(Dry)","page":"Tested Profiles","title":"Key Features (Dry)","text":"No moisture: All humidity components are zero\nPressure variation: Follows hydrostatic balance\nTemperature variation: Uses decaying temperature profile\nDensity calculation: Computed from ideal gas law","category":"section"},{"location":"TestedProfiles/#Moist-Phase-Profiles-(Phase-Equilibrium)","page":"Tested Profiles","title":"Moist Phase Profiles (Phase Equilibrium)","text":"Moist phase profiles test thermodynamic calculations with moisture in phase equilibrium, including saturation adjustment.\n\nimport Thermodynamics as TD\nimport Plots\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\ninclude(\"../../test/TestedProfiles.jl\")\nimport .TestedProfiles\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\n\nprofiles = TestedProfiles.PhaseEquilProfiles(param_set, Array{FT});\n(;T, ρ, q_tot, z) = profiles\np1 = Plots.scatter(ρ, z./10^3, xlabel=\"Density [kg/m^3]\", ylabel=\"z [km]\", title=\"Density\");\np2 = Plots.scatter(T, z./10^3, xlabel=\"Temperature [K]\", ylabel=\"z [km]\", title=\"Temperature\");\np3 = Plots.scatter(q_tot*1000, z./10^3, xlabel=\"Total specific\\nhumidity [g/kg]\", ylabel=\"z [km]\", title=\"Total specific\\nhumidity\");\nPlots.plot(p1, p2, p3, layout=(1,3));\nPlots.savefig(\"tested_profiles_virt_temp.svg\");\nnothing # hide\n\n(Image: Moist phase equilibrium profiles)","category":"section"},{"location":"TestedProfiles/#Key-Features-(Moist-Phase-Equilibrium)","page":"Tested Profiles","title":"Key Features (Moist Phase Equilibrium)","text":"Moisture included: Total specific humidity varies with height\nSaturation adjustment: Phase partitioning (q_l q_i) is determined by phase equilibrium using condensate_partition.\nWide humidity range: From subsaturated (RS  1) to supersaturated (RS  1) reference conditions.","category":"section"},{"location":"TestedProfiles/#Moist-Phase-Profiles-(Phase-Non-Equilibrium)","page":"Tested Profiles","title":"Moist Phase Profiles (Phase Non-Equilibrium)","text":"Non-equilibrium moist profiles test the package's ability to handle cases where the phase partitioning does not need to follow phase equilibrium assumptions.\n\nimport Thermodynamics as TD\nimport Plots\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\ninclude(\"../../test/TestedProfiles.jl\")\nimport .TestedProfiles\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\n\nprofiles = TestedProfiles.NonEquilMoistProfiles(param_set, Array{FT});\n(;T, ρ, q_liq, q_ice, z) = profiles\np1 = Plots.scatter(q_liq*1000, z./10^3, xlabel=\"Liquid specific\\nhumidity [g/kg]\", ylabel=\"z [km]\", title=\"Liquid\");\np2 = Plots.scatter(q_ice*1000, z./10^3, xlabel=\"Ice specific\\nhumidity [g/kg]\", ylabel=\"z [km]\", title=\"Ice\");\nPlots.plot(p1, p2, layout=(1,2));\nPlots.savefig(\"tested_profiles_nonequil.svg\");\nnothing # hide\n\n(Image: Moist phase (non-equilibrium) profiles)","category":"section"},{"location":"TestedProfiles/#Key-Features-(Phase-Non-Equilibrium)","page":"Tested Profiles","title":"Key Features (Phase Non-Equilibrium)","text":"Prescribed partitioning: Condensed phases q_l and q_i are prescribed as a fixed split (e.g., 60/40) of the excess moisture.\nSupersaturation: Intentionally allows vapor pressure to exceed saturation vapor pressure to test diagnostic functions.","category":"section"},{"location":"TestedProfiles/#Profile-Generation","page":"Tested Profiles","title":"Profile Generation","text":"The profiles are generated using:\n\nAltitude grid: 50 points from 0 to 25 km.\nHumidity grid: 30 relative saturation (RS) values from 0.0 to 1.02.\nTotal profiles: 1,500 distinct thermodynamic states (50 altitude points times 30 saturation values).\nHydrostatic consistency: Temperature and pressure are derived from a DecayingTemperatureProfile, ensuring they are mutually consistent with hydrostatic balance and the dry-air equation of state.\nPhase Partitioning:\nPhase Equilibrium: Uses condensate_partition based on T and rho.\nPhase Non-Equilibrium: Uses a fixed split of excess moisture to test non-equilibrium handling.","category":"section"},{"location":"TestedProfiles/#Usage-in-Testing","page":"Tested Profiles","title":"Usage in Testing","text":"These profiles are used in the test suite to validate:\n\nProperty calculations: Temperature, pressure, density, humidity\nEnergy calculations: Internal energy, enthalpy, potential temperature\nPhase transitions: Saturation adjustment and phase partitioning\nNumerical stability: Convergence and accuracy across parameter space","category":"section"},{"location":"TestedProfiles/#Integration-with-Development","page":"Tested Profiles","title":"Integration with Development","text":"The tested profiles are automatically used in:\n\nUnit tests: Validate individual function correctness\nIntegration tests: Verify end-to-end thermodynamic calculations\nPerformance tests: Benchmark computational efficiency\n\ntip: Development Workflow\nWhen adding new thermodynamic functionality, ensure it works correctly with these tested profiles. The profiles provide comprehensive coverage of atmospheric conditions and help catch numerical issues early.","category":"section"},{"location":"Formulation/#Mathematical-Formulation","page":"Mathematical Formulation","title":"Mathematical Formulation","text":"","category":"section"},{"location":"Formulation/#Table-of-Contents","page":"Mathematical Formulation","title":"Table of Contents","text":"Introduction\nFundamental Assumptions\nWorking Fluid and Equation of State\n3.1 Mass Fractions and Notation\n3.2 Equation of State\nHeat Capacities\nLatent Heats\nInternal Energies\nEnthalpies\nMoist Static Energy\nSaturation Vapor Pressure\nSaturation Specific Humidity\nSaturation Adjustment\nAuxiliary Thermodynamic Functions\n12.1 Relative Humidity\n12.2 Potential Temperature\n12.3 Virtual Temperature and Virtual Potential Temperature\n12.4 Liquid-Ice Potential Temperature\n12.5 Speed of Sound\nSummary and Implementation Guidelines\n13.1 Key Theoretical Framework\n13.2 Core Equations\n13.3 Implementation Strategy\n13.4 Validation and Testing\n13.5 Extensions and Limitations\n\nnote: Cross-References\nThis documentation is closely related to the API documentation which provides detailed function signatures and usage examples. The theoretical framework described here is implemented in the Thermodynamics.jl package.","category":"section"},{"location":"Formulation/#1.-Introduction","page":"Mathematical Formulation","title":"1. Introduction","text":"Here we introduce one consistent set of thermodynamic approximations for all model components. The key to thermodynamic consistency at reasonable accuracy is to take the specific heat capacities of the constituents of moist air (dry air, water vapor, liquid water, and ice) to be constant, i.e., to assume the gases to be calorically perfect. We discuss how to derive all other thermodynamic quantities that are needed on the basis of this one approximation ([1][3],[4], [2]). This includes:\n\nGiving accurate and easily adaptable closed-form expressions for internal energies, enthalpies, specific latent heats, and saturation vapor pressures\nShowing how to construct consistent sets of thermodynamic equations that either (i) assume phase equilibrium and require only one prognostic water variable, or (ii) do not assume phase equilibrium (but do assume thermal equilibrium) and require prognostic variables for all water phases\nShowing how to obtain temperatures from energy variables under either phase equilibrium assumptions (by saturation adjustment) or phase non-equilibrium assumptions (by a closed-form expression for temperature).\n\nThe resulting thermodynamic functions are implemented in Thermodynamics.jl.\n\nSpecific thermodynamic formulations often vary in how they approximate the relevant material properties. The formulation used in Thermodynamics.jl balances three criteria:\n\nAccuracy: The formulation is accurate enough for atmospheric modeling (e.g., errors in saturation vapor pressure are within a few percent).\nConsistency: The formulation is thermodynamically consistent (e.g., it conserves energy and satisfies the Clausius-Clapeyron relation).\nSimplicity and Efficiency: The formulation leads to closed-form expressions that can be evaluated efficiently.\n\nThe implementation follows the thermodynamic formulation of the CliMA Earth System Model ([1]). It relies on the Rankine-Kirchhoff approximations, which provide a consistent framework for moist thermodynamics ([2]).\n\nSpecific choices of thermodynamic constants have been made in ClimaParams.jl to maximize accuracy given the Rankine-Kirchhoff approximations ([4], [1]).\n\nnote: Physical Motivation\nThe assumption of calorically perfect gases (constant specific heat capacities) is justified for atmospheric conditions because the error of approximating them as constant is less than 1% for dry air, the main constituent of moist air, and at most a few percent for the water phases. This approximation enables closed-form expressions for all thermodynamic quantities while maintaining sufficient accuracy for atmospheric modeling.","category":"section"},{"location":"Formulation/#2.-Fundamental-Assumptions","page":"Mathematical Formulation","title":"2. Fundamental Assumptions","text":"Our thermodynamic framework is based on the following fundamental assumptions:\n\nIdeal Gas Law: Dry air and water vapor behave as ideal gases\nCalorically Perfect Gases: Specific heat capacities are constant (temperature-independent)\nNegligible Condensate Volume: The specific volume of liquid water and ice is neglected relative to gas phases\nThermal Equilibrium: All phases have the same temperature\nReference State: All thermodynamic quantities are defined relative to a reference temperature T₀\n\ntip: Implementation Note\nThese assumptions enable closed-form expressions for all thermodynamic quantities, making the implementation computationally efficient while maintaining sufficient accuracy for atmospheric modeling.","category":"section"},{"location":"Formulation/#3.-Working-Fluid-and-Equation-of-State","page":"Mathematical Formulation","title":"3. Working Fluid and Equation of State","text":"The working fluid is moist air. That is, it is an ideal mixture of dry air, water vapor, and condensed water (liquid and ice). Atmospheric models may choose to include precipitation (e.g., rain, snow, graupel) within the definitions of the condensed water specific humidities (q_liq, q_ice), or treat them as separate species. The thermodynamic formulation remains valid in either case, provided that the phases included in the working fluid are in thermal equilibrium.\n\nnote: Modeling Choice: Precipitation Included in Working Fluid\nIn the CliMA Earth System Model, precipitation is included as part of the working fluid. This choice means:Mass and energy conservation are maintained across all phases (including precipitation)\nThermodynamic consistency is preserved throughout the system\nAll condensed water phases (cloud and precipitation) are assumed to be in thermal equilibrium with the surrounding air (which is an approximation, see [1] for discussion)\n\nDry air and water vapor are taken to be ideal gases. The specific volume of all condensed phases (cloud liquid, cloud ice, and potentially precipitation) is neglected relative to that of the gas phases (it is a factor 10^3 less than that of the gas phases). All phases are assumed to have the same temperature. However, the condensates do not need to be in phase equilibrium with the other fluid constituents; out-of-equilibrium phases such as supercooled liquid can exist.\n\ntip: Implementation Note\nWhen precipitation is included in the working fluid, its mass contributes to the total water content q_t and affects the density and specific heat capacities. This is implemented consistently throughout the Thermodynamics.jl package.\n\n\n\ninfo: Sidebar: Pros and Cons of Including Precipitation in the Working Fluid\nPros:Ensures mass and energy conservation across all phases\nSimplifies the thermodynamic framework and implementation\nEnables consistent inclusion of microphysics schemes that treat hydrometeors as occupying a continuous spectrum (without artificial spectral gaps between cloud condensate and precipitation)Cons:Assumes precipitation is in thermal equilibrium with air, which may not always be true (e.g., large raindrops or hail)See [1] for further discussion and justification of this modeling choice.\n\n","category":"section"},{"location":"Formulation/#3.1-Mass-Fractions-and-Notation","page":"Mathematical Formulation","title":"3.1 Mass Fractions and Notation","text":"The density of the moist air is denoted by rho. We use the following notation for the mass fractions of the moist air mixture (mass of a constituent divided by the total mass of the working fluid):\n\nSymbol Definition\nq_d dry air mass fraction\nq_v water vapor specific humidity\nq_l liquid water specific humidity (includes both cloud liquid and precipitating liquid)\nq_i ice specific humidity (includes both cloud ice and precipitating ice/snow)\nq_c = q_l + q_i condensate specific humidity (all condensed water, cloud + precipitation)\nq_t = q_v + q_c total specific humidity (all water phases)\n\nnote: Precipitation Inclusion\nThe liquid and ice specific humidities q_l and q_i include both cloud condensate and precipitation. This unified treatment ensures that all condensed water phases are thermodynamically consistent and can exchange mass and energy with the gas phases.\n\nBecause this enumerates all constituents of the working fluid, we have q_t + q_d = 1. In Earth's atmosphere, the water vapor specific humidity q_v generally dominates the total specific humidity q_t and is usually O(10^-2) or smaller; the condensate specific humidity is typically O(10^-4). Hence, water is a trace constituent of the atmosphere, and only a small fraction of atmospheric water is in condensed phases.","category":"section"},{"location":"Formulation/#3.2-Equation-of-State","page":"Mathematical Formulation","title":"3.2 Equation of State","text":"The pressure p of the working fluid is the sum of the partial pressures of dry air and water vapor, both taken to be ideal gases. Neglecting the volume of the condensed phases (but not their masses), this gives p = rho (R_d q_d + R_v q_v) T, where R_d is the specific gas constant of dry air, and R_v is the specific gas constant of water vapor.\n\nnote: Precipitation and the Equation of State\nAlthough precipitation is included in the working fluid, it does not contribute to the pressure because its specific volume is neglected. However, precipitation mass affects the density andspecific heat capacity.\n\nThis can also be written as\n\nbeginequation\n    p = rho R_m T\nlabeleeos\nendequation\n\nwhere\n\nbeginequation\nbeginaligned\n    R_m(q)  = R_d (1 - q_t) + R_v q_v \n            = R_d left 1 + (varepsilon_dv-1)q_t - varepsilon_dv q_cright\nendaligned\nlabeleRm\nendequation\n\nis the specific gas constant of moist air (which varies with composition); here, we have used q_d = 1-q_t and q_v = q_t - q_c and introduced the ratio of the molar masses of dry air and water vapor varepsilon_dv = R_vR_d (approx 161).\n\nnote: Mathematical Note\nAlthough called a \"constant,\" R_m actually varies with the composition of the moist air. This terminology reflects its role as the effective gas constant in the equation of state, similar to how the molecular weight of a gas mixture varies with composition.\n\nEquations \\eqref{e:eos} and \\eqref{e:Rm} constitute the equation of state of the working fluid. We use the notation q=(q_t q_l q_i) for the tuple of specific humidities that determine the composition of moist air.\n\nexample: Typical Values\nFor Earth's atmosphere at sea level:Quantity Value\nR_d 2870 J/(kg·K)\nR_v 4615 J/(kg·K)\nvarepsilon_dv 161\nR_m (typical moist air, q_t = 001) 2887 J/(kg·K)\nR_m (air with precipitation, q_t = 0015) 2890 J/(kg·K)","category":"section"},{"location":"Formulation/#4.-Heat-Capacities","page":"Mathematical Formulation","title":"4. Heat Capacities","text":"The isochoric specific heat capacities of the constituents of moist air are:\n\nSymbol Definition\nc_vd Isochoric specific heat capacity of dry air\nc_vv Isochoric specific heat capacity of water vapor\nc_vl Isochoric specific heat capacity of liquid water\nc_vi Isochoric specific heat capacity of ice\n\nOur key thermodynamic approximation is to take these isochoric specific heat capacities to be constants, i.e., we take the gases to be calorically perfect. This is an approximation because they depend weakly on temperature. But for atmospheric conditions, the error of approximating them as constant is less than 1% for dry air, the main constituent of moist air, and at most a few percent for the water phases.\n\nThe difference between the isochoric and isobaric specific heat capacities is proportional to the specific volume. Consistent with taking the specific volume of liquid water and ice to be zero, we take the isochoric and isobaric specific heat capacities of the condensed phases to be equal. The isobaric specific heat capacities of the constituents then are:\n\nSymbol Definition\nc_pd = c_vd + R_d Isobaric specific heat capacity of dry air\nc_pv = c_vv + R_v Isobaric specific heat capacity of water vapor\nc_pl = c_vl Isobaric specific heat capacity of liquid water\nc_pi = c_vi Isobaric specific heat capacity of ice\n\ntip: Implementation Note\nThe relationship c_p = c_v + R for ideal gases follows from the definition of enthalpy h = u + pv and the ideal gas law pv = RT. For condensed phases, we neglect the specific volume term (v), so c_p  c_v.\n\nThe corresponding specific heat capacities of moist air are the weighted sum of those of the constituents:\n\nbeginequation\nbeginaligned\n    c_cdot m(q)  = (1-q_t) c_cdot d + q_v c_cdot v + q_l c_cdot l + q_i c_cdot i \n     = c_cdot d + (c_cdot v - c_cdot d)q_t + (c_cdot l - c_cdot v)q_l + (c_cdot i - c_cdot v)q_i\nendaligned\nlabeleSpecificHeat\nendequation\n\nwhere cdot stands for v or p and we have used q_v = q_t - q_l - q_i.\n\nnote: Mathematical Note\nThe second form of the equation is computationally more efficient as it avoids computing q_v explicitly. This rearrangement is used in the implementation to improve performance.\n\nStraightforward substitution shows that the above relation between the specific heat capacities of the constituents also holds for moist air as a whole:\n\nbeginequationlabeleSpecificHeatRelation\n    c_pm(q) = c_vm(q) + R_m(q)\nendequation\n\nexample: Typical Values\nFor Earth's atmosphere at standard conditions:Quantity Value\nc_vd 7176 J/(kg·K)\nc_vv 14100 J/(kg·K)\nc_vl 42190 J/(kg·K)\nc_vi 21060 J/(kg·K)\nc_vm (typical moist air, q_t = 001) 7200 J/(kg·K)\nc_pm (typical moist air, q_t = 001) 10080 J/(kg·K)\n\ntip: Implementation Note\nThe specific heat capacities are implemented as weighted sums in the cp_m and cv_m functions. The implementation uses the rearranged form of equation \\eqref{e:SpecificHeat} for computational efficiency.","category":"section"},{"location":"Formulation/#5.-Latent-Heats","page":"Mathematical Formulation","title":"5. Latent Heats","text":"Kirchhoff's relation states that the specific latent enthalpy (heat) L of a phase change depends on temperature T through\n\nbeginequation\n    fracdLdT = Delta c_p\nendequation\n\nwhere Delta c_p is the difference in isobaric specific heat capacities between the phase with the higher and lower specific volume. For the constant isobaric specific heat capacities that we assume, this can be integrated to give\n\nbeginequation\n    L(T) = L_0 + Delta c_p (T-T_0)\n    labeleLHTemperature\nendequation\n\nwhere T_0 is a reference temperature and L_0 is the specific latent heat at T_0.\n\nnote: Physical Interpretation\nKirchhoff's relation follows from the fact that the enthalpy difference between phases changes with temperature due to the different heat capacities of the phases. The latent heat represents the energy required to transform a unit mass from one phase to another at constant pressure.\n\ntip: Implementation Note\nThe linear temperature dependence of latent heats enables closed-form expressions for saturation vapor pressure and other thermodynamic quantities. This approximation is accurate to within a few percent for atmospheric temperature ranges.\n\nFor the phase transitions of water, this implies specifically:\n\nFormula Description\nL_v(T) = L_v0 + (c_pv - c_pl) (T - T_0) Latent heat of vaporization\nL_f(T) = L_f0 + (c_pl - c_pi) (T - T_0) Latent heat of fusion\nL_s(T) = L_s0 + (c_pv - c_pi) (T - T_0) Latent heat of sublimation\n\nWith L_s0 = L_v0 + L_f0, this gives L_s(T) = L_v(T) + L_f(T), as it should.\n\nexample: Typical Values\nAt the reference temperature T_0 = 27315 K:Quantity Value\nL_v0 2501 times 10^6 J/kg (latent heat of vaporization)\nL_f0 0334 times 10^6 J/kg (latent heat of fusion)\nL_s0 2835 times 10^6 J/kg (latent heat of sublimation)At T = 300 K:Quantity Value\nL_v 2430 times 10^6 J/kg\nL_f 0334 times 10^6 J/kg\nL_s 2764 times 10^6 J/kg\n\ntip: Implementation Note\nThe latent heats are implemented in the latent_heat_vapor, latent_heat_fusion, and latent_heat_sublim functions. The weighted latent heat for mixed-phase conditions is computed in latent_heat_mixed.","category":"section"},{"location":"Formulation/#6.-Internal-Energies","page":"Mathematical Formulation","title":"6. Internal Energies","text":"The specific internal energies of the constituents of moist air can be written as\n\nbeginequation\nbeginaligned\nI_d(T)  = c_vd (T - T_0) - R_d T_0  \nI_v(T)  = c_vv (T - T_0) + I_v0\nI_l(T)  = c_vl (T - T_0) \nI_i(T)  = c_vi (T - T_0) - I_i0\nendaligned\nlabeleInternalEnergies\nendequation\n\nHere, the reference specific internal energy I_v0 is the difference in specific internal energy between vapor and liquid at the reference temperature T_0, and I_i0 is the difference in specific internal energy between ice and liquid at T_0. We have included an arbitrary constant offset - R_d T_0 in the definition of the dry specific internal energy as that simplifies the corresponding specific enthalpies \\eqref{e:Enthalpies}. The formulation is reference-temperature invariant, meaning that the physics is independent of the choice of the arbitrary reference temperature T_0 used to define energies, enthalpies, and entropies, provided that boundary conditions (as implemented in SurfaceFluxes.jl) also respect this invariance. Measurable thermodynamic variables such as temperature, pressure, etc. do not depend on a shift in the reference temperature T_0.\n\nnote: Physical Interpretation\nThe internal energy represents the total energy of a substance excluding kinetic and potential energy. The reference energies I_v0 and I_i0 represent the energy differences between phases at the reference temperature, accounting for the fact that vapor has higher internal energy than liquid, and ice has lower internal energy than liquid.\n\nThe internal energy of moist air is the weighted sum of that of the constituents:\n\nbeginequation\nbeginaligned\n     I(T q)  = (1-q_t) I_d(T) + q_v I_v(T) + q_l I_l(T) + q_i I_i(T)\n           = c_vm(q) (T - T_0)  + q_v I_v0 - q_i I_i0 - (1 - q_t) R_d T_0\nendaligned\nlabeleTotalInternalEnergy\nendequation\n\ntip: Implementation Note\nThe internal energy is implemented as a weighted sum of constituent energies in the internal_energy function. The constituent energies are computed separately in internal_energy_dry, internal_energy_vapor, internal_energy_liquid, and internal_energy_ice.\n\nThe internal energy can be inverted to obtain the temperature given I and the specific humidities:\n\nbeginequation\n    T = T_0 + fracI - (q_t - q_l - q_i) I_v0 + q_i I_i0 + (1 - q_t) R_d T_0c_vm(q)\n    labeletemperature\nendequation\n\nwhere we have used q_v = q_t - q_l - q_i. This allows one to recover temperature given internal energy and specific humidities as state variables.\n\nnote: Mathematical Note\nThe temperature recovery equation \\eqref{e:temperature} is crucial to compute temperature from internal energy and composition when internal (or total) energy is used as a prognostic variable. This inversion is possible because internal energy is a monotonic function of temperature for our assumptions.\n\nThe reference specific internal energies I_v0 and I_i0 are related to the reference specific latent heats L_v0 and L_f0, which indicate the enthalpy differences between the phases at T_0. The reference specific internal energies are obtained from the reference specific latent heats by subtracting the \"pv\" term, which is p_krho_k for the relevant partial pressure p_k and specific volume 1rho_k of the phase k (and hence is zero for the condensed phases, whose specific volume we neglect). This gives\n\nbeginequation\nbeginaligned\n     I_v0 = L_v 0 - R_v T_0\n     I_i0 = L_f 0\nendaligned\nlabeleRefInternalEnergies\nendequation\n\nexample: Typical Values\nAt the reference temperature T_0 = 27315 K:Quantity Value\nI_v0 2501 times 10^6 J/kg (vapor reference energy)\nI_i0 0334 times 10^6 J/kg (ice reference energy)For typical moist air at T = 300 K with q_t = 001:Quantity Value\nI 215 times 10^3 J/kg (total internal energy)","category":"section"},{"location":"Formulation/#7.-Enthalpies","page":"Mathematical Formulation","title":"7. Enthalpies","text":"The specific enthalpies of the constituents of moist air are obtained by adding p_krho_k for phase k to the corresponding specific internal energy \\eqref{e:InternalEnergies}. Again neglecting the specific volumes of the condensed phases and using the relations \\eqref{e:RefInternalEnergies} between reference specific energies and latent heats, this gives:\n\nbeginequation\nlabeleEnthalpies\nbeginaligned\n    h_d(T) = I_d(T) + R_d T = c_pd(T-T_0) \n    h_v(T) = I_v(T) + R_v T = c_pv(T-T_0) + L_v0 \n    h_l(T) = I_l(T) = c_pl(T-T_0) \n    h_i(T) = I_i(T) = c_pi(T-T_0) - L_f0\nendaligned\nendequation\n\nThe formulation is reference-temperature invariant, meaning that the physics is independent of the choice of the arbitrary reference temperature T_0 used to define enthalpies and entropies, provided that boundary conditions (as implemented in SurfaceFluxes.jl) also respect this invariance.\n\nnote: Physical Interpretation\nEnthalpy represents the total energy of a substance including the work done against pressure. For ideal gases, enthalpy includes the pv term, while for condensed phases this term is neglected due to their small specific volume v. Enthalpy is the relevant energy quantity for fluid transport, including at boundaries.\n\nThe enthalpy of moist air is the weighted sum of the constituent enthalpies:\n\nbeginequation\nbeginsplitlabeleenthalpy_definition\n    h(T q)  = (1-q_t) h_d + q_v h_v + q_l h_l + q_i h_i \n        = c_pm(q) (T-T_0) + q_v L_v0 - q_i L_f0\n        = I(q T) + R_m T\nendsplit\nendequation\n\nwhere the last equality used c_pm = c_vm + R_m (Eq. \\ref{e:SpecificHeatRelation}).\n\ntip: Implementation Note\nThe enthalpy is implemented in the enthalpy function. The relationship h = I + R_m T is used for efficient computation, avoiding the need to compute individual constituent enthalpies.\n\nThe enthalpy is the relevant thermodynamic energy quantity in fluid transport. It arises in boundary conditions for energy fluxes and in the modeling of subgrid-scale (SGS) turbulent transport.\n\nexample: Typical Values\nFor typical moist air at T = 300 K with q_t = 001, we have the specific enthalpy h = 3020 times 10^3 J/kg. This is significantly larger than the specific internal energy due to the R_m T term.","category":"section"},{"location":"Formulation/#8.-Moist-Static-Energy","page":"Mathematical Formulation","title":"8. Moist Static Energy","text":"The sum of the specific enthalpy of moist air and the specific gravitational potential energy Φ is the moist static energy [5]\n\nbeginequationlabeleMSE\nmathrmMSE = h + Φ\nendequation\n\nMoist static energy arises naturally as the static energy component that is transported in moist air. \"Static\" here refers to the fact that the (small) kinetic energy contribution to the total energy is neglected. The global integral of moist static energy is approximately conserved in adiabatic processes, even in the presence of reversible phase transitions and latent heat release. It is also approximately materially conserved ([6]).","category":"section"},{"location":"Formulation/#9.-Saturation-Vapor-Pressure","page":"Mathematical Formulation","title":"9. Saturation Vapor Pressure","text":"The Clausius-Clapeyron relation describes how the saturation vapor pressure p_v^* of an ideal gas over a plane surface of condensate depends on temperature:\n\nbeginequation\nlabeleClausiusClapeyron\n    fracd log(p_v^*)dT = fracLR_v T^2\nendequation\n\nHere, L is the specific latent heat of the phase transition, which is L_v for the saturation vapor pressure over liquid, or L_s for the saturation vapor pressure over ice.\n\nSubstituting the linear relation \\eqref{e:LHTemperature} between latent heat and temperature, and taking p_mathrmtr to be the vapor pressure at the triple point (by definition equal to the saturation vapor pressures both over liquid and ice), the Clausius-Clapeyron relation can be integrated to give a closed-form expression for the saturation vapor pressure. This closed-form expression is known as the Rankine-Kirchhoff approximation ([2]), named after its independent discoverers. It is the unique solution consistent with our thermodynamic assumptions (constant heat capacities and ideal gas law):\n\nbeginequation\n    p_v^* = p_mathrmtr left( fracTT_mathrmtr right)^fracDelta c_pR_v\n        exp left fracL_0 - Delta c_p T_0R_v\n        left( frac1T_mathrmtr - frac1T right) right\n        labeleSatVaporPressure\nendequation\n\ntip: Implementation Note\nThe saturation vapor pressure is implemented in the saturation_vapor_pressure function. The closed-form expression enables efficient computation without numerical integration.\n\nWith L_0 = L_v0 or L_0 = L_s0 and the corresponding heat capacity difference Delta c_p, this gives saturation vapor pressures over liquid or ice that are accurate within 3% for temperatures between 200K and 330K ([4]). The accuracy of this approximation depends on the choice of thermodynamic constants; the values used in Thermodynamics.jl (specified in ClimaParams.jl) are chosen to minimize errors in the Rankine-Kirchhoff approximation ([1]).\n\nexample: Typical Values\nAt T = 300 K:Quantity Value\np_v^* (liquid) 3537 Pa\np_v^* (ice) 286 PaAt T = 27315 K (triple point):Quantity Value\np_v^* (liquid) = p_v^* (ice) 611 PaThe ratio of liquid to ice saturation vapor pressure at 300 K is approximately 12.4, reflecting the higher energy required for sublimation compared to vaporization.\n\nTo obtain the saturation vapor pressure over a mixture of liquid and ice (e.g., in mixed-phase clouds), using a weighted average of the relevant specific latent heats in the vapor pressure \\eqref{e:SatVaporPressure} leads to a thermodynamically consistent formulation ([7]). That is, if a fraction lambda_p of the condensate is liquid and the complement 1-lambda_p is ice, calculating the saturation vapor pressure with a specific latent heat lambda_p L_v + (1-lambda_p)L_s gives a thermodynamically consistent saturation vapor pressure over the mixture.\n\nnote: Physical Interpretation\nThe weighted latent heat approach ensures thermodynamic consistency when computing saturation vapor pressure over mixed-phase conditions. This is important for modeling mixed-phase clouds where both liquid and ice coexist.\n\nIn phase equilibrium, the liquid fraction lambda_p(T) is a function of temperature alone. For temperatures above the freezing temperature T_textfreeze, lambda_p(T) = 1. In strict phase equilibrium, lambda_p(T) = 0 below freezing; that is, supercooled liquid does not exist. To parameterize the presence of supercooled liquid in phase equilibrium, a continuous function is used to represent a nonzero liquid fraction between the temperature of homogeneous ice nucleation T_texticenuc and the freezing temperature T_textfreeze. In Thermodynamics.jl, this is parameterized following [8] as a power-law ramp interpolation, with some exponent n, such that:\n\nlambda_p(T) = \nbegincases \n0  T le T_texticenuc \nleft(fracT - T_texticenucT_textfreeze - T_texticenucright)^n  T_texticenuc  T  T_textfreeze \n1  T ge T_textfreeze\nendcases\n\nThis smooth transition represents the statistical presence of supercooled liquid in a phase equilibrium framework.\n\nOut of phase equilibrium, when prognostic variables for liquid (q_liq) and ice (q_ice) specific humidities are available, the liquid fraction is defined simply as the ratio of liquid to total condensate:\n\nlambda = fracq_liqq_liq + q_ice\n\nThis definition makes no assumption about the temperature dependence of the phase partitioning and allows for phase non-equilibrium states (e.g., supercooled liquid at temperatures where the equilibrium function would force freezing).\n\ntip: Implementation Note\nThe liquid_fraction function in Thermodynamics.jl dispatches on the arguments provided.liquid_fraction(param_set, T) computes the phase equilibrium temperature-dependent fraction.\nliquid_fraction(param_set, T, q_liq, q_ice) computes the fraction from specific humidities. If no condensate is present (q_liq + q_ice ≈ 0), it falls back to a slightly smoothed Heaviside function (a linear ramp over pm 01 K around freezing) to ensure differentiability of derived quantities such as saturation vapor pressure.","category":"section"},{"location":"Formulation/#10.-Saturation-Specific-Humidity","page":"Mathematical Formulation","title":"10. Saturation Specific Humidity","text":"From the saturation vapor pressure p_v^*, the saturation specific humidity can be computed using the ideal gas law \\eqref{e:eos}, giving the density of water vapor at saturation rho_v^* = p_v^*(T)(R_v T), and hence the saturation specific humidity\n\nbeginequation\n     q_v^* = fracrho_v^*rho = fracp_v^*(T)rho R_v T\nlabeleSatShum\nendequation","category":"section"},{"location":"Formulation/#11.-Saturation-Adjustment","page":"Mathematical Formulation","title":"11. Saturation Adjustment","text":"The thermodynamic state of a moist air parcel in local phase equilibrium is uniquely defined by its density rho, total specific humidity q_t, and internal energy I (or temperature T or other thermodynamic variables). Thus, a moist dynamical core that assumes phase equilibrium thermodynamics can be constructed from a dry dynamical core with internal (or total) energy as a prognostic variable by including only a tracer for the total specific humidity q_t, and calculating the temperature and condensate specific humidities from rho, q_t, and I.\n\nObtaining the temperature and condensate specific humidities from the state variables rho, q_t, and I is the problem of finding the root T of\n\nbeginequation\nI^*(T rho q_t) - I = 0\nlabeleSatAdjustment\nendequation\n\nwhere I^*(T rho q_t) is the internal energy at phase equilibrium. In an unsaturated equilibrium, there is no condensate, so I^* is the internal energy with q_l=q_i=0. At saturation, the internal energy I^* depends on the vapor specific humidity, q_v = q_v^*(T rho), and on the saturation excess (total condensate)\n\nbeginequation\nq_c^* = maxbiglq_t - q_v^*(T rho) 0bigr\nendequation\n\nwhich is partitioned according to the liquid fraction λ_p into\n\nbeginequation\nq_l^* = λ_p(T) q_c^* quad textand quad q_i^* = bigl1-λ_p(T)bigrq_c^*\nlabelePhasePartition\nendequation\n\nIn saturated conditions, finding the root of \\eqref{e:SatAdjustment} is a nonlinear problem, which must be solved iteratively or approximately, in what is known as a saturation adjustment procedure.\n\nA zeroth-order approximation of the temperature T satisfying the saturation adjustment condition \\eqref{e:SatAdjustment} is obtained by assuming unsaturated conditions. In that case, the expression \\eqref{e:temperature} for temperature, with q_l=q_i=0, gives the unsaturated temperature\n\nbeginequation\n    T_1 = T_0 + fracI - q_t I_v0c_vm^*\nendequation\n\nHere, the isochoric specific heat capacity in phase equilibrium, c_vm^* = c_vm(q^*), is the specific heat capacity under phase equilibrium partitioning q^* of the phases, which here, for unsaturated conditions, means q^*=(q_t q_l=0 q_i=0). If the total specific humidity q_t is less than the saturation specific humidity at T_1 (q_t le q_v^*(T_1 rho)), the air is indeed unsaturated, and T=T_1 is the exact temperature consistent given I, rho, and q_t.\n\nIf the air is saturated (q_t  q_v^*(T_1 rho)), successively improved temperature estimates T_n+1 can be obtained from the temperature T_n (n=1dots) by Newton's method. Linearizing the saturation internal energy I^*(T rho q_t) around the temperature T_n gives\n\nbeginequation\n    I^*(T rho q_t) approx I^*(T_n rho q_t) + leftfracpartial I^*(T rho q_t)partial Tright_T_n (T - T_n)\nendequation\n\nand solving for the temperature T gives the first-order Newton update\n\nbeginequation\n    T_n+1 = T_n - fracI^*(T_n rho q_t) - I(partial I^*partial T)_T_n\nendequation\n\nThe derivative partial I^*partial T_T_n is obtained by differentiation of the internal energy \\eqref{e:TotalInternalEnergy}. The implementation in Thermodynamics.jl includes the full derivative, including the temperature dependence of the liquid fraction lambda_p(T):\n\nbeginequation\n     leftfracpartial I^*partial Tright_T_n\n     = c_vm^* + (e_vap - e_cond) left fracpartial q_v^*partial Tright_T_n + (e_liq - e_ice) q_cond^* fracpartial lambda_ppartial T\nendequation\n\nwhere q_cond^* = q_t - q_v^*, and e_cond = lambda_p e_liq + (1-lambda_p) e_ice. The derivative of the saturation specific humidity is given by\n\nbeginequation\n    left fracpartial q_v^*partial Tright_T_n = q_v^*(T_n) left( fracLR_v T_n^2 - frac1T_n right)\nendequation\n\nwhich follows from differentiation of the ideal gas law for vapor and the Clausius-Clapeyron relation. Note the inclusion of the -1T term, which arises from the density dependence. The derivative of the liquid fraction partial lambda_p  partial T is non-zero in the supercooled liquid mixed-phase region.\n\nThe resulting successive Newton approximations T_n generally converge quadratically. Because condensate specific humidities are usually small, T_1 provides a close initial estimate, and few iterations are needed. Even the first-order approximation Tapprox T_2 often suffices. With the smoothed liquid fraction lambda_p ramp (see liquid_fraction), the derivative of I^* with respect to temperature remains continuous across the phase transition, allowing the saturation adjustment to converge reliably without requiring special treatment or limiters.\n\nUsing saturation adjustment makes it possible to construct a moist dynamical core that has the total specific humidity q_t as the only prognostic moisture variable. The price for this simplicity is the necessity to solve a nonlinear problem iteratively (or approximately) at each time step, and being confined to a phase equilibrium framework which cannot adequately account for non-equilibrium processes. Using explicit tracers for the condensates q_l and q_i in addition to q_t avoids iterations at each time step and allows the inclusion of explicit non-equilibrium processes, such as those leading to the formation of supercooled liquid in mixed-phase clouds.","category":"section"},{"location":"Formulation/#12.-Auxiliary-Thermodynamic-Functions","page":"Mathematical Formulation","title":"12. Auxiliary Thermodynamic Functions","text":"Several auxiliary thermodynamic functions are commonly used.","category":"section"},{"location":"Formulation/#12.1-Relative-Humidity","page":"Mathematical Formulation","title":"12.1 Relative Humidity","text":"The relative humidity is defined as the ratio of the partial pressure of water vapor p_v to the saturation vapor pressure p_v^*,\n\nmathrmRH = fracp_vp_v^*\n\nUsing the ideal gas law for water vapor, p_v = q_v rho R_v T, this can be written as\n\nbeginequation\n    mathrmRH = fracq_v rho R_v Tp_v^*\nendequation\n\nwhere p_v^* is the saturation vapor pressure \\eqref{e:SatVaporPressure}. Over a mixture of ice and liquid, the saturation vapor pressure \\eqref{e:SatVaporPressure} is evaluated with a specific latent heat L = λ_p L_v + (1-λ_p) L_s that is a weighted sum of those for vaporization and sublimation.","category":"section"},{"location":"Formulation/#12.2-Potential-Temperature","page":"Mathematical Formulation","title":"12.2 Potential Temperature","text":"The potential temperature theta is the temperature an air mass would have if brought adiabatically from pressure p and temperature T to some reference pressure p_0 (typically taken to be mean sea level pressure):\n\nbeginequation\nθ = fracTPi\nlabelePotTempPressT\nendequation\n\nwhere Pi is known as the Exner function\n\nbeginequation\n    Pi  = left( fracpp_0 right)^κ quad textwith quad κ = fracR_mc_pm\nendequation\n\nNote that the adiabatic exponent kappa takes the effect of  moisture on the effective gas \"constant\" and specific heat capacity of air into account.","category":"section"},{"location":"Formulation/#12.3-Virtual-Temperature-and-Virtual-Potential-Temperature","page":"Mathematical Formulation","title":"12.3 Virtual Temperature and Virtual Potential Temperature","text":"The virtual or density temperature T_v is the temperature dry air would need to have to have the same density as moist air at the same pressure. Using the ideal gas law prho = R_m T, this implies R_m T  = Rd Tv $, or\n\nbeginequation labelevirtual_temp\nT_v = fracR_mR_d T\nendequation\n\nA virtual potential temperature can be defined analogously:\n\nbeginequation\nθ_v = fracR_mR_d θ\nlabelevirtual_pottemp\nendequation\n\nnote: Relationship between virtual temperature and 'density temperature'\nSome texts distinguish a \"(condensate-ignoring) virtual temperature\" and a \"density temperature\", and an analogous condensate-ignoring virtual potential temperature and density potential temperature. In those texts, the definition of density temperature incorporates condensate mass but their \"condensate-ignoring virtual temperature\" does not. We always take the mass of any condensate into account in the thermodynamics of moist air, so this distinction is irrelevant here. In other words, because the virtual temperature defined above incorporates the mass of condensate into R_m(q) (and virtual potential temperature is additionally defined in terms of c_pm(q)) via the potential temperature exponent κ), there is no distinction between our virtual temperature and a hypothetical \"density temperature\".","category":"section"},{"location":"Formulation/#12.4-Liquid-Ice-Potential-Temperature","page":"Mathematical Formulation","title":"12.4 Liquid-Ice Potential Temperature","text":"When the amount of condensate in air is small and the temperature T is not too small (e.g., [9]), the (linearized) liquid-ice potential temperature,\n\nbeginequationlabeleLiquidIcePottemp\nθ_li = θ left( 1 - fracL_v0 q_l + L_s 0 q_ic_pm T right)\nendequation\n\nis approximately materially conserved in adiabatic and reversible processes (including phase transitions). It is approximately the potential temperature \\eqref{e:PotTempPressT} an air parcel would have if all liquid water in the parcel were evaporated and all ice sublimated. It is the limit of a more general expression for liquid-ice potential temperature for small q_l and q_i and taking the specific latent heats to be constant (e.g., [10]). The liquid-ice potential temperature \\eqref{e:LiquidIcePottemp} and variants thereof are sometimes used as variables in numerical models. We use it for diagnostic purposes, for comparison with other studies.\n\nThe liquid-ice potential temperature theta_li can be inverted for the temperature given pressure p (and hence Pi) and the specific humidities q_t, q_l, and q_i:\n\nbeginequation\n    T = Pi θ_li + fracL_v 0 q_l + L_s 0 q_ic_pm\nlabeleTempFromThetaLiGivenP\nendequation\n\nAlternatively, when density rho instead of pressure p is given, the temperature can be obtained by Taylor expansion from the liquid-ice potential temperature theta_li,\n\nbeginequation\nT approx T_u + fracL_v0 q_l + L_s0q_ic_vm - fracκ2 frac1T_uleft(fracL_v0 q_l + L_s0 q_ic_vmright)^2\nendequation\nlabeleTempFromThetaLiGivenRho\n\nwhere\n\nbeginequation\n   T_u =  left( fracrho R_m θ_lip_0 right)^R_mc_vm θ_li\nendequation\n\nis the temperature that would correspond to theta_li in unsaturated conditions, i.e., when the condensate specific humidities q_l and q_i are zero. However, the specific heats c_vm and c_pm and the moist gas constant R_m are evaluated with the given total and condensate specific humidities q_t, q_l, and q_i.\n\nThis expression for temperature as a function of liquid-ice potential temperature is obtained from \\eqref{e:TempFromThetaLiGivenP} by substituting for pressure in the Exner function Pi from the ideal gas law, p=rho R_m T, solving for temperature using a second-order Taylor expansion around T_u for small condensate specific humidities, and using the relation 1-kappa = c_vmc_pm, which follows from c_pm - R_m = c_vm. The relation for temperature \\eqref{e:TempFromThetaLiGivenRho} holds to second order in condensate specific humidities q_l and q_i. That is, the inversion relation \\eqref{e:TempFromThetaLiGivenRho} holds to one higher order of accuracy than the definition of the liquid-ice potential temperature \\eqref{e:LiquidIcePottemp} itself, which is only first-order accurate in the condensate specific humidities q_l and q_i.","category":"section"},{"location":"Formulation/#12.5-Speed-of-Sound","page":"Mathematical Formulation","title":"12.5 Speed of Sound","text":"The speed of sound in (moist) unstratified air is\n\nbeginequation\n c_s = left(fracc_pmc_vm R_m T right)^12\nlabelesoundspeed\nendequation\n\nwith the appropriate gas constants for moist air. In the presence of stratification, additional terms arise ([11]).\n\nnote: Physical Interpretation\nThe speed of sound represents the rate at which pressure perturbations propagate through the fluid. The expression accounts for the effect of moisture on the gas constant and specific heat capacities of the air mixture.\n\nexample: Typical Values\nFor dry air at T = 300 K: c_s approx 347 m/s For moist air with q_t = 001 at T = 300 K: c_s  348 m/s\n\ntip: Implementation Note\nThe speed of sound is implemented in the soundspeed_air function. It is used in numerical schemes that require the characteristic wave speeds for stability analysis.","category":"section"},{"location":"Formulation/#13.-Summary-and-Implementation-Guidelines","page":"Mathematical Formulation","title":"13. Summary and Implementation Guidelines","text":"","category":"section"},{"location":"Formulation/#13.1-Key-Theoretical-Framework","page":"Mathematical Formulation","title":"13.1 Key Theoretical Framework","text":"The thermodynamic framework presented here is based on a single fundamental approximation: calorically perfect gases with constant specific heat capacities. This approximation enables:\n\nClosed-form expressions for all thermodynamic quantities\nConsistent thermodynamics across all model components\nComputational efficiency without numerical integration\nAccuracy within 1-3% for atmospheric conditions","category":"section"},{"location":"Formulation/#13.2-Core-Equations","page":"Mathematical Formulation","title":"13.2 Core Equations","text":"The most important equations for implementation are:\n\nEquation of State: p = rho R_m T with R_m(q) = R_d (1 - q_t) + R_v q_v\nInternal Energy: I(T q) = c_vm(q) (T - T_0) + q_v I_v0 - q_i I_i0 - (1 - q_t) R_d T_0\nTemperature Recovery: T = T_0 + (I - q_v I_v0 + q_i I_i0 + (1 - q_t) R_d T_0)  c_vm(q)\nSaturation Vapor Pressure: Closed-form expression \\eqref{e:SatVaporPressure}","category":"section"},{"location":"Formulation/#13.3-Implementation-Strategy","page":"Mathematical Formulation","title":"13.3 Implementation Strategy","text":"","category":"section"},{"location":"Formulation/#**Phase-Equilibrium-vs.-Phase-Non-Equilibrium-Approaches**","page":"Mathematical Formulation","title":"Phase Equilibrium vs. Phase Non-Equilibrium Approaches","text":"Phase Equilibrium Approach (Saturation Adjustment):\nPrognostic variables: rho, q_t, I\nDiagnostic variables: T, q_l, q_i\nRequires iterative solution for temperature\nPhase Non-Equilibrium Approach:\nPrognostic variables: rho, q_t, q_l, q_i, I\nDiagnostic variable: T\nClosed-form temperature recovery","category":"section"},{"location":"Formulation/#**Numerical-Considerations**","page":"Mathematical Formulation","title":"Numerical Considerations","text":"Saturation Adjustment: Use Newton's method with analytical derivatives (a derivative-free secant method is also provided)\nTemperature Recovery: Monotonic function enables robust inversion\nMixed-Phase Conditions: Weighted latent heats ensure consistency\nPerformance: Use rearranged forms to avoid redundant computations","category":"section"},{"location":"Formulation/#13.4-Validation-and-Testing","page":"Mathematical Formulation","title":"13.4 Validation and Testing","text":"The implementation should be validated against:\n\nEnergy Conservation: Total energy should be conserved even in the presence of moist processes\nTemperature Recovery: Inversion should recover original temperature\nSaturation Consistency: Saturation conditions should be self-consistent\nPhase Transitions: Latent heat release should match energy changes\n\nnote: Testing Framework\nComprehensive testing is performed using Tested Profiles that cover the full range of atmospheric conditions.\n\nThermodynamics.jl contains a battery of unit tests that check for consistency of the thermodynamic formulation and convergence of saturation adjustement in a broad range of conditions.","category":"section"},{"location":"Formulation/#13.5-Extensions-and-Limitations","page":"Mathematical Formulation","title":"13.5 Extensions and Limitations","text":"","category":"section"},{"location":"Formulation/#**Current-Limitations**","page":"Mathematical Formulation","title":"Current Limitations","text":"Constant specific heat capacities (1-3% error)\nNeglected condensate volume","category":"section"},{"location":"Formulation/#**Potential-Extensions**","page":"Mathematical Formulation","title":"Potential Extensions","text":"Temperature-dependent heat capacities\nNon-ideal gases\n\ntip: Implementation Note\nThe Thermodynamics.jl package provides a complete implementation of this framework with comprehensive testing and validation. See the API documentation for detailed function signatures and usage examples.\n\nnote: References\nThis formulation is described in [1], building on the theoretical framework described in [3], [12], and [13], with additional developments for mixed-phase conditions from [7].","category":"section"},{"location":"TemperatureProfiles/#Atmospheric-Temperature-Profiles","page":"Temperature Profiles","title":"Atmospheric Temperature Profiles","text":"","category":"section"},{"location":"TemperatureProfiles/#Overview","page":"Temperature Profiles","title":"Overview","text":"The Thermodynamics.TemperatureProfiles module provides pre-defined atmospheric temperature profiles for testing and validation, and as reference states in atmosphere models. These profiles represent idealized atmospheric conditions used in climate modeling and testing.","category":"section"},{"location":"TemperatureProfiles/#Available-Profiles","page":"Temperature Profiles","title":"Available Profiles","text":"Three temperature profiles are currently available:\n\nIsothermalProfile: Constant temperature with height\nDecayingTemperatureProfile: Temperature decreases smoothly with height\nDryAdiabaticProfile: Temperature follows dry adiabatic lapse rate","category":"section"},{"location":"TemperatureProfiles/#Usage","page":"Temperature Profiles","title":"Usage","text":"Each profile constructor requires two arguments:\n\nparam_set: A thermodynamic parameter set from ClimaParams.jl\nz: Altitude (height above surface)\n\nThe profiles return both temperature and pressure as a function of altitude.","category":"section"},{"location":"TemperatureProfiles/#Isothermal-Profile","page":"Temperature Profiles","title":"Isothermal Profile","text":"A constant temperature profile, useful for testing thermodynamic calculations under uniform conditions.\n\nimport Thermodynamics as TD\nimport Plots\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\nz = range(FT(0), stop = FT(2.5e4), length = 50);\n\nisothermal = TD.TemperatureProfiles.IsothermalProfile(param_set, FT);\nargs = isothermal.(Ref(param_set), z);\nT = first.(args);\np = last.(args);\n\np1 = Plots.plot(T, z./10^3, xlabel=\"Temperature [K]\");\np2 = Plots.plot(p./10^3, z./10^3, xlabel=\"Pressure [kPa]\");\nPlots.plot(p1, p2, layout=(1,2), title=\"Isothermal\", ylabel=\"z [km]\");\nPlots.savefig(\"isothermal.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"TemperatureProfiles/#Decaying-Temperature-Profile","page":"Temperature Profiles","title":"Decaying Temperature Profile","text":"A profile where temperature decreases smoothly with height, representing typical atmospheric conditions.\n\nimport Thermodynamics as TD\nimport Plots\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\nz = range(FT(0), stop = FT(2.5e4), length = 50);\n\ndecaying = TD.TemperatureProfiles.DecayingTemperatureProfile{FT}(param_set);\nargs = decaying.(Ref(param_set), z);\nT = first.(args);\np = last.(args);\n\np1 = Plots.plot(T, z./10^3, xlabel=\"Temperature [K]\");\np2 = Plots.plot(p./10^3, z./10^3, xlabel=\"Pressure [kPa]\");\nPlots.plot(p1, p2, layout=(1,2), ylabel=\"z [km]\", title=\"Decaying\");\nPlots.savefig(\"decaying.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"TemperatureProfiles/#Dry-Adiabatic-Profile","page":"Temperature Profiles","title":"Dry Adiabatic Profile","text":"A profile following the dry adiabatic lapse rate (potential temperature constant with height) down to some minimum temperature.\n\nimport Thermodynamics as TD\nimport Plots\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\nz = range(FT(0), stop = FT(2.5e4), length = 50);\n\ndry_adiabatic = TD.TemperatureProfiles.DryAdiabaticProfile{FT}(param_set);\nargs = dry_adiabatic.(Ref(param_set), z)\nT = first.(args)\np = last.(args)\nθ_dry = TD.potential_temperature_given_pressure.(Ref(param_set), T, p)\n\np1 = Plots.plot(T, z./10^3, xlabel=\"Temperature [K]\");\np2 = Plots.plot(p./10^3, z./10^3, xlabel=\"Pressure [kPa]\");\np3 = Plots.plot(θ_dry, z./10^3, xlabel=\"Potential temperature [K]\");\nPlots.plot(p1, p2, p3, layout=(1,3), ylabel=\"z [km]\", title=\"Dry adiabatic\");\nPlots.savefig(\"dry_adiabatic.svg\");\nnothing # hide\n\n(Image: )","category":"section"},{"location":"TemperatureProfiles/#Applications","page":"Temperature Profiles","title":"Applications","text":"These temperature profiles are useful for:\n\nTesting thermodynamic calculations under controlled conditions\nServing as reference states in atmosphere models\nBenchmarking performance across different atmospheric conditions\nEducational purposes to understand atmospheric thermodynamics","category":"section"},{"location":"TemperatureProfiles/#Extending-the-Module","page":"Temperature Profiles","title":"Extending the Module","text":"Additional temperature profiles can be added by:\n\nCreating a struct containing the parameters needed for the profile\nImplementing a functor that takes (param_set, z) and returns (T, p)\n\nExample structure:\n\nstruct CustomProfile{FT} <: TemperatureProfile{FT}\n    # Profile parameters\nend\n\nfunction (profile::CustomProfile{FT})(param_set, z) where {FT}\n    # Calculate T and p based on z\n    return (T, p)\nend\n\nnote: Implementation Details\nAll profiles implement the TemperatureProfile interface and return temperature-pressure pairs as a function of altitude. The profiles are designed to be composable with other thermodynamic calculations.","category":"section"},{"location":"HowToGuide/#How-To-Guide","page":"How-To Guide","title":"How-To Guide","text":"This guide covers the essential aspects of using Thermodynamics.jl, specifically focusing on its functional, stateless API.","category":"section"},{"location":"HowToGuide/#Table-of-Contents","page":"How-To Guide","title":"Table of Contents","text":"Basic Setup\nCore Workflow\nThermodynamic Calculations\nPerformance Considerations\nIntegration with Models\nAutomatic Differentiation\nCommon Pitfalls","category":"section"},{"location":"HowToGuide/#Basic-Setup","page":"How-To Guide","title":"Basic Setup","text":"","category":"section"},{"location":"HowToGuide/#Installation-and-Import","page":"How-To Guide","title":"Installation and Import","text":"using Pkg\nPkg.add(\"Thermodynamics\")\nPkg.add(\"ClimaParams\")\n\nimport Thermodynamics as TD\nimport RootSolvers as RS  # Needed for saturation adjustment\nusing ClimaParams","category":"section"},{"location":"HowToGuide/#Creating-Parameters","page":"How-To Guide","title":"Creating Parameters","text":"# Create thermodynamic parameters for Float64 precision\nparams = TD.Parameters.ThermodynamicsParameters(Float64);\n\n# For Float32 precision (useful for GPU computations)\nparams_f32 = TD.Parameters.ThermodynamicsParameters(Float32);","category":"section"},{"location":"HowToGuide/#Core-Workflow","page":"How-To Guide","title":"Core Workflow","text":"Thermodynamics.jl operates on independent thermodynamic variables directly, rather than wrapping them in a state configuration object. The general pattern is:\n\nDefine your independent variables (e.g., density ρ, internal energy e_int, specific humidities q_...).\nPass them to a function along with the parameter set params.\n\n# Define variables\nρ = 1.0          # Density [kg/m³]\ne_int = -7.0e4   # Internal energy [J/kg]\nq_tot = 0.01     # Total specific humidity [kg/kg]\nq_liq = 0.005    # Liquid specific humidity [kg/kg]\nq_ice = 0.0      # Ice specific humidity [kg/kg]\n\n# Compute a property\nT = TD.air_temperature(params, e_int, q_tot, q_liq, q_ice)\np = TD.air_pressure(params, T, ρ, q_tot, q_liq, q_ice)\n\n(T=T, p=p)\n\ntip: Temperature Profiles for Testing\nFor testing and validation, you can use pre-defined atmospheric temperature profiles from TD.TemperatureProfiles. See Temperature Profiles for available profiles and usage examples.","category":"section"},{"location":"HowToGuide/#Thermodynamic-Calculations","page":"How-To Guide","title":"Thermodynamic Calculations","text":"","category":"section"},{"location":"HowToGuide/#**1.-Phase-Equilibrium-Calculations-(Saturation-Adjustment)**","page":"How-To Guide","title":"1. Phase Equilibrium Calculations (Saturation Adjustment)","text":"When you have conservative variables (e.g., ρ, e_int, q_tot) and need to find the temperature T and phase partition (q_liq, q_ice) that satisfy phase equilibrium, use saturation_adjustment.\n\n# Input variables\nρ = 1.0\ne_int = -7.0e4\nq_tot = 0.01\n\n# Solve for phase equilibrium\n# We select a root-finding method from RootSolvers.jl (e.g., SecantMethod, NewtonsMethod)\n# We specify the formulation (TD.ρe() means inputs are Density & Internal Energy)\nsol = TD.saturation_adjustment(\n    RS.SecantMethod,        # Method\n    params,                 # Parameter set\n    TD.ρe(),                # Formulation\n    ρ, e_int, q_tot,        # Inputs\n    10,                     # Max iterations\n    1e-3                    # Tolerance\n)\n\nT_equil = sol.T\nq_liq_equil = sol.q_liq\nq_ice_equil = sol.q_ice\nconverged = sol.converged\n\nprintln(\"Equilibrium T: $T_equil\")\n\nSupported formulations for saturation adjustment:\n\nTD.ρe(): Inputs: ρ, e_int, q_tot\nTD.pe(): Inputs: p, e_int, q_tot\nTD.ph(): Inputs: p, h, q_tot\nTD.pθ_li(): Inputs: p, θ_li, q_tot","category":"section"},{"location":"HowToGuide/#**2.-Phase-Non-Equilibrium-Calculations-(Explicit-Phases)**","page":"How-To Guide","title":"2. Phase Non-Equilibrium Calculations (Explicit Phases)","text":"If you already know the phase partition (e.g., q_liq and q_ice are prognostic variables in your model), you can compute properties directly without iteration.\n\nq_tot = 0.01\nq_liq = 0.002\nq_ice = 0.001\n\n# Temperature from internal energy\ne_int = -6.5e4\nT = TD.air_temperature(params, e_int, q_tot, q_liq, q_ice)\n\n# Temperature from enthalpy\nh = -5.0e4\nT_from_h = TD.air_temperature(params, TD.ph(), h, q_tot, q_liq, q_ice)\n\n# Pressure\np = TD.air_pressure(params, T, ρ, q_tot, q_liq, q_ice)\n\n# Sound speed\nc_s = TD.soundspeed_air(params, T, q_tot, q_liq, q_ice)","category":"section"},{"location":"HowToGuide/#**3.-Saturation-Properties**","page":"How-To Guide","title":"3. Saturation Properties","text":"Compute saturation properties given thermodynamic variables.\n\nT = 290.0\nρ = 1.1\n\n# Saturation vapor pressure over liquid\np_v_sat_l = TD.saturation_vapor_pressure(params, T, TD.Liquid())\n\n# Saturation vapor pressure over ice\np_v_sat_i = TD.saturation_vapor_pressure(params, T, TD.Ice())\n\n# Saturation specific humidity\nq_v_sat = TD.q_vap_saturation(params, T, ρ)\n\n(p_v_sat_l=p_v_sat_l, p_v_sat_i=p_v_sat_i, q_v_sat=q_v_sat)","category":"section"},{"location":"HowToGuide/#Performance-Considerations","page":"How-To Guide","title":"Performance Considerations","text":"","category":"section"},{"location":"HowToGuide/#**Type-Stability**","page":"How-To Guide","title":"Type Stability","text":"Ensure all inputs map to the same floating-point type (e.g., Float64 or Float32). Mixed precision can cause allocations and slowdowns.\n\n# Good: Consistent types\nFT = Float64\nparams = TD.Parameters.ThermodynamicsParameters(FT)\nval = TD.air_temperature(params, FT(-7.0e4), FT(0.01))\n\n# Avoid: Mixed types (e.g. Float64 params with Float32 inputs)","category":"section"},{"location":"HowToGuide/#**Vectorized-Operations**","page":"How-To Guide","title":"Vectorized Operations","text":"Thermodynamics.jl functions broadcast efficiently over arrays.\n\n# Arrays of thermodynamic variables\ne_int_arr = [-7.0e4, -6.5e4, -6.0e4]\ndensities = [1.0, 1.1, 1.2]\nq_tots    = [0.01, 0.012, 0.015]\n\n# Broadcast the function call\nT_arr = TD.air_temperature.(Ref(params), e_int_arr, q_tots)","category":"section"},{"location":"HowToGuide/#**GPU-Compatibility**","page":"How-To Guide","title":"GPU Compatibility","text":"The functional API is GPU-friendly. Usage is identical, provided arrays are on the GPU (e.g., CuArray) and parameters are initialized with the correct type (Float32).\n\n# Use Float32 for GPU\nFT = Float32\nparams_f32 = TD.Parameters.ThermodynamicsParameters(FT)\n\n# On GPU (conceptual)\n# T_gpu = TD.air_temperature.(Ref(params_f32), e_int_gpu, q_tot_gpu)","category":"section"},{"location":"HowToGuide/#**Optimized-Saturation-Adjustment**","page":"How-To Guide","title":"Optimized Saturation Adjustment","text":"For GPU performance, avoiding branch divergence is important. For the ρe formulation, use the fixed-iteration path by passing forced_fixed_iters=true as the last positional argument.\n\n# GPU-optimized broadcasting\nsol = TD.saturation_adjustment.(\n    RS.NewtonsMethod,\n    Ref(params_f32),\n    Ref(TD.ρe()),\n    ρ_gpu, e_int_gpu, q_tot_gpu,\n    Ref(3),      # maxiter (3 iterations → ~0.1 K accuracy)\n    Ref(1e-4),   # tol (ignored when forced_fixed_iters=true)\n    nothing,     # T_guess (ignored when forced_fixed_iters=true)\n    true,        # forced_fixed_iters\n)\n\nFor CPU single calls, you can omit the last two arguments to use the standard solver:\n\n# CPU single-call (standard solver)\nsol = TD.saturation_adjustment(\n    RS.NewtonsMethod,\n    params_f32,\n    TD.ρe(),\n    ρ_val, e_int_val, q_tot_val,\n    10,      # maxiter\n    1e-4,    # tolerance\n)","category":"section"},{"location":"HowToGuide/#Integration-with-Models","page":"How-To Guide","title":"Integration with Models","text":"","category":"section"},{"location":"HowToGuide/#**Prognostic-Variable-Management**","page":"How-To Guide","title":"Prognostic Variable Management","text":"In a weather or climate model, you typically evolve a state vector. Thermodynamics.jl acts as a kernel to close the system of equations.\n\n# Example: Computing pressure for the momentum equation\n# ----------------------------------------------------\n# Prognostic variables from the model state:\nρ = 1.0 # arbitrary value for example\ne_tot = 20000.0 # arbitrary value for example\nu, v, w = 10.0, 0.0, 0.0 # arbitrary values\nq_tot, q_liq, q_ice = 0.01, 0.001, 0.0 # arbitrary values\n\n# 1. Recover internal energy\ne_kin = 0.5 * (u^2 + v^2 + w^2)\ne_pot = 0.0 # arbitrary\ne_int = e_tot - e_kin - e_pot\n\n# 2. Recover temperature (if q_liq/ice are prognostic)\nT = TD.air_temperature(params, e_int, q_tot, q_liq, q_ice)\n\n# 3. Compute pressure\np = TD.air_pressure(params, T, ρ, q_tot, q_liq, q_ice)","category":"section"},{"location":"HowToGuide/#**Handling-Phase-Changes**","page":"How-To Guide","title":"Handling Phase Changes","text":"If your model handles phase changes (microphysics), you might step q_liq and q_ice explicitly. If you assume instantaneous equilibrium (saturation adjustment), you use saturation_adjustment at the end or beginning of the step.\n\n# Saturation Adjustment Step\n# Re-define variables for example completeness\nρ = 1.0\ne_int = -7.0e4\nq_tot = 0.01\nsol = TD.saturation_adjustment(RS.NewtonsMethod, params, TD.ρe(), ρ, e_int, q_tot, 15, 1e-4)\n\n# Update thermodynamic variables\nT_new = sol.T\nq_liq_new = sol.q_liq\nq_ice_new = sol.q_ice\n\n(T_new, q_liq_new, q_ice_new)","category":"section"},{"location":"HowToGuide/#Automatic-Differentiation","page":"How-To Guide","title":"Automatic Differentiation","text":"Thermodynamics.jl is compatible with automatic differentiation (AD) tools such as ForwardDiff.jl. This enables computing thermodynamic derivatives for sensitivity analysis, optimization, and adjoint-based methods.","category":"section"},{"location":"HowToGuide/#**Computing-Derivatives-Through-Saturation-Adjustment**","page":"How-To Guide","title":"Computing Derivatives Through Saturation Adjustment","text":"A common use case is computing how phase variables change with respect to input thermodynamic variables. For example, computing ∂q_liq/∂e_int (the rate of change of liquid condensate with internal energy):\n\nusing ForwardDiff\n\n# Setup: conditions at T = 290 K\nT_sat = 290.0\nρ = 1.2\n\n# Create supersaturated conditions (q_tot > q_vap_sat)\nq_vap_sat = TD.q_vap_saturation(params, T_sat, ρ)\nq_tot = q_vap_sat * 1.5  # 50% supersaturated\n\n# Get equilibrium partition\n(q_liq_eq, q_ice_eq) = TD.condensate_partition(params, T_sat, ρ, q_tot)\n\n# Compute consistent internal energy\ne_int = TD.internal_energy(params, T_sat, q_tot, q_liq_eq, q_ice_eq)\n\n# Define a function from e_int → q_liq through saturation adjustment\nfunction q_liq_from_e_int(e)\n    sol = TD.saturation_adjustment(\n        RS.SecantMethod,\n        params,\n        TD.ρe(),\n        ρ, e, q_tot,\n        20,    # maxiter\n        1e-5   # tolerance\n    )\n    return sol.q_liq\nend\n\n# Compute ∂q_liq/∂e_int using ForwardDiff\ndq_liq_de_int = ForwardDiff.derivative(q_liq_from_e_int, e_int)\n\nprintln(\"∂q_liq/∂e_int = \", dq_liq_de_int, \" [kg/kg per J/kg]\")","category":"section"},{"location":"HowToGuide/#**AD-Compatible-Derivatives**","page":"How-To Guide","title":"AD-Compatible Derivatives","text":"All core thermodynamic functions and saturation adjustment routines propagate dual numbers correctly:\n\n# ∂T/∂e_int at fixed composition\nfunction T_from_e_int(e)\n    q_tot, q_liq, q_ice = 0.01, 0.002, 0.0\n    TD.air_temperature(params, e, q_tot, q_liq, q_ice)\nend\n\ne_int_ref = -7.0e4\ndT_de_int = ForwardDiff.derivative(T_from_e_int, e_int_ref)\n\nprintln(\"∂T/∂e_int = \", dT_de_int, \" [K per J/kg]\")\n\nnote: Root Solver Compatibility\nWhen using AD through saturation_adjustment, prefer RS.SecantMethod or RS.NewtonsMethod for smooth derivative propagation.","category":"section"},{"location":"HowToGuide/#Common-Pitfalls","page":"How-To Guide","title":"Common Pitfalls","text":"","category":"section"},{"location":"HowToGuide/#**Input-Units**","page":"How-To Guide","title":"Input Units","text":"SI Units: All inputs must be in SI units (kg, m, s, K, Pa, J).\nSpecific Quantities: Energies and humidities are specific (per kg of moist air).","category":"section"},{"location":"HowToGuide/#**Specific-Humidity-Definition**","page":"How-To Guide","title":"Specific Humidity Definition","text":"q_tot, q_liq, q_ice are mass fractions (kg/kg moist air).\nEnsure q_liq + q_ice <= q_tot. q_vapor is implicitly q_tot - q_liq - q_ice.","category":"section"},{"location":"#Thermodynamics.jl","page":"Home","title":"Thermodynamics.jl","text":"A Julia package for atmospheric thermodynamics, providing consistent thermodynamic functions for moist air including all phases of water (vapor, liquid, and ice). Thermodynamics.jl implements the thermodynamic formulation of the CliMA Earth System Model ([1]), providing a framework for moist thermodynamics based on the Rankine-Kirchhoff approximations ([2]).","category":"section"},{"location":"#Table-of-Contents","page":"Home","title":"Table of Contents","text":"Quick Start\nDocumentation Overview\nKey Features\nCore Design Principles\nUsage Examples\nIntegration with Climate Models","category":"section"},{"location":"#Quick-Start","page":"Home","title":"Quick Start","text":"","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"using Pkg\nPkg.add(\"Thermodynamics\")\nPkg.add(\"ClimaParams\")","category":"section"},{"location":"#Basic-Usage","page":"Home","title":"Basic Usage","text":"import Thermodynamics as TD\n# Use RootSolvers for the saturation adjustment method\nimport RootSolvers as RS\nusing ClimaParams\n\n# 1. Create thermodynamic parameters\n#    (requires a definition of the parameter set, e.g. from ClimaParams)\nparams = TD.Parameters.ThermodynamicsParameters(Float64)\n\n# 2. Define your thermodynamic variables\nρ     = 1.1        # Density [kg/m³]\ne_int = -31673.0   # Internal energy [J/kg] (note: can be negative)\nq_tot = 0.015      # Total specific humidity [kg/kg]\nq_liq = 0.001      # Liquid specific humidity [kg/kg]\nq_ice = 0.0        # Ice specific humidity [kg/kg]\n\n# 3. Compute properties directly\nT = TD.air_temperature(params, e_int, q_tot, q_liq, q_ice)\np = TD.air_pressure(params, T, ρ, q_tot, q_liq, q_ice)\n(T=T, p=p)","category":"section"},{"location":"#Documentation-Overview","page":"Home","title":"Documentation Overview","text":"","category":"section"},{"location":"#**Core-Documentation**","page":"Home","title":"📚 Core Documentation","text":"Mathematical Formulation - Complete theoretical framework and equations\nFundamental assumptions and working fluid definition\nEquation of state and heat capacities\nInternal energies, enthalpies, and latent heats\nSaturation vapor pressure and specific humidity\nSaturation adjustment algorithms\nAuxiliary thermodynamic functions","category":"section"},{"location":"#**User-Guides**","page":"Home","title":"🛠️ User Guides","text":"How-To Guide - Practical usage examples and patterns\nInstallation and setup\nCommon use cases and workflows","category":"section"},{"location":"#**Advanced-Topics**","page":"Home","title":"🔬 Advanced Topics","text":"Temperature Profiles - Pre-defined atmospheric profiles to be used as reference states in atmosphere models and for testing\nTested Profiles - Thermodynamic profiles used for testing of the package (Internal Use)","category":"section"},{"location":"#**Package-Reference**","page":"Home","title":"📖 Package Reference","text":"API Reference - Complete function documentation\nThermodynamics Parameters\nTypes\nThermodynamic Functions\nTemperature Profiles\nData Collection","category":"section"},{"location":"#**Published-References-and-Background**","page":"Home","title":"📚 Published References and Background","text":"References - Bibliography of theoretical foundations","category":"section"},{"location":"#Key-Features","page":"Home","title":"Key Features","text":"","category":"section"},{"location":"#**Comprehensive-Thermodynamics**","page":"Home","title":"🌟 Comprehensive Thermodynamics","text":"Moist air thermodynamics including all water phases (vapor, liquid, ice).\nStateless, functional API for flexibility and integration.\nConsistent formulation assuming a calorically perfect gas mixture.","category":"section"},{"location":"#**High-Performance**","page":"Home","title":"⚡ High Performance","text":"Type-stable and GPU-compatible (CUDA.jl, AMDGPU.jl, etc.).\nAD-compatible (ForwardDiff.jl, etc.) for differentiable physics.\nZero-allocation design for core functions.","category":"section"},{"location":"#**Flexible-Design**","page":"Home","title":"🔧 Flexible Design","text":"Multiple formulations: Solve for phase equilibrium from (ρ, e_int), (p, h), (p, θ_li), etc., or using direct functional relationships.\nExtensible parameters: Easily adapt to different planetary atmospheres via ClimaParams.\nComprehensive testing and validation suite.","category":"section"},{"location":"#Core-Design-Principles","page":"Home","title":"Core Design Principles","text":"","category":"section"},{"location":"#**Functional-and-Stateless**","page":"Home","title":"Functional & Stateless","text":"Functions in Thermodynamics.jl are stateless. They take a ThermodynamicsParameters struct and the necessary thermodynamic variables (e.g., T, ρ, q...) as arguments. This design fits naturally into large-scale simulations (e.g., with ClimaAtmos.jl).","category":"section"},{"location":"#**Working-Fluid**","page":"Home","title":"Working Fluid","text":"The working fluid is moist air (dry air + water vapor + liquid water + ice, which may include precipitation). We treat it as a mixture of ideal gases and condensed phases, ensuring thermodynamic consistency and rigorous mass and energy conservation.","category":"section"},{"location":"#**Consistent-Formulation**","page":"Home","title":"Consistent Formulation","text":"All quantities are derived from the calorically perfect gas assumption with constant specific heat capacities. This provides a consistent, closed set of equations for saturation vapor pressures (the so-called Rankine-Kirchhoff approximation), latent heats, and other derived quantities.","category":"section"},{"location":"#Usage-Examples","page":"Home","title":"Usage Examples","text":"","category":"section"},{"location":"#**Phase-Equilibrium-(Saturation-Adjustment)**","page":"Home","title":"Phase Equilibrium (Saturation Adjustment)","text":"To find the phase equilibrium temperature and phase partition from phase non-equilibrium variables (e.g., given ρ, e_int, q_tot), use saturation_adjustment:\n\n# Define thermodynamic variables: internal energy, density, and total humidity\nρ = 1.0\ne_int = -7.0e4\nq_tot = 0.01\n\n# Solve for phase equilibrium\n# (using SecantMethod, but NewtonsMethod is also available for ρe)\nsol = TD.saturation_adjustment(\n    RS.SecantMethod, \n    params, \n    TD.ρe(), \n    ρ, e_int, q_tot, \n    10, 1e-4\n)\n\nprintln(\"T: \", sol.T)\nprintln(\"q_liq: \", sol.q_liq)\nprintln(\"q_ice: \", sol.q_ice)","category":"section"},{"location":"#**Phase-Non-Equilibrium**","page":"Home","title":"Phase Non-Equilibrium","text":"Directly compute properties from thermodynamic variables without assuming equilibrium of phases and using saturation adjustment:\n\n# Define variables\nq_tot = 0.01\nq_liq = 0.005\nq_ice = 0.0003\nρ = 1.0\ne_int = -7.0e4\n\n# Compute temperature directly\nT = TD.air_temperature(params, e_int, q_tot, q_liq, q_ice)\n\n# Compute pressure directly\np = TD.air_pressure(params, T, ρ, q_tot, q_liq, q_ice)\nprintln(\"T: \", T)\nprintln(\"p: \", p)","category":"section"},{"location":"#**Saturation-Calculations**","page":"Home","title":"Saturation Calculations","text":"T = 280.0\nρ = 1.0\nq_tot = 0.01\n\n# Saturation vapor pressure\np_v_sat = TD.saturation_vapor_pressure(params, T, TD.Liquid())\n\n# Saturation specific humidity\nq_v_sat = TD.q_vap_saturation(params, T, ρ)\n\n# Phase partition assuming phase equilibrium\n(q_liq, q_ice) = TD.condensate_partition(params, T, ρ, q_tot)","category":"section"},{"location":"#Integration-with-Climate-Models","page":"Home","title":"Integration with Climate Models","text":"","category":"section"},{"location":"#**Dynamical-Core-Integration**","page":"Home","title":"Dynamical Core Integration","text":"The package is designed for seamless integration with atmospheric dynamical cores, schematically as follows:\n\n# Initialize\nimport Thermodynamics as TD\nimport RootSolvers as RS\nusing ClimaParams\n\nFT = Float64\nparams = TD.Parameters.ThermodynamicsParameters(FT)\n\n# Define physical constants and initial conditions\ngrav = TD.Parameters.grav(params)\ncv_d = TD.Parameters.cv_d(params)\nz = 1000.0   # m\ngeopotential = grav * z\nq_tot = 0.01\nρ = 1.0\nT = 300.0\n\n# Initial velocity components\nu, v, w = 10.0, 5.0, 1.0\ne_kin = 0.5 * (u^2 + v^2 + w^2)\n\n# Specific total energy e_tot = e_int + e_kin + geopotential\n(q_liq, q_ice) = TD.condensate_partition(params, T, ρ, q_tot)\ne_int = TD.internal_energy(params, T, q_tot, q_liq, q_ice)\ne_tot = e_int + e_kin + geopotential\n\nprintln(\"Initial u: \", u)\nprintln(\"Initial e_tot: \", e_tot)\n\n# Timestepping loop (simplified example)\nfor timestep in 1:10\n    # Advance dynamical variables (simplified)\n    # Note: In a real simulation, we would update the state vector.\n    # Here we just re-use the variable names for demonstration.\n    u_new = u + FT(0.1) \n    e_tot_new = e_tot + cv_d * FT(1)\n    \n    # Compute new internal energy\n    e_kin_new = 0.5 * (u_new^2 + v^2 + w^2)\n    e_int_new = e_tot_new - e_kin_new - geopotential\n    \n    # Saturation adjustment to get T, q_liq, q_ice\n    local sol = TD.saturation_adjustment(\n        RS.NewtonsMethod, \n        params, \n        TD.ρe(), \n        ρ, e_int_new, q_tot, \n        10, 1e-4\n    )\n    \n    T_new = sol.T\n    q_liq_new = sol.q_liq\n    q_ice_new = sol.q_ice\n    \n    # Compute pressure for dynamics\n    p_new = TD.air_pressure(params, T_new, ρ, q_tot, q_liq_new, q_ice_new)\n    \n    # Update state for next iteration (in real code)\n    global u = u_new\n    global e_tot = e_tot_new\nend\nprintln(\"Final u: \", u)\nprintln(\"Final e_tot: \", e_tot)","category":"section"},{"location":"#Next-Steps","page":"Home","title":"Next Steps","text":"Read the Mathematical Formulation for theoretical background\nFollow the How-To Guide for practical examples\nExplore the API Reference for complete function documentation\n\n\n\nnote: Citation\nIf you use Thermodynamics.jl in your research, please cite the relevant papers listed in the References section.\n\ntip: Getting Help\nFor questions and issues, please check the documentation or open an issue on the GitHub repository.","category":"section"},{"location":"API/#Thermodynamics","page":"API Reference","title":"Thermodynamics","text":"","category":"section"},{"location":"API/#Thermodynamics-Parameters","page":"API Reference","title":"Thermodynamics Parameters","text":"","category":"section"},{"location":"API/#Types","page":"API Reference","title":"Types","text":"","category":"section"},{"location":"API/#Thermodynamic-Functions","page":"API Reference","title":"Thermodynamic Functions","text":"","category":"section"},{"location":"API/#Air-Properties","page":"API Reference","title":"Air Properties","text":"","category":"section"},{"location":"API/#Air-Humidities","page":"API Reference","title":"Air Humidities","text":"","category":"section"},{"location":"API/#Air-Energies","page":"API Reference","title":"Air Energies","text":"","category":"section"},{"location":"API/#Air-Temperatures","page":"API Reference","title":"Air Temperatures","text":"","category":"section"},{"location":"API/#Air-Pressure-and-Density","page":"API Reference","title":"Air Pressure and Density","text":"","category":"section"},{"location":"API/#Air-Saturation-Functions","page":"API Reference","title":"Air Saturation Functions","text":"","category":"section"},{"location":"API/#Saturation-Adjustment","page":"API Reference","title":"Saturation Adjustment","text":"","category":"section"},{"location":"API/#Air-Entropies","page":"API Reference","title":"Air Entropies","text":"","category":"section"},{"location":"API/#Temperature-Profiles","page":"API Reference","title":"Temperature Profiles","text":"","category":"section"},{"location":"API/#Data-Collection","page":"API Reference","title":"Data Collection","text":"","category":"section"},{"location":"API/#Deprecated-Functions","page":"API Reference","title":"Deprecated Functions","text":"These functions are deprecated and will be removed in a future release.","category":"section"},{"location":"API/#Backward-Compatibility-Wrappers","page":"API Reference","title":"Backward Compatibility Wrappers","text":"These wrappers exist for backward compatibility with older versions of the package.","category":"section"},{"location":"API/#Other-Deprecated-Functions","page":"API Reference","title":"Other Deprecated Functions","text":"","category":"section"},{"location":"API/#Thermodynamic-State-Constructors-(Deprecated)","page":"API Reference","title":"Thermodynamic State Constructors (Deprecated)","text":"","category":"section"},{"location":"API/#Thermodynamics.Thermodynamics","page":"API Reference","title":"Thermodynamics.Thermodynamics","text":"Thermodynamics\n\nMoist thermodynamic functions for atmospheric modeling, including air pressure, latent heats, saturation vapor pressures, and saturation specific humidities.\n\nParameter Sets\n\nMany functions defined in this module rely on ClimaParams.jl. ClimaParams.jl defines several functions (e.g., many planet parameters). For example, to compute the mole-mass ratio of  dry air and water vapor:\n\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\nFT = Float64\nparam_set = TP.ThermodynamicsParameters(FT)\nRv_over_Rd = TP.Rv_over_Rd(param_set)\n\nBecause these parameters are widely used throughout this module, param_set is an argument for many Thermodynamics functions.\n\nSaturation adjustment\n\nOne entry point is saturation_adjustment. It accepts:\n\nmethod: A root-solving method type from RootSolvers.jl (e.g., RS.NewtonsMethod, RS.SecantMethod).\nparam_set: The thermodynamics parameter set.\nformulation: The thermodynamic formulation (e.g., ρe(), ph()).\nThermodynamic state variables appropriate for the formulation.\n\nSupported methods in RootSolvers.jl:\n\nNewtonsMethod: Newton method with analytic gradients (recommended for ρe).\nNewtonsMethodAD: Newton method with automatic differentiation.\nSecantMethod: Secant method (derivative-free).\nBrentsMethod: Brent's method (hybrid root-finding).\n\nThermodynamic functions\n\nMany thermodynamic functions (e.g., air_temperature, air_pressure) are dispatched over the independent variables used to compute them. The available independent variable types (subtypes of IndepVars) are:\n\nρe: Density, internal energy, and specific humidities\npe: Pressure, internal energy, and specific humidities\nph: Pressure, enthalpy, and specific humidities\npρ: Pressure, density, and specific humidities\npθ_li: Pressure, liquid-ice potential temperature, and specific humidities\nρθ_li: Density, liquid-ice potential temperature, and specific humidities\n\n\n\n\n\n","category":"module"},{"location":"API/#Thermodynamics.Parameters","page":"API Reference","title":"Thermodynamics.Parameters","text":"Parameters\n\nSubmodule defining thermodynamic parameter types and accessor functions.\n\n\n\n\n\n","category":"module"},{"location":"API/#Thermodynamics.Parameters.ThermodynamicsParameters","page":"API Reference","title":"Thermodynamics.Parameters.ThermodynamicsParameters","text":"ThermodynamicsParameters\n\nParameters for Thermodynamics.jl.\n\nExample\n\nimport ClimaParams as CP\nimport Thermodynamics.Parameters as TP\n\nFT = Float64;\nparam_set = TP.ThermodynamicsParameters(FT)\n\n# Alternatively:\n\ntoml_dict = CP.create_toml_dict(FT)\nparam_set = TP.ThermodynamicsParameters(toml_dict)\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.Phase","page":"API Reference","title":"Thermodynamics.Phase","text":"Phase\n\nA condensed phase, to dispatch over (e.g., in saturation_vapor_pressure).\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.Liquid","page":"API Reference","title":"Thermodynamics.Liquid","text":"Liquid <: Phase\n\nA liquid phase, to dispatch over (e.g., in saturation_vapor_pressure).\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.Ice","page":"API Reference","title":"Thermodynamics.Ice","text":"Ice <: Phase\n\nAn ice phase, to dispatch over (e.g., in saturation_vapor_pressure).\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.IndepVars","page":"API Reference","title":"Thermodynamics.IndepVars","text":"IndepVars\n\nAbstract type to dispatch over the independent variables used to compute a thermodynamic quantity (e.g., in air_temperature).\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.ρe","page":"API Reference","title":"Thermodynamics.ρe","text":"ρe <: IndepVars\n\nDensity, internal energy, and specific humidity\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.pe","page":"API Reference","title":"Thermodynamics.pe","text":"pe <: IndepVars\n\nPressure, internal energy, and specific humidity\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.ph","page":"API Reference","title":"Thermodynamics.ph","text":"ph <: IndepVars\n\nPressure, enthalpy, and specific humidity\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.pρ","page":"API Reference","title":"Thermodynamics.pρ","text":"pρ <: IndepVars\n\nPressure, density, and specific humidity\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.pθ_li","page":"API Reference","title":"Thermodynamics.pθ_li","text":"pθ_li <: IndepVars\n\nPressure, liquid-ice potential temperature, and specific humidity\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.ρθ_li","page":"API Reference","title":"Thermodynamics.ρθ_li","text":"ρθ_li <: IndepVars\n\nDensity, liquid-ice potential temperature, and specific humidity\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.DryAdiabaticProcess","page":"API Reference","title":"Thermodynamics.DryAdiabaticProcess","text":"DryAdiabaticProcess\n\nA type for dispatching to isentropic (dry adiabatic) formulas.\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.gas_constant_air","page":"API Reference","title":"Thermodynamics.gas_constant_air","text":"gas_constant_air(param_set, q_tot=0, q_liq=0, q_ice=0)\n\nThe specific gas constant of moist air R_m.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nR_m: specific gas constant of moist air [J/(kg·K)]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression.\n\n\n\n\n\ngas_constant_air(param_set, ts::ThermodynamicState)\n\nThe specific gas constant of moist air.\n\n\n\n\n\ngas_constant_air(param_set[, q::PhasePartition])\n\nThe specific gas constant of moist air.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nq PhasePartition.\n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.cp_m","page":"API Reference","title":"Thermodynamics.cp_m","text":"cp_m(param_set, q_tot=0, q_liq=0, q_ice=0)\n\nThe isobaric specific heat capacity of moist air cp_m.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nq_tot: total specific humidity of water [kg/kg]\nq_liq: specific humidity of liquid [kg/kg]\nq_ice: specific humidity of ice [kg/kg]\n\nReturns\n\ncp_m: isobaric specific heat capacity [J/(kg·K)]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The specific heat capacities are assumed to be constant (calorically perfect air).\n\n\n\n\n\ncp_m(param_set, ts::ThermodynamicState)\n\nThe isobaric specific heat capacity of moist air.\n\n\n\n\n\ncp_m(param_set[, q::PhasePartition])\n\nThe isobaric specific heat capacity of moist air.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nq PhasePartition.\n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.cv_m","page":"API Reference","title":"Thermodynamics.cv_m","text":"cv_m(param_set, q_tot=0, q_liq=0, q_ice=0)\n\nThe isochoric specific heat capacity of moist air cv_m.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ncv_m: isochoric specific heat capacity [J/(kg·K)]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The specific heat capacities are assumed to be constant (calorically perfect air).\n\n\n\n\n\ncv_m(param_set, ts::ThermodynamicState)\n\nThe isochoric specific heat capacity of moist air.\n\n\n\n\n\ncv_m(param_set[, q::PhasePartition])\n\nThe isochoric specific heat capacity of moist air.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nq PhasePartition. Without humidity argument, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.soundspeed_air","page":"API Reference","title":"Thermodynamics.soundspeed_air","text":"soundspeed_air(param_set, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe speed of sound in unstratified air.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nc: speed of sound [m/s]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The formula is c = √(γ R_m T) where γ = cp_m/cv_m.\n\n\n\n\n\nsoundspeed_air(param_set, ts::ThermodynamicState)\n\nThe speed of sound in unstratified air.\n\n\n\n\n\nsoundspeed_air(param_set, T[, q::PhasePartition])\n\nThe speed of sound in unstratified air.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.vapor_specific_humidity","page":"API Reference","title":"Thermodynamics.vapor_specific_humidity","text":"vapor_specific_humidity(q_tot=0, q_liq=0, q_ice=0)\n\nThe vapor specific humidity (clamped to be non-negative).\n\nArguments\n\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nq_vap: vapor specific humidity [kg/kg]\n\nIf the specific humidities are not given, the result is zero. The formula is q_vap = q_tot - q_liq - q_ice.\n\n\n\n\n\nvapor_specific_humidity(param_set, ts::ThermodynamicState)\n\nThe vapor specific humidity.\n\n\n\n\n\nvapor_specific_humidity(q::PhasePartition)\n\nThe vapor specific humidity. \n\nq a PhasePartition \n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.condensate_specific_humidity","page":"API Reference","title":"Thermodynamics.condensate_specific_humidity","text":"condensate_specific_humidity(q_liq=0, q_ice=0)\n\nThe condensate specific humidity.\n\nArguments\n\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nq_cond: condensate specific humidity [kg/kg]\n\nIf the specific humidities are not given, the result is zero. The formula is q_cond = q_liq + q_ice.\n\n\n\n\n\ncondensate_specific_humidity(param_set, ts::ThermodynamicState)\n\nThe condensate specific humidity (liquid + ice).\n\n\n\n\n\ncondensate_specific_humidity(q::PhasePartition{FT})\n\nThe condensate specific humidity (liquid + ice) of the phase  partition q.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.vol_vapor_mixing_ratio","page":"API Reference","title":"Thermodynamics.vol_vapor_mixing_ratio","text":"vol_vapor_mixing_ratio(param_set, q_tot=0, q_liq=0, q_ice=0)\n\nThe molar (volume) mixing ratio of water vapor.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nr_v: molar mixing ratio of water vapor [mol/mol]\n\nIf the specific humidities are not given, the result is zero.\n\n\n\n\n\nvol_vapor_mixing_ratio(param_set, ts::ThermodynamicState)\n\nThe volume mixing ratio of water vapor.\n\n\n\n\n\nvol_vapor_mixing_ratio(param_set, q::PhasePartition)\n\nThe volume mixing ratio of water vapor.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nq PhasePartition\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.partial_pressure_dry","page":"API Reference","title":"Thermodynamics.partial_pressure_dry","text":"partial_pressure_dry(param_set, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe partial pressure of dry air.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: air pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\np_d: partial pressure of dry air [Pa]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this equals the total pressure.\n\n\n\n\n\npartial_pressure_dry(param_set, ts::ThermodynamicState)\n\nThe partial pressure of dry air.\n\n\n\n\n\npartial_pressure_dry(param_set, p, q::PhasePartition)\n\nThe partial pressure of dry air.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np air pressure\nq phase partition\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.partial_pressure_vapor","page":"API Reference","title":"Thermodynamics.partial_pressure_vapor","text":"partial_pressure_vapor(param_set, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe partial pressure of water vapor.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: air pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\np_v: partial pressure of water vapor [Pa]\n\nIf the specific humidities are not given, the partial pressure is zero.\n\n\n\n\n\npartial_pressure_vapor(param_set, ts::ThermodynamicState)\n\nThe partial pressure of water vapor.\n\n\n\n\n\npartial_pressure_vapor(param_set, p, q::PhasePartition)\n\nThe partial pressure of water vapor.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np air pressure\nq phase partition\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.vapor_pressure_deficit","page":"API Reference","title":"Thermodynamics.vapor_pressure_deficit","text":"vapor_pressure_deficit(param_set, T, p, q_tot, q_liq, q_ice, phase::Phase)\n\nThe vapor pressure deficit (saturation vapor pressure minus actual vapor pressure,  truncated to be non-negative) over a specific phase (Liquid or Ice).\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: air temperature [K]\np: air pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\nphase: phase to compute saturation over (Liquid() or Ice())\n\nReturns\n\nVPD: vapor pressure deficit [Pa]\n\n\n\n\n\nvapor_pressure_deficit(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe vapor pressure deficit (saturation vapor pressure minus actual vapor pressure,  truncated to be non-negative) over liquid water for temperatures above freezing  and over ice for temperatures below freezing.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: air temperature [K]\np: air pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nVPD: vapor pressure deficit [Pa]\n\nIf the specific humidities are not given, the result is the saturation vapor pressure.\n\n\n\n\n\nvapor_pressure_deficit(param_set, T, p[, q::PhasePartition])\n\nThe vapor pressure deficit (saturation vapor pressure minus actual  vapor pressure, truncated to be non-negative) over liquid water for temperatures  above freezing and over ice for temperatures below freezing.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT air temperature\np air pressure\nq PhasePartition\n\nWhen q is not provided, the vapor pressure deficit is the saturation vapor pressure.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.relative_humidity","page":"API Reference","title":"Thermodynamics.relative_humidity","text":"relative_humidity(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe relative humidity (clipped between 0 and 1).\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\np: pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nRH: relative humidity [dimensionless], 0 ≤ RH ≤ 1\n\nIf q_liq and q_ice are zero (or not given), the relative humidity is computed relative to saturation over ice below freezing and over liquid above freezing. If condensate is present, the relative humidity is computed relative to saturation over a mixture of liquid and ice, with the liquid fraction given by the ratio q_liq / (q_liq + q_ice).\n\nNote: relative_humidity uses saturation_vapor_pressure(param_set, T, q_liq, q_ice). In particular, for q_liq == q_ice == 0 it includes a small smooth transition around freezing (via liquid_fraction(param_set, T, q_liq, q_ice)).\n\n\n\n\n\nrelative_humidity(param_set, ts::ThermodynamicState)\n\nThe relative humidity.\n\n\n\n\n\nrelative_humidity(param_set, T, p, phase_type, q::PhasePartition)\n\nThe relative humidity (clipped between 0 and 1).\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\np pressure\nphase_type a thermodynamic state type\nq PhasePartition.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.condensate_partition","page":"API Reference","title":"Thermodynamics.condensate_partition","text":"condensate_partition(param_set, T, ρ, q_tot)\n\nCompute the equilibrium liquid and ice specific humidities from the condensate in thermodynamic equilibrium, returning a tuple (q_liq, q_ice).\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nρ: (moist-)air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\n\nReturns\n\n(q_liq, q_ice): tuple of liquid and ice specific humidities [kg/kg]\n\nThe condensate is partitioned into liquid and ice using the temperature-dependent liquid fraction (see liquid_fraction) and the saturation excess (see  saturation_excess).\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.has_condensate","page":"API Reference","title":"Thermodynamics.has_condensate","text":"has_condensate(q_c)\n\nBool indicating if condensate exists, i.e., q_c > eps.\n\nWe use a threshold of eps rather than 0 to avoid division by zero in functions such as liquid_fraction and to robustly handle numerical noise.\n\n\n\n\n\nhas_condensate(param_set, ts::ThermodynamicState)\n\nBool indicating if condensate exists.\n\n\n\n\n\nhas_condensate(q::PhasePartition{FT})\n\nBool indicating if condensate exists in the phase partition\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.liquid_fraction","page":"API Reference","title":"Thermodynamics.liquid_fraction","text":"liquid_fraction(param_set, T, q_liq, q_ice)\n\nThe fraction of condensate that is liquid.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nλ: liquid fraction [dimensionless], 0 ≤ λ ≤ 1\n\nThe liquid fraction is computed from q_liq and q_ice. If q_liq + q_ice exceeds a small threshold (see has_condensate), q_liq / (q_liq + q_ice) is returned. If there is effectively no condensate, a smooth temperature-dependent partitioning is used (linear ramp from 0 to 1 over ±0.1 K around freezing).\n\n\n\n\n\nliquid_fraction(param_set, ts::ThermodynamicState)\n\nThe fraction of condensate that is liquid.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.liquid_fraction_ramp","page":"API Reference","title":"Thermodynamics.liquid_fraction_ramp","text":"liquid_fraction_ramp(param_set, T)\n\nThe liquid fraction computed from temperature using a power law interpolation between T_icenuc and T_freeze.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\n\nReturns\n\nλ: liquid fraction [dimensionless], 0 ≤ λ ≤ 1\n\nEdge cases:\n\nFor T > T_freeze, this returns 1; for T ≤ T_icenuc, it returns 0.\n\nReference\n\nKaul et al. (2015), \"Sensitivities in large-eddy simulations of mixed-phase Arctic stratocumulus clouds using a simple microphysics approach,\" Monthly Weather Review, 143, 4393-4421, doi:10.1175/MWR-D-14-00319.1.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.specific_humidity_to_mixing_ratio","page":"API Reference","title":"Thermodynamics.specific_humidity_to_mixing_ratio","text":"specific_humidity_to_mixing_ratio(q, q_tot)\n\nConverts specific humidity to mixing ratio (total basis).\n\nArguments\n\nq: specific humidity of interest [kg/kg]\nq_tot: total specific humidity [kg/kg]\n\nReturns\n\nr: mixing ratio [kg/kg]\n\nNote that this function is singular when q_tot = 1. The formula is r = q / (1 - q_tot).\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.internal_energy","page":"API Reference","title":"Thermodynamics.internal_energy","text":"internal_energy(param_set, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe internal energy per unit mass.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ne_int: specific internal energy [J/kg]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The internal energy is computed as a mass-weighted sum of the internal energies of each component (dry air, vapor, liquid, ice), referenced to T_0.\n\n\n\n\n\ninternal_energy(param_set, ts::ThermodynamicState)\n\nThe internal energy per unit mass.\n\n\n\n\n\ninternal_energy(param_set, T[, q::PhasePartition])\n\nThe internal energy per unit mass. \n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.internal_energy_dry","page":"API Reference","title":"Thermodynamics.internal_energy_dry","text":"internal_energy_dry(param_set, T)\n\nThe dry air internal energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\n\nReturns\n\ne_d: specific internal energy of dry air [J/kg]\n\n\n\n\n\ninternal_energy_dry(param_set, ts::ThermodynamicState)\n\nThe dry air internal energy.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.internal_energy_vapor","page":"API Reference","title":"Thermodynamics.internal_energy_vapor","text":"internal_energy_vapor(param_set, T)\n\nThe water vapor internal energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\n\nReturns\n\ne_v: specific internal energy of water vapor [J/kg]\n\n\n\n\n\ninternal_energy_vapor(param_set, ts::ThermodynamicState)\n\nThe water vapor internal energy.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.internal_energy_liquid","page":"API Reference","title":"Thermodynamics.internal_energy_liquid","text":"internal_energy_liquid(param_set, T)\n\nThe liquid water internal energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\n\nReturns\n\ne_l: specific internal energy of liquid water [J/kg]\n\n\n\n\n\ninternal_energy_liquid(param_set, ts::ThermodynamicState)\n\nThe liquid water internal energy.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.internal_energy_ice","page":"API Reference","title":"Thermodynamics.internal_energy_ice","text":"internal_energy_ice(param_set, T)\n\nThe ice internal energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\n\nReturns\n\ne_i: specific internal energy of ice [J/kg]\n\n\n\n\n\ninternal_energy_ice(param_set, ts::ThermodynamicState)\n\nThe ice internal energy.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.enthalpy","page":"API Reference","title":"Thermodynamics.enthalpy","text":"enthalpy(e_int, R_m, T)\n\nThe specific enthalpy.\n\nArguments\n\ne_int: internal specific energy [J/kg]\nR_m: gas constant of moist air [J/(kg·K)], see gas_constant_air\nT: air temperature [K]\n\nReturns\n\nh: specific enthalpy [J/kg]\n\nThe enthalpy is computed as h = e_int + R_m T, which follows from h = e_int + p v with the ideal gas law p v = R_m T (specific volume v = 1/ρ).\n\n\n\n\n\nenthalpy(param_set, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe specific enthalpy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nh: specific enthalpy [J/kg]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The enthalpy is computed as a mass-weighted sum of the enthalpies of each component (dry air, vapor, liquid, ice).\n\n\n\n\n\nenthalpy(param_set, ts)\n\nThe specific enthalpy.\n\n\n\n\n\nenthalpy(param_set, T, q::PhasePartition)\n\nThe specific enthalpy.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nq PhasePartition. \n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.enthalpy_dry","page":"API Reference","title":"Thermodynamics.enthalpy_dry","text":"enthalpy_dry(param_set, T)\n\nThe specific enthalpy of dry air.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\n\nReturns\n\nh_d: specific enthalpy of dry air [J/kg]\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.enthalpy_vapor","page":"API Reference","title":"Thermodynamics.enthalpy_vapor","text":"enthalpy_vapor(param_set, T)\n\nThe specific enthalpy of water vapor.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\n\nReturns\n\nh_v: specific enthalpy of water vapor [J/kg]\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.enthalpy_liquid","page":"API Reference","title":"Thermodynamics.enthalpy_liquid","text":"enthalpy_liquid(param_set, T)\n\nThe specific enthalpy of liquid.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\n\nReturns\n\nh_l: specific enthalpy of liquid [J/kg]\n\nThe specific enthalpy of liquid is equal to the internal energy of liquid because the specific volume of condensed water is neglected (i.e., p v_l ≈ 0).\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.enthalpy_ice","page":"API Reference","title":"Thermodynamics.enthalpy_ice","text":"enthalpy_ice(param_set, T)\n\nThe specific enthalpy of ice.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\n\nReturns\n\nh_i: specific enthalpy of ice [J/kg]\n\nThe specific enthalpy of ice is equal to the internal energy of ice because the specific volume of condensed water is neglected (i.e., p v_i ≈ 0).\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.total_energy","page":"API Reference","title":"Thermodynamics.total_energy","text":"total_energy(param_set, e_kin, e_pot, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe total energy per unit mass.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\ne_kin: kinetic energy per unit mass [J/kg]\ne_pot: gravitational potential energy (geopotential)per unit mass [J/kg]\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ne_tot: total specific energy [J/kg]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The total energy is e_tot = e_int + e_kin + e_pot.\n\n\n\n\n\ntotal_energy(param_set, ts::ThermodynamicState, e_kin, e_pot)\n\nThe total energy per unit mass.\n\n\n\n\n\ntotal_energy(param_set, e_kin, e_pot, T[, q::PhasePartition])\n\nThe total energy per unit mass.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\ne_kin kinetic energy per unit mass\ne_pot gravitational potential energy per unit mass\nT temperature\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.total_enthalpy","page":"API Reference","title":"Thermodynamics.total_enthalpy","text":"total_enthalpy(e_tot, R_m, T)\n\nThe total specific enthalpy.\n\nArguments\n\ne_tot: total specific energy [J/kg]\nR_m: gas constant of moist air [J/(kg·K)], see gas_constant_air\nT: air temperature [K]\n\nReturns\n\nh_tot: total specific enthalpy [J/kg]\n\nThe total enthalpy is computed as h_tot = e_tot + R_m T.\n\n\n\n\n\ntotal_enthalpy(param_set, ts, e_tot::Real)\n\nThe total specific enthalpy.\n\n\n\n\n\ntotal_enthalpy(param_set, e_tot, T[, q::PhasePartition])\n\nThe total specific enthalpy, defined as e_tot + R_m * T.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\ne_tot total specific energy\nT temperature\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.dry_static_energy","page":"API Reference","title":"Thermodynamics.dry_static_energy","text":"dry_static_energy(param_set, T, e_pot)\n\nThe dry static energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\ne_pot: gravitational potential energy per unit mass (geopotential) [J/kg]\n\nReturns\n\ns_d: dry static energy [J/kg]\n\nThe dry static energy is the sum of the dry enthalpy and geopotential: s_d = h_d + e_pot.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.vapor_static_energy","page":"API Reference","title":"Thermodynamics.vapor_static_energy","text":"vapor_static_energy(param_set, T, e_pot)\n\nThe static energy (sensible heat only) of water vapor.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\ne_pot: gravitational potential energy per unit mass (geopotential) [J/kg]\n\nReturns\n\ns_v: vapor static energy [J/kg]\n\nThe formula is s_v = cp_v * (T - T_0) + e_pot, where T_0 is the reference temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.moist_static_energy","page":"API Reference","title":"Thermodynamics.moist_static_energy","text":"moist_static_energy(param_set, T, e_pot, q_tot=0, q_liq=0, q_ice=0)\n\nThe moist static energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\ne_pot: gravitational potential energy per unit mass (geopotential) [J/kg]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ns_m: moist static energy [J/kg]\n\nIf the specific humidities are not given, the result is for dry air. The moist static energy is the sum of the moist enthalpy and geopotential: s_m = h + e_pot, where h is computed from enthalpy.\n\n\n\n\n\nmoist_static_energy(param_set, ts, e_pot)\n\nThe moist static energy.\n\n\n\n\n\nmoist_static_energy(param_set, T, e_pot, q::PhasePartition)\n\nThe moist static energy.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\ne_pot gravitational potential energy per unit mass (geopotential)\nq PhasePartition. \n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.virtual_dry_static_energy","page":"API Reference","title":"Thermodynamics.virtual_dry_static_energy","text":"virtual_dry_static_energy(param_set, T, e_pot, q_tot=0, q_liq=0, q_ice=0)\n\nThe virtual dry static energy.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\ne_pot: gravitational potential energy per unit mass (geopotential) [J/kg]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ns_vd: virtual dry static energy [J/kg]\n\nIf the specific humidities are not given, the result is for dry air. The virtual dry static energy is s_vd = cp_d * (T_virt - T_0) + e_pot, where T_virt is the virtual temperature (see virtual_temperature) and T_0 is the reference temperature.\n\n\n\n\n\nvirtual_dry_static_energy(param_set, ts, e_pot)\n\nThe virtual dry static energy.\n\n\n\n\n\nvirtual_dry_static_energy(param_set, T, e_pot, q::PhasePartition)\n\nThe virtual dry static energy.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\ne_pot gravitational potential energy per unit mass (geopotential)\nq PhasePartition. \n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.latent_heat_fusion","page":"API Reference","title":"Thermodynamics.latent_heat_fusion","text":"latent_heat_fusion(param_set, T)\n\nThe specific latent heat of fusion L_f.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\n\nReturns\n\nL_f: latent heat of fusion [J/kg]\n\nBecause the specific heats are assumed constant, the latent heats are linear functions of temperature by Kirchhoff's law.\n\n\n\n\n\nlatent_heat_fusion(param_set, ts::ThermodynamicState)\n\nThe specific latent heat of fusion.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.latent_heat_sublim","page":"API Reference","title":"Thermodynamics.latent_heat_sublim","text":"latent_heat_sublim(param_set, T)\n\nThe specific latent heat of sublimation L_s.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\n\nReturns\n\nL_s: latent heat of sublimation [J/kg]\n\nBecause the specific heats are assumed constant, the latent heats are linear functions of temperature by Kirchhoff's law.\n\n\n\n\n\nlatent_heat_sublim(param_set, ts::ThermodynamicState)\n\nThe specific latent heat of sublimation.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.latent_heat_vapor","page":"API Reference","title":"Thermodynamics.latent_heat_vapor","text":"latent_heat_vapor(param_set, T)\n\nThe specific latent heat of vaporization L_v.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\n\nReturns\n\nL_v: latent heat of vaporization [J/kg]\n\nBecause the specific heats are assumed constant, the latent heats are linear functions of temperature by Kirchhoff's law.\n\n\n\n\n\nlatent_heat_vapor(param_set, ts::ThermodynamicState)\n\nThe specific latent heat of vaporization.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.latent_heat_mixed","page":"API Reference","title":"Thermodynamics.latent_heat_mixed","text":"latent_heat_mixed(param_set, T, λ)\n\nThe specific latent heat of a mixed phase, weighted by the liquid fraction λ.\n\nparam_set thermodynamics parameter set, see the Thermodynamics for more details\nT air temperature\nλ liquid fraction\n\nBecause the specific heats are assumed constant, the latent heats are linear functions of  temperature by Kirchhoff's law.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.humidity_weighted_latent_heat","page":"API Reference","title":"Thermodynamics.humidity_weighted_latent_heat","text":"humidity_weighted_latent_heat(param_set, q_liq=0, q_ice=0)\n\nSpecific-humidity weighted sum of latent heats of liquid and ice evaluated at reference temperature T_0.\n\nparam_set thermodynamics parameter set, see the Thermodynamics for more details\nq_liq liquid specific humidity\nq_ice ice specific humidity\n\nIf q_liq and q_ice are not provided, humidity_weighted_latent_heat is zero.\n\n\n\n\n\nhumidity_weighted_latent_heat(param_set::APS, ts::ThermodynamicState)\n\nSpecific-humidity weighted sum of latent heats of liquid and ice evaluated at reference temperature T_0.\n\n\n\n\n\nhumidity_weighted_latent_heat(param_set[, q::PhasePartition])\n\nSpecific-humidity weighted sum of latent heats of liquid and ice evaluated at reference temperature  T_0.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nq PhasePartition. \n\nWhen q is not provided, humidity_weighted_latent_heat is zero.\n\nThis is used in the evaluation of the liquid-ice potential temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_temperature","page":"API Reference","title":"Thermodynamics.air_temperature","text":"air_temperature(param_set, e_int, q_tot=0, q_liq=0, q_ice=0)\n\nThe air temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\ne_int: specific internal energy of moist air [J/kg]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nT: air temperature [K]\n\nIf the specific humidities are not given, the result is for dry air. This method inverts internal_energy by solving for T given e_int.\n\n\n\n\n\nair_temperature(param_set, ::ph, h, q_tot=0, q_liq=0, q_ice=0)\n\nThe air temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nh: specific enthalpy of moist air [J/kg]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nT: air temperature [K]\n\nIf the specific humidities are not given, the result is for dry air. This method inverts enthalpy by solving for T given h.\n\n\n\n\n\nair_temperature(param_set, ::pρ, p, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nThe air temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\np: air pressure [Pa]\nρ: air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nT: air temperature [K]\n\nIf the specific humidities are not given, the result is for dry air. This directly applies the ideal gas law: T = p / (R_m ρ).\n\n\n\n\n\nair_temperature(\n    param_set,\n    ::pθ_li,\n    p,\n    θ_li,\n    q_tot=0,\n    q_liq=0,\n    q_ice=0\n)\n\nThe air temperature obtained by inverting the liquid-ice potential temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\np: pressure [Pa]\nθ_li: liquid-ice potential temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nT: air temperature [K]\n\nIf the specific humidities are not given, θ_li is assumed to be the dry-air potential temperature. This inverts liquid_ice_pottemp_given_pressure by solving for T.\n\n\n\n\n\nair_temperature(param_set, ::ρθ_li, ρ, θ_li, q_tot=0, q_liq=0, q_ice=0)\n\nThe air temperature obtained by inverting the liquid-ice potential temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nρ: (moist-)air density [kg/m³]\nθ_li: liquid-ice potential temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nT: air temperature [K]\n\nIf the specific humidities are not given, the results are for dry air.\n\nMethod\n\nThis function uses a second-order Taylor expansion to avoid an iterative inversion. The unsaturated temperature T_unsat is first computed assuming the ideal gas law with potential temperature, then latent heat corrections are applied.\n\n\n\n\n\nair_temperature(param_set, ::DryAdiabaticProcess, p, θ)\n\nThe air temperature for an isentropic process.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: pressure [Pa]\nθ: potential temperature [K]\n\nReturns\n\nT: air temperature [K]\n\nThe temperature is computed using the definition of the dry potential temperature: T = θ * (p/p₀)^κ_d, where p₀ is the reference pressure and κ_d = R_d/cp_d.\n\n\n\n\n\nair_temperature(param_set, ts::ThermodynamicState)\n\nThe air temperature.\n\n\n\n\n\nair_temperature(param_set, e_int[, q::PhasePartition])\n\nThe air temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\ne_int specific internal energy of moist air\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.potential_temperature","page":"API Reference","title":"Thermodynamics.potential_temperature","text":"potential_temperature(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nThe potential temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nρ: (moist-)air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nθ: potential temperature [K]\n\nIf the specific humidities are not given, the result is for dry air.\n\nNote: if any of q_tot, q_liq, or q_ice are nonzero, the Exner function uses the moist exponent R_m/cp_m (reducing to the dry exponent R_d/cp_d in the dry limit).\n\n\n\n\n\npotential_temperature(param_set, ts::ThermodynamicState)\n\nThe dry potential temperature.\n\n\n\n\n\npotential_temperature(param_set, T, ρ[, q::PhasePartition])\n\nThe dry potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.potential_temperature_given_pressure","page":"API Reference","title":"Thermodynamics.potential_temperature_given_pressure","text":"potential_temperature_given_pressure(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe potential temperature.\n\nparam_set thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\np pressure\nq_tot total specific humidity\nq_liq liquid specific humidity\nq_ice ice specific humidity\n\nIf the specific humidities are not given, the result is for dry air.\n\nNote: if any of q_tot, q_liq, or q_ice are nonzero, the Exner function uses the moist exponent R_m/cp_m (reducing to the dry exponent R_d/cp_d in the dry limit).\n\n\n\n\n\npotential_temperature_given_pressure(param_set, T, p[, q::PhasePartition])\n\nThe dry potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\np pressure\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air, i.e., using the adiabatic exponent   for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.liquid_ice_pottemp","page":"API Reference","title":"Thermodynamics.liquid_ice_pottemp","text":"liquid_ice_pottemp(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nThe liquid-ice potential temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nρ: (moist-)air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nθ_li: liquid-ice potential temperature [K]\n\nIf the specific humidities are not given, the result is for dry air.\n\nReference\n\nBetts (1973), \"Non-precipitating cumulus convection and its parameterization,\"  Quarterly Journal of the Royal Meteorological Society, 99, 178-196, doi:10.1002/qj.49709941915.\n\n\n\n\n\nliquid_ice_pottemp(param_set, ts::ThermodynamicState)\n\nThe liquid-ice potential temperature.\n\n\n\n\n\nliquid_ice_pottemp(param_set, T, ρ[, q::PhasePartition])\n\nThe liquid-ice potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the result is the dry-air potential temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.liquid_ice_pottemp_given_pressure","page":"API Reference","title":"Thermodynamics.liquid_ice_pottemp_given_pressure","text":"liquid_ice_pottemp_given_pressure(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe liquid-ice potential temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\np: pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nθ_li: liquid-ice potential temperature [K]\n\nIf the specific humidities are not given, the result is for dry air. The latent heats of phase transitions are approximated as constants.\n\nReference\n\nBetts (1973), \"Non-precipitating cumulus convection and its parameterization,\"  Quarterly Journal of the Royal Meteorological Society, 99, 178-196, doi:10.1002/qj.49709941915.\n\n\n\n\n\nliquid_ice_pottemp_given_pressure(param_set, T, p[, q::PhasePartition])\n\nThe liquid-ice potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\np pressure\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the result is the dry-air potential temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.virtual_pottemp","page":"API Reference","title":"Thermodynamics.virtual_pottemp","text":"virtual_pottemp(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nThe virtual potential temperature.\n\nparam_set thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\nq_tot total specific humidity\nq_liq liquid specific humidity\nq_ice ice specific humidity\n\nIf the specific humidities are not given, the result is for dry air.\n\n\n\n\n\nvirtual_pottemp(param_set, ts::ThermodynamicState)\n\nThe virtual potential temperature.\n\n\n\n\n\nvirtual_pottemp(param_set, T, ρ[, q::PhasePartition])\n\nThe virtual potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\n\nand, optionally,\n\nq PhasePartition. \n\nThe virtual potential temperature is defined as θ_v = (R_m/R_d) * θ, where θ is the potential temperature. It is the potential temperature a dry air parcel would need to have to have the same density as the moist air parcel at the same pressure.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.virtual_temperature","page":"API Reference","title":"Thermodynamics.virtual_temperature","text":"virtual_temperature(param_set, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe virtual temperature.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nT_v: virtual temperature [K]\n\nIf the specific humidities are not given, the result is for dry air. The virtual temperature is defined such that dry air at T_v has the same density as moist air at T, i.e., T_v = T (R_m / R_d).\n\n\n\n\n\nvirtual_temperature(param_set, ts::ThermodynamicState)\n\nThe virtual temperature.\n\n\n\n\n\nvirtual_temperature(param_set, T, q::PhasePartition)\n\nThe virtual temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nq PhasePartition. \n\nThe virtual temperature is defined as T_v = (R_m/R_d) * T. It is the temperature a dry air parcel would need to have to have the same density as the moist air parcel at the same pressure.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_pressure","page":"API Reference","title":"Thermodynamics.air_pressure","text":"air_pressure(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nThe air pressure from the equation of state (ideal gas law).\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: air temperature [K]\nρ: (moist-)air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\np: air pressure [Pa]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The formula is p = ρ R_m T where R_m is the gas constant of moist air (see gas_constant_air).\n\n\n\n\n\nair_pressure(param_set, ::DryAdiabaticProcess, T, T∞, p∞)\n\nThe air pressure for an isentropic process.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: current temperature [K]\nT∞: reference temperature [K]\np∞: reference pressure [Pa]\n\nReturns\n\np: air pressure [Pa]\n\nThe pressure is computed using the isentropic relation: p = p∞ * (T/T∞)^(1/κ_d), where κ_d = R_d/cp_d is the ratio of the gas constant to the isobaric specific heat constant of dry air.\n\n\n\n\n\nair_pressure(param_set, ts::ThermodynamicState)\n\nThe air pressure from the equation of state (ideal gas law).\n\n\n\n\n\nair_pressure(param_set, T, ρ[, q::PhasePartition])\n\nThe air pressure from the equation of state (ideal gas law).\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT air temperature\nρ (moist-)air density\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_density","page":"API Reference","title":"Thermodynamics.air_density","text":"air_density(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe (moist-)air density from the equation of state (ideal gas law).\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: air temperature [K]\np: pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nρ: (moist-)air density [kg/m³]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The formula is ρ = p / (R_m T) where R_m is the gas constant of moist air (see gas_constant_air).\n\n\n\n\n\nair_density(param_set, ts::ThermodynamicState)\n\nThe (moist-)air density.\n\n\n\n\n\nair_density(param_set, T, p[, q::PhasePartition])\n\nThe (moist-)air density from the equation of state (ideal gas law).\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT air temperature\np pressure\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.exner","page":"API Reference","title":"Thermodynamics.exner","text":"exner(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nThe Exner function Π = (p/p₀)^(R_m/cp_m).\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature [K]\nρ: (moist-)air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nΠ: Exner function [dimensionless]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The pressure is computed internally from the equation of state (see air_pressure).\n\n\n\n\n\nexner(param_set, ts::ThermodynamicState)\n\nThe Exner function.\n\n\n\n\n\nexner(param_set, T, ρ[, q::PhasePartition)])\n\nThe Exner function.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.exner_given_pressure","page":"API Reference","title":"Thermodynamics.exner_given_pressure","text":"exner_given_pressure(param_set, p, q_tot=0, q_liq=0, q_ice=0)\n\nThe Exner function Π = (p/p₀)^(R_m/cp_m), where p₀ is the reference pressure.\n\nArguments\n\nparam_set: thermodynamics parameter set, see the Thermodynamics for more details\np: pressure [Pa]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\nΠ: Exner function [dimensionless]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The reference pressure p₀ is p_ref_theta from the parameter set.\n\n\n\n\n\nexner_given_pressure(param_set, p[, q::PhasePartition, cpm])\n\nThe Exner function.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_pressure_given_θ","page":"API Reference","title":"Thermodynamics.air_pressure_given_θ","text":"air_pressure_given_θ(param_set, ::DryAdiabaticProcess, θ, Φ)\n\nThe air pressure for an isentropic process.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nθ: potential temperature [K]\nΦ: gravitational potential [J/kg]\n\nReturns\n\np: air pressure [Pa]\n\nThe pressure is computed using the hydrostatic balance and the definition of potential temperature for an isentropic process: p = p₀ * (1 - Φ/(θ * cp_d))^(1/κ_d), where p₀ is the reference pressure, cp_d is the isobaric specific heat capacity of dry air, and κ_d = R_d/cp_d.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.saturation_vapor_pressure","page":"API Reference","title":"Thermodynamics.saturation_vapor_pressure","text":"saturation_vapor_pressure(param_set, T, ::Liquid)\nsaturation_vapor_pressure(param_set, T, ::Ice)\n\nThe saturation vapor pressure over a plane surface of condensate.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nLiquid() or Ice() to dispatch over the condensate type\n\nReturns\n\np_v^*: saturation vapor pressure [Pa]\n\nThe saturation vapor pressure is computed by integration of the Clausius-Clapeyron relation, assuming constant specific heat capacities in the so-called Rankine-Kirchhoff approximation.\n\n\n\n\n\nsaturation_vapor_pressure(param_set, T)\nsaturation_vapor_pressure(param_set, T, q_liq, q_ice)\n\nThe saturation vapor pressure over liquid, ice, or a mixture of liquid and ice.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nq_liq: (optional) liquid specific humidity [kg/kg]\nq_ice: (optional) ice specific humidity [kg/kg]\n\nReturns\n\np_v^*: saturation vapor pressure [Pa]\n\nIf q_liq and q_ice are provided, the saturation vapor pressure is computed from a weighted mean of the latent heats of vaporization and sublimation, with the weights given by the liquid fraction (see liquid_fraction). If q_liq and q_ice are 0, the saturation vapor pressure is that over liquid above freezing and over ice below freezing.\n\nOtherwise, the liquid fraction below freezing is computed from a temperature dependent parameterization liquid_fraction_ramp(param_set, T).\n\nEdge case: the saturation_vapor_pressure(param_set, T, q_liq, q_ice) form includes a small smooth transition around freezing when q_liq == q_ice == 0 (via liquid_fraction(param_set, T, q_liq, q_ice)).\n\n\n\n\n\nsaturation_vapor_pressure(param_set, ts::ThermodynamicState, ::Liquid)\n\nThe saturation vapor pressure over a plane surface of condensate.\n\n\n\n\n\nsaturation_vapor_pressure(param_set, ts::ThermodynamicState, ::Ice)\n\nThe saturation vapor pressure over a plane surface of condensate.\n\n\n\n\n\nsaturation_vapor_pressure(param_set, T, q::PhasePartition)\n\nThe saturation vapor pressure.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nq PhasePartition.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.q_vap_saturation","page":"API Reference","title":"Thermodynamics.q_vap_saturation","text":"q_vap_saturation(param_set, T, ρ)\nq_vap_saturation(param_set, T, ρ, q_liq, q_ice)\n\nThe saturation specific humidity.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nρ: air density [kg/m³]\n(optional) q_liq: liquid specific humidity [kg/kg]\n(optional) q_ice: ice specific humidity [kg/kg]\n\nReturns\n\nq_v^*: saturation specific humidity [kg/kg]\n\nIf q_liq and q_ice are provided, the saturation specific humidity is that over a mixture of liquid and ice, computed in a thermodynamically consistent way from the weighted sum of the latent heats of the respective phase transitions. That is, the  saturation vapor pressure and from it the saturation specific humidity are computed  from a weighted mean of the latent heats of vaporization and sublimation, with the  weights given by the liquid fraction (see liquid_fraction). If q_liq and  q_ice are 0, the saturation specific humidity is that over liquid above freezing and  over ice below freezing.\n\nOtherwise, the fraction of liquid is given by the temperature dependent liquid_fraction_ramp(param_set, T).\n\nReference\n\nPressel et al. (2015), \"Numerics and subgrid-scale modeling in large eddy simulations of stratocumulus clouds,\" Journal of Advances in Modeling Earth Systems, 7(3), 1199-1220, doi:10.1002/2014MS000376.\n\n\n\n\n\nq_vap_saturation(param_set, T, ρ, phase::Phase)\n\nThe saturation specific humidity.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nρ: (moist-)air density [kg/m³]\nphase: the phase to compute saturation over (either Liquid() or Ice())\n\nReturns\n\nq_v^*: saturation specific humidity [kg/kg]\n\n\n\n\n\nq_vap_saturation(param_set, ts::ThermodynamicState)\n\nThe saturation specific humidity.\n\n\n\n\n\nq_vap_saturation(param_set, T, ρ, q::PhasePartition)\n\nThe saturation specific humidity.\n\nparam_set: an thermodynamics parameter set, see the Thermodynamics for more details\nT: temperature\nρ: air density\nq: PhasePartition\n\nIf the PhasePartition q is given, the saturation specific humidity is that over a mixture of liquid and ice, computed in a thermodynamically consistent way from the weighted sum of the latent heats of the respective phase transitions (Pressel et al., JAMES, 2015).\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.supersaturation","page":"API Reference","title":"Thermodynamics.supersaturation","text":"supersaturation(param_set, q_vap, ρ, T[, phase::Phase = Liquid()])\n\nThe supersaturation over water or ice.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nq_vap: vapor specific humidity [kg/kg]\nρ: air density [kg/m³]\nT: air temperature [K]\nphase: (optional) liquid or ice phase to dispatch over (default: Liquid())\n\nReturns\n\nS: supersaturation [dimensionless], defined as p_v/p_v^* - 1\n\n\n\n\n\nsupersaturation(param_set, q_vap, ρ, T, p_v_sat)\n\nThe supersaturation given the saturation vapor pressure.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nq_vap: vapor specific humidity [kg/kg]\nρ: air density [kg/m³]\nT: temperature [K]\np_v_sat: saturation vapor pressure [Pa]\n\nReturns\n\nS: supersaturation [dimensionless], defined as p_v/p_v_sat - 1\n\n\n\n\n\nsupersaturation(param_set::APS, ts::ThermodynamicState, phase::Phase)\n\nThe supersaturation (pv/pv_sat -1) over water or ice.\n\n\n\n\n\nsupersaturation(param_set, q, ρ, T, Liquid())\nsupersaturation(param_set, q, ρ, T, Ice())\n\nThe supersaturation (pv/pv_sat -1) over water or ice.\n\nparam_set - abstract set with earth parameters\nq - phase partition\nρ - air density,\nT - air temperature\nLiquid(), Ice() - liquid or ice phase to dispatch over.\n\n\n\n\n\nsupersaturation(param_set, q::PhasePartition, ρ, T, p_v_sat)\n\nThe supersaturation (pv/pvsat - 1) given the saturation vapor pressure `pv_sat`:\n\nparam_set: Thermodynamic parameter set\nq: Phase partition\nρ: Air density\nT: Temperature\np_v_sat: Saturation vapor pressure\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.saturation_excess","page":"API Reference","title":"Thermodynamics.saturation_excess","text":"saturation_excess(param_set, T, ρ, q_tot)\nsaturation_excess(param_set, T, ρ, q_tot, q_liq, q_ice)\n\nThe saturation excess in equilibrium.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nρ: (moist-)air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\n(optional) q_liq: liquid specific humidity [kg/kg]\n(optional) q_ice: ice specific humidity [kg/kg]\n\nReturns\n\nq_ex: saturation excess [kg/kg]\n\nThe saturation excess is the difference between the total specific humidity q_tot and the saturation specific humidity in equilibrium, and it is defined to be nonzero only if this difference is positive: q_ex = max(0, q_tot - q_v^*).\n\n\n\n\n\nsaturation_excess(param_set, T, ρ, q_tot, p_vap_sat)\n\nThe saturation excess given the saturation vapor pressure.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: temperature [K]\nρ: air density [kg/m³]\nq_tot: total specific humidity [kg/kg]\np_vap_sat: saturation vapor pressure [Pa]\n\nReturns\n\nq_ex: saturation excess [kg/kg]\n\nThe saturation excess is the difference between the total specific humidity q_tot and the saturation specific humidity, and it is defined to be nonzero only if this difference is positive: q_ex = max(0, q_tot - q_v^*).\n\n\n\n\n\nsaturation_excess(param_set, ts::ThermodynamicState)\n\nThe saturation excess in equilibrium.\n\n\n\n\n\nsaturation_excess(param_set, T, ρ, phase_type, q::PhasePartition)\n\nThe saturation excess in equilibrium.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\nphase_type a thermodynamic state type\nq PhasePartition\n\nThe saturation excess is the difference between the total specific humidity q.tot and the saturation specific humidity in equilibrium, and it is defined to be nonzero only if this difference is positive.\n\n\n\n\n\nsaturation_excess(param_set, T, ρ, p_vap_sat, q::PhasePartition)\n\nThe saturation excess given the saturation vapor pressure p_vap_sat:\n\nparam_set: Thermodynamic parameter set\nT: Temperature\nρ: Air density\np_vap_sat: Saturation vapor pressure\nq: Phase partition\n\nThe saturation excess is the difference between the total specific humidity q.tot and the saturation specific humidity, and it is defined to be nonzero only if this difference is positive.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.q_vap_from_RH","page":"API Reference","title":"Thermodynamics.q_vap_from_RH","text":"q_vap_from_RH(param_set, p, T, RH, phase)\n\nCompute the vapor specific humidity from the relative humidity.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: pressure [Pa]\nT: temperature [K]\nRH: relative humidity [dimensionless], 0 ≤ RH ≤ 1\nphase: the phase to compute saturation over (either Liquid() or Ice())\n\nReturns\n\nq_vap: vapor specific humidity [kg/kg]\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.q_vap_from_p_vap","page":"API Reference","title":"Thermodynamics.q_vap_from_p_vap","text":"q_vap_from_p_vap(param_set, T, ρ, p_v)\n\nCompute the vapor specific humidity from the vapor partial pressure.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nT: air temperature [K]\nρ: (moist-)air density [kg/m³]\np_v: partial pressure of water vapor [Pa]\n\nReturns\n\nq_vap: vapor specific humidity [kg/kg]\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.q_vap_saturation_from_pressure","page":"API Reference","title":"Thermodynamics.q_vap_saturation_from_pressure","text":"q_vap_saturation_from_pressure(param_set, q_tot, p, T)\nq_vap_saturation_from_pressure(param_set, q_tot, p, T, q_liq, q_ice)\n\nThe saturation specific humidity.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\nq_tot: total water specific humidity [kg/kg]\np: air pressure [Pa]\nT: air temperature [K]\n(optional) q_liq: liquid specific humidity [kg/kg]\n(optional) q_ice: ice specific humidity [kg/kg]\n\nReturns\n\nq_v^*: saturation specific humidity [kg/kg]\n\nIf q_liq and q_ice are provided, the saturation vapor pressure is computed from a weighted mean of the latent heats of vaporization and sublimation, with the weights given by the liquid fraction (see liquid_fraction). If q_liq and q_ice are 0, the saturation vapor pressure is that over liquid above freezing and over ice below freezing.\n\nOtherwise, the liquid fraction is computed from a temperature dependent parameterization liquid_fraction_ramp(param_set, T).\n\nThe saturation specific humidity is computed as: q_v^* = (R_d  R_v) * (1 - q_tot) * p_v^*  (p - p_v^*) where p_v^* is the saturation vapor pressure.\n\nEdge case: this expression assumes p > p_v^*(T); if p ≤ p_v^*(T) the denominator changes sign.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.saturation_adjustment","page":"API Reference","title":"Thermodynamics.saturation_adjustment","text":"saturation_adjustment(\n    ::Type{M},  # RS.RootSolvingMethod type\n    param_set,\n    ::ρe,\n    ρ::Real,\n    e_int::Real,\n    q_tot::Real,\n    maxiter::Int,\n    tol,\n    [T_guess::Union{Nothing, Real} = nothing],\n    [forced_fixed_iters::Bool = false]\n)\n\nCompute the saturation equilibrium temperature T and phase partition (q_liq, q_ice) given density ρ, internal energy e_int, and total specific humidity q_tot.\n\nArguments\n\nM: Root-solving method type from RS.jl. Use RS.NewtonsMethod, RS.SecantMethod, RS.BrentsMethod, or RS.NewtonsMethodAD.\nparam_set: Thermodynamics parameter set, see Thermodynamics.\nρ: Density of moist air [kg/m³].\ne_int: Specific internal energy [J/kg].\nq_tot: Total specific humidity [kg/kg].\nmaxiter: Maximum iterations for the solver [dimensionless integer].\ntol: Relative tolerance for the temperature solution (or a RS.RelativeSolutionTolerance).\nT_guess: Optional initial guess for the temperature [K]. Defaults to nothing.\nforced_fixed_iters: Optional boolean to force a fixed number of iterations (maxiter) without checking for convergence. Useful for GPU optimization to avoid branch divergence. When true, T_guess and tol are ignored. Defaults to false.\n\nReturns\n\nNamedTuple (; T, q_liq, q_ice, converged):\nT: Temperature [K]\nq_liq: Liquid specific humidity [kg/kg]\nq_ice: Ice specific humidity [kg/kg]\nconverged: Boolean flag indicating if the solver converged\n\nNotes\n\nThis function solves for T such that e_int = internal_energy_sat(param_set, T, ρ, q_tot) using root-finding, then computes (q_liq, q_ice) from condensate_partition.\nFor ρe formulation, NewtonsMethod is recommended (fast + analytic derivative available).\nFor other formulations, SecantMethod or BrentsMethod are recommended.\nGPU broadcasting: Pass forced_fixed_iters as a positional Bool.\n\n\n\n\n\nsaturation_adjustment(\n    ::Type{M},  # RS.RootSolvingMethod type\n    param_set,\n    ::pe,\n    p::Real,\n    e_int::Real,\n    q_tot::Real,\n    maxiter::Int,\n    tol,\n    [T_guess::Union{Nothing, Real}]\n)\n\nCompute the saturation equilibrium temperature T and phase partition (q_liq, q_ice) given pressure p, specific internal energy e_int, and total specific humidity q_tot.\n\nArguments\n\nM: Root-solving method type from RootSolvers.jl. Supported types: RS.SecantMethod, RS.BrentsMethod, RS.NewtonsMethod, RS.NewtonsMethodAD.\nparam_set: Thermodynamics parameter set, see Thermodynamics.\np: Pressure of moist air [Pa].\ne_int: Specific internal energy [J/kg].\nq_tot: Total specific humidity [kg/kg].\nmaxiter: Maximum iterations for the solver [dimensionless integer].\ntol: Relative tolerance for the temperature solution (or a RS.RelativeSolutionTolerance).\nT_guess: Optional initial guess for the temperature [K].\n\nReturns\n\nNamedTuple (; T, q_liq, q_ice, converged):\nT: Temperature [K]\nq_liq: Liquid specific humidity [kg/kg]\nq_ice: Ice specific humidity [kg/kg]\nconverged: Boolean flag indicating if the solver converged\n\n\n\n\n\nsaturation_adjustment(\n    ::Type{M},  # RS.RootSolvingMethod type\n    param_set,\n    ::ph,\n    p::Real,\n    h::Real,\n    q_tot::Real,\n    maxiter::Int,\n    tol,\n    [T_guess::Union{Nothing, Real}]\n)\n\nCompute the saturation equilibrium temperature T and phase partition (q_liq, q_ice) given pressure p, specific enthalpy h, and total specific humidity q_tot.\n\nReturns a NamedTuple (; T, q_liq, q_ice, converged).\n\nArguments\n\nM: Root-solving method type from RootSolvers.jl. Supported types: RS.SecantMethod, RS.BrentsMethod, RS.NewtonsMethod, RS.NewtonsMethodAD.\nparam_set: Thermodynamics parameter set, see Thermodynamics.\np: Pressure of moist air [Pa].\nh: Specific enthalpy [J/kg].\nq_tot: Total specific humidity [kg/kg].\nmaxiter: Maximum iterations for the solver [dimensionless integer].\ntol: Relative tolerance for the temperature solution (or a RS.RelativeSolutionTolerance).\nT_guess: Optional initial guess for the temperature [K].\n\nReturns\n\nNamedTuple (; T, q_liq, q_ice, converged):\nT: Temperature [K]\nq_liq: Liquid specific humidity [kg/kg]\nq_ice: Ice specific humidity [kg/kg]\nconverged: Boolean flag indicating if the solver converged\n\n\n\n\n\nsaturation_adjustment(\n    ::Type{M},  # RS.RootSolvingMethod type\n    param_set,\n    ::pθ_li,\n    p::Real,\n    θ_li::Real,\n    q_tot::Real,\n    maxiter::Int,\n    tol,\n    [T_guess::Union{Nothing, Real}]\n)\n\nCompute the saturation equilibrium temperature T and phase partition (q_liq, q_ice) given pressure p, liquid-ice potential temperature θ_li, and total specific humidity q_tot.\n\nArguments\n\nM: Root-solving method type from RootSolvers.jl. Supported types: RS.SecantMethod, RS.BrentsMethod, RS.NewtonsMethod, RS.NewtonsMethodAD.\nparam_set: Thermodynamics parameter set, see Thermodynamics.\np: Pressure of moist air [Pa].\nθ_li: Liquid-ice potential temperature [K].\nq_tot: Total specific humidity [kg/kg].\nmaxiter: Maximum iterations for the solver [dimensionless integer].\ntol: Relative tolerance for the temperature solution (or a RS.RelativeSolutionTolerance).\nT_guess: Optional initial guess for the temperature [K].\n\nReturns\n\nNamedTuple (; T, q_liq, q_ice, converged):\nT: Temperature [K]\nq_liq: Liquid specific humidity [kg/kg]\nq_ice: Ice specific humidity [kg/kg]\nconverged: Boolean flag indicating if the solver converged\n\n\n\n\n\nsaturation_adjustment(\n    ::Type{M},  # RS.RootSolvingMethod type\n    param_set,\n    ::ρθ_li,\n    ρ::Real,\n    θ_li::Real,\n    q_tot::Real,\n    maxiter::Int,\n    tol,\n    [T_guess::Union{Nothing, Real}]\n)\n\nCompute the saturation equilibrium temperature T and phase partition (q_liq, q_ice) given density ρ, liquid-ice potential temperature θ_li, and total specific humidity q_tot.\n\nArguments\n\nM: Root-solving method type from RootSolvers.jl. Supported types: RS.SecantMethod, RS.BrentsMethod, RS.NewtonsMethod, RS.NewtonsMethodAD.\nparam_set: Thermodynamics parameter set, see Thermodynamics.\nρ: Density of moist air [kg/m³].\nθ_li: Liquid-ice potential temperature [K].\nq_tot: Total specific humidity [kg/kg].\nmaxiter: Maximum iterations for the solver [dimensionless integer].\ntol: Relative tolerance for the temperature solution (or a RS.RelativeSolutionTolerance).\nT_guess: Optional initial guess for the temperature [K].\n\nReturns\n\nNamedTuple (; T, q_liq, q_ice, converged):\nT: Temperature [K]\nq_liq: Liquid specific humidity [kg/kg]\nq_ice: Ice specific humidity [kg/kg]\nconverged: Boolean flag indicating if the solver converged\n\n\n\n\n\nsaturation_adjustment(\n    ::Type{M},  # RS.RootSolvingMethod type\n    param_set,\n    ::pρ,\n    p::Real,\n    ρ::Real,\n    q_tot::Real,\n    maxiter::Int,\n    tol,\n    [T_guess::Union{Nothing, Real}]\n)\n\nCompute the saturation equilibrium temperature T and phase partition (q_liq, q_ice) given pressure p, density ρ, and total specific humidity q_tot.\n\nArguments\n\nM: Root-solving method type from RootSolvers.jl. Supported types: RS.SecantMethod, RS.BrentsMethod, RS.NewtonsMethod, RS.NewtonsMethodAD.\nparam_set: Thermodynamics parameter set, see Thermodynamics.\np: Pressure of moist air [Pa].\nρ: Density of moist air [kg/m³].\nq_tot: Total specific humidity [kg/kg].\nmaxiter: Maximum iterations for the solver [dimensionless integer].\ntol: Relative tolerance for the temperature solution (or a RS.RelativeSolutionTolerance).\nT_guess: Optional initial guess for the temperature [K].\n\nReturns\n\nNamedTuple (; T, q_liq, q_ice, converged):\nT: Temperature [K]\nq_liq: Liquid specific humidity [kg/kg]\nq_ice: Ice specific humidity [kg/kg]\nconverged: Boolean flag indicating if the solver converged\n\n\n\n\n\nsaturation_adjustment(args...)\n\nLegacy wrapper for saturation_adjustment with phase_type argument. Forwards to saturation_adjustment(..., ::ρeq, ...) with arguments (ρ, e_int) swapped.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.entropy","page":"API Reference","title":"Thermodynamics.entropy","text":"entropy(param_set, p, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe specific entropy in thermodynamic equilibrium.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: pressure [Pa]\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ns: specific entropy [J/(kg·K)]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), this reduces to the dry-air expression. The entropy is computed as a mass-weighted sum of the entropies of each component (dry air, vapor, liquid, ice).\n\nReference\n\nPressel et al. (2015), \"Numerics and subgrid-scale modeling in large eddy simulations of stratocumulus clouds,\" Journal of Advances in Modeling Earth Systems, 7(3), 1199-1220, doi:10.1002/2015MS000496. (Their Eqs. (29)-(33))\n\n\n\n\n\nentropy(param_set, ts)\n\nThe specific entropy.\n\n\n\n\n\nentropy(param_set, p, T, q::PhasePartition)\n\nThe specific entropy.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nT temperature\nq PhasePartition.\n\nThe specific entropy is computed from equations (29)-(33) of [7].\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.entropy_dry","page":"API Reference","title":"Thermodynamics.entropy_dry","text":"entropy_dry(param_set, p, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe specific entropy of dry air at its partial pressure.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: total air pressure [Pa]\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ns_d: specific entropy of dry air [J/(kg·K)]\n\nIn the dry limit (q_tot = q_liq = q_ice = 0, the default), the dry-air partial pressure equals the total pressure.\n\n\n\n\n\nentropy_dry(param_set, p, T, q::PhasePartition)\n\nThe dry air specific entropy.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nT temperature\nq PhasePartition.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.entropy_vapor","page":"API Reference","title":"Thermodynamics.entropy_vapor","text":"entropy_vapor(param_set, p, T, q_tot=0, q_liq=0, q_ice=0)\n\nThe specific entropy of water vapor at its partial pressure.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: total air pressure [Pa]\nT: temperature [K]\nq_tot: total specific humidity [kg/kg]\nq_liq: liquid specific humidity [kg/kg]\nq_ice: ice specific humidity [kg/kg]\n\nReturns\n\ns_v: specific entropy of water vapor [J/(kg·K)]\n\nNote: the entropy of water vapor diverges logarithmically as q_tot → 0 (since p_v → 0).\n\n\n\n\n\nentropy_vapor(param_set, p, T, q::PhasePartition)\n\nThe specific entropy of water vapor.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nT temperature\nq PhasePartition.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.TemperatureProfiles.TemperatureProfile","page":"API Reference","title":"Thermodynamics.TemperatureProfiles.TemperatureProfile","text":"TemperatureProfile\n\nAbstract type for temperature or virtual temperature reference profiles  that can be used in atmosphere models.\n\nInstances of this type are required to be callable objects with the  following signature\n\nT,p = (::TemperatureProfile)(param_set::APS, z::FT) where {FT}\n\nwhere T is the temperature or virtual temperature (K), and p is  the pressure (Pa).\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile","page":"API Reference","title":"Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile","text":"DecayingTemperatureProfile{FT} <: TemperatureProfile{FT}\n\nVirtual temperature profile that decays smoothly with height z from T_virt_surf to T_min_ref over height scale H_t (default: density scale height with T_virt_surf).\n\nT_textv(z) = max(T_textv sfc  (T_textv sfc - T_textv min) tanh(zH_textt) T_textv min)\n\nFields\n\nT_virt_surf: Virtual temperature at surface (K)\nT_min_ref: Minimum virtual temperature at the top of the atmosphere (K)\nH_t: Height scale over which virtual temperature drops (m)\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.TemperatureProfiles.IsothermalProfile","page":"API Reference","title":"Thermodynamics.TemperatureProfiles.IsothermalProfile","text":"IsothermalProfile(param_set, T_virt)\nIsothermalProfile(param_set, ::Type{FT<:Real})\n\nUniform virtual temperature profile implemented as a special case  of DecayingTemperatureProfile.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.TemperatureProfiles.DryAdiabaticProfile","page":"API Reference","title":"Thermodynamics.TemperatureProfiles.DryAdiabaticProfile","text":"DryAdiabaticProfile{FT} <: TemperatureProfile{FT}\n\nTemperature profile with uniform potential temperature θ up to  the height where a minimum temperature is reached.\n\nFields\n\nT_surface: Surface temperature (K)\nT_min_ref: Minimum temperature (K)\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.DataCollection","page":"API Reference","title":"Thermodynamics.DataCollection","text":"DataCollection\n\nThis module is designed to help judge the accuracy and performance for a particular formulation, tolerance, and or solver configuration, by providing tools to collect various statistics when saturation_adjustment is called.\n\nExample:\n\nimport Thermodynamics as TD\nimport RootSolvers as RS\n\nfunction do_work()\n    # Calls TD.saturation_adjustment()..., possibly many times\nend\n\nTD.solution_type() = RS.VerboseSolution()\ndo_work()\nTD.DataCollection.print_summary()\n\nwarn: Warn\nThis data collection was designed for unthreaded single processor runs, and may not work correctly for threaded / multi-processor runs.\n\n\n\n\n\n","category":"module"},{"location":"API/#Thermodynamics.specific_enthalpy","page":"API Reference","title":"Thermodynamics.specific_enthalpy","text":"specific_enthalpy(args...)\n\nDeprecated: Use enthalpy instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.specific_enthalpy_dry","page":"API Reference","title":"Thermodynamics.specific_enthalpy_dry","text":"specific_enthalpy_dry(args...)\n\nDeprecated: Use enthalpy_dry instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.specific_enthalpy_vapor","page":"API Reference","title":"Thermodynamics.specific_enthalpy_vapor","text":"specific_enthalpy_vapor(args...)\n\nDeprecated: Use enthalpy_vapor instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.specific_enthalpy_liquid","page":"API Reference","title":"Thermodynamics.specific_enthalpy_liquid","text":"specific_enthalpy_liquid(args...)\n\nDeprecated: Use enthalpy_liquid instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.specific_enthalpy_ice","page":"API Reference","title":"Thermodynamics.specific_enthalpy_ice","text":"specific_enthalpy_ice(args...)\n\nDeprecated: Use enthalpy_ice instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.dry_pottemp","page":"API Reference","title":"Thermodynamics.dry_pottemp","text":"dry_pottemp(args...)\n\nDeprecated: Use potential_temperature instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.total_specific_enthalpy","page":"API Reference","title":"Thermodynamics.total_specific_enthalpy","text":"total_specific_enthalpy(args...)\n\nDeprecated: Use total_enthalpy instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.q_vap_saturation_generic","page":"API Reference","title":"Thermodynamics.q_vap_saturation_generic","text":"q_vap_saturation_generic(args...)\n\nDeprecated: Use q_vap_saturation instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.latent_heat_liq_ice","page":"API Reference","title":"Thermodynamics.latent_heat_liq_ice","text":"latent_heat_liq_ice(args...)\n\nDeprecated: Use humidity_weighted_latent_heat instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_temperature_given_hq","page":"API Reference","title":"Thermodynamics.air_temperature_given_hq","text":"air_temperature_given_hq(param_set, h, q_tot=0, q_liq=0, q_ice=0)\n\nwarn: Deprecated\nThis function is deprecated and will be removed in a future release. Please use air_temperature with the ph type instead.\n\n\n\n\n\nair_temperature_given_hq(param_set, h[, q::PhasePartition]s)\n\nThe air temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nh specific enthalpy of moist air\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_temperature_given_pρq","page":"API Reference","title":"Thermodynamics.air_temperature_given_pρq","text":"air_temperature_given_pρq(param_set, p, ρ, q_tot=0, q_liq=0, q_ice=0)\n\nwarn: Deprecated\nThis function is deprecated and will be removed in a future release. Please use air_temperature with the pρ type instead.\n\n\n\n\n\nair_temperature_given_pρq(param_set, p, ρ[, q::PhasePartition])\n\nThe air temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np air pressure\nρ air density\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_temperature_given_pθq","page":"API Reference","title":"Thermodynamics.air_temperature_given_pθq","text":"air_temperature_given_pθq(param_set, p, θ_li, q_tot=0, q_liq=0, q_ice=0)\n\nwarn: Deprecated\nThis function is deprecated and will be removed in a future release. Please use air_temperature with the pθ_li type instead.\n\n\n\n\n\nair_temperature_given_pθq(\n    param_set,\n    p,\n    θ_li,\n    [q::PhasePartition]\n)\n\nThe air temperature obtained by inverting the liquid-ice potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nθ_li liquid-ice potential temperature\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the θ_li is assumed to be the dry-air potential temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_temperature_given_ρθq","page":"API Reference","title":"Thermodynamics.air_temperature_given_ρθq","text":"air_temperature_given_ρθq(param_set, ρ, θ_li, q_tot=0, q_liq=0, q_ice=0)\n\nwarn: Deprecated\nThis function is deprecated and will be removed in a future release. Please use air_temperature with the ρθ_li type instead.\n\n\n\n\n\nair_temperature_given_ρθq(param_set, ρ, θ_li[, q::PhasePartition])\n\nThe air temperature obtained by inverting the liquid-ice potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ (moist-)air density\nθ_li liquid-ice potential temperature\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the results are for dry air.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.air_temperature_given_ρθq_nonlinear","page":"API Reference","title":"Thermodynamics.air_temperature_given_ρθq_nonlinear","text":"air_temperature_given_ρθq_nonlinear(param_set, ρ, θ_li, maxiter, tol, q::PhasePartition)\n\nComputes temperature T.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ (moist-)air density\nθ_li liquid-ice potential temperature\n\nand, optionally,\n\nmaxiter maximum iterations for non-linear equation solve\ntol absolute tolerance for non-linear equation iterations. Can be one of:\nRelativeSolutionTolerance() to stop when |x_2 - x_1|/x_1 < tol\nResidualTolerance() to stop when |f(x)| < tol\nq PhasePartition.When q is not provided, the results are for dry air,\n\nThe temperature T is found by finding the root of T - air_temperature_given_pθq(param_set,                                air_pressure(param_set, T, ρ, q),                                θ_li,                                q) = 0\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.saturated","page":"API Reference","title":"Thermodynamics.saturated","text":"saturated(param_set, ts::ThermodynamicState)\n\nChecks if the thermodynamic state ts is saturated or supersaturated.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.total_specific_humidity","page":"API Reference","title":"Thermodynamics.total_specific_humidity","text":"total_specific_humidity(param_set, ts::ThermodynamicState)\n\nThe total specific humidity.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.liquid_specific_humidity","page":"API Reference","title":"Thermodynamics.liquid_specific_humidity","text":"liquid_specific_humidity(param_set, ts::ThermodynamicState)\n\nThe liquid specific humidity.\n\n\n\n\n\nliquid_specific_humidity(q::PhasePartition)\n\nThe liquid specific humidity.\n\nq a PhasePartition\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.ice_specific_humidity","page":"API Reference","title":"Thermodynamics.ice_specific_humidity","text":"ice_specific_humidity(param_set, ts::ThermodynamicState)\n\nThe ice specific humidity.\n\n\n\n\n\nice_specific_humidity(q::PhasePartition)\n\nThe ice specific humidity.\n\nq a PhasePartition\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.mixing_ratios","page":"API Reference","title":"Thermodynamics.mixing_ratios","text":"mixing_ratios(param_set, ts::ThermodynamicState)\n\nThe mixing ratios, stored in a PhasePartition.\n\n\n\n\n\nmixing_ratios(q::PhasePartition)\n\nThe mixing ratios returned in a  PhasePartition with the fields\n\nr.tot total mixing ratio\nr.liq liquid mixing ratio\nr.ice ice mixing ratio\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.specific_volume","page":"API Reference","title":"Thermodynamics.specific_volume","text":"specific_volume(param_set, ts::ThermodynamicState)\n\nThe (moist-)air specific volume.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.q_vap_from_RH_liquid","page":"API Reference","title":"Thermodynamics.q_vap_from_RH_liquid","text":"q_vap_from_RH_liquid(param_set, p, T, RH)\n\nCompute the vapor specific humidity from the relative humidity over liquid.\n\nArguments\n\nparam_set: thermodynamics parameter set, see Thermodynamics\np: pressure [Pa]\nT: temperature [K]\nRH: relative humidity [dimensionless], 0 ≤ RH ≤ 1\n\nReturns\n\nq_vap: vapor specific humidity [kg/kg]\n\nThis function is deprecated. Use q_vap_from_RH with Liquid() instead.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.temperature_and_humidity_given_TᵥρRH","page":"API Reference","title":"Thermodynamics.temperature_and_humidity_given_TᵥρRH","text":"temperature_and_humidity_given_TᵥρRH(param_set, T_virt, ρ, RH, phase_type, maxiter, tol)\n\nCompute temperature and total specific humidity given virtual temperature, density, and relative humidity.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.liquid_ice_pottemp_sat","page":"API Reference","title":"Thermodynamics.liquid_ice_pottemp_sat","text":"liquid_ice_pottemp_sat(param_set, ts::ThermodynamicState)\n\nThe liquid potential temperature.\n\n\n\n\n\nliquid_ice_pottemp_sat(param_set, T, ρ, phase_type[, q::PhasePartition, cpm])\n\nThe saturated liquid ice potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\nphase_type a thermodynamic state type\n\nand, optionally,\n\nq PhasePartition. \n\nWhen q is not provided, the air assumed to be dry.\n\n\n\n\n\nliquid_ice_pottemp_sat(param_set, T, ρ, phase_type, q_tot)\n\nThe saturated liquid ice potential temperature.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\nphase_type a thermodynamic state type\nq_tot total specific humidity\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhasePartition_equil","page":"API Reference","title":"Thermodynamics.PhasePartition_equil","text":"PhasePartition_equil(param_set, ts::ThermodynamicState)\n\nPartition the phases in equilibrium, returning a PhasePartition object.\n\n\n\n\n\nPhasePartition_equil(param_set, T, ρ, q_tot, phase_type)\nPhasePartition_equil(param_set, T, ρ, q_tot, p_vap_sat, λ)\n\nPartition the phases in equilibrium, returning a PhasePartition object.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ (moist-)air density\nq_tot total specific humidity\nphase_type a thermodynamic state type\np_vap_sat saturation vapor pressure\nλ liquid fraction\n\nThe residual q.tot - q.liq - q.ice is the vapor specific humidity.\n\n\n\n\n\nPhasePartition_equil(param_set, T, ρ, q_tot, phase_type)\n\nPartition the phases in equilibrium, returning a PhasePartition object.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\nρ air density\nq_tot total specific humidity\nphase_type a thermodynamic state type\n\nIf the specific humidity q_tot exceeds the saturation specific humidity q_vap_sat (computed using ρ, T and the saturation vapor pressure), the condensate is partitioned into liquid and ice. The fraction of liquid is given by the temperature dependent liquid_fraction_ramp(param_set, T).\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhasePartition_equil_given_p","page":"API Reference","title":"Thermodynamics.PhasePartition_equil_given_p","text":"PhasePartition_equil_given_p(param_set, T, p, q_tot, phase_type)\n\nPartition the phases in equilibrium, returning a PhasePartition object using the liquid_fraction function.\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nT temperature\np air pressure\nq_tot total specific humidity\nphase_type a thermodynamic state type\n\nThe residual q.tot - q.liq - q.ice is the vapor specific humidity.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.ThermodynamicState","page":"API Reference","title":"Thermodynamics.ThermodynamicState","text":"ThermodynamicState{FT}\n\nA thermodynamic state representing the complete thermodynamic properties of a moist air parcel. All ThermodynamicState subtypes provide access to functions to compute all other thermodynamic properties through the equation of state and thermodynamic relations.\n\nThe state can be initialized using various thermodynamic formulations (via its subtypes), each representing different assumptions about phase equilibrium and the specific variables used to define the state.\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.PhasePartition","page":"API Reference","title":"Thermodynamics.PhasePartition","text":"PhasePartition\n\nRepresents the mass fractions of the moist air mixture (the partitioning of water substance  between vapor, liquid, and ice phases).\n\nThe total specific humidity q_tot represents the total water content, while q_liq and q_ice represent the liquid and ice specific humidities, respectively. The vapor specific humidity is computed as q_vap = q_tot - q_liq - q_ice.\n\nConstructors\n\nPhasePartition(q_tot::Real[, q_liq::Real[, q_ice::Real]])\nPhasePartition(param_set::APS, ts::ThermodynamicState)\n\nSee also PhasePartition_equil\n\nFields\n\ntot: total specific humidity\nliq: liquid water specific humidity (default: 0)\nice: ice specific humidity (default: 0)\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.PhaseDry","page":"API Reference","title":"Thermodynamics.PhaseDry","text":"PhaseDry{FT} <: AbstractPhaseDry\n\nA dry thermodynamic state representing air with no water vapor (q_tot = 0). This state assumes the air parcel contains only dry air components.\n\nConstructors\n\nPhaseDry(param_set, e_int, ρ)\n\nFields\n\ne_int: internal energy\nρ: density of dry air\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.PhaseDry_ρe","page":"API Reference","title":"Thermodynamics.PhaseDry_ρe","text":"PhaseDry_ρe(param_set, ρ, e_int)\n\nConstructs a PhaseDry thermodynamic state from density and internal energy, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ air density\ne_int specific internal energy\n\nThis constructor directly stores the provided density and internal energy without any additional computations, assuming the air is completely dry.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_pT","page":"API Reference","title":"Thermodynamics.PhaseDry_pT","text":"PhaseDry_pT(param_set, p, T)\n\nConstructs a PhaseDry thermodynamic state from pressure and temperature, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nT temperature\n\nThe internal energy is computed from the temperature using the dry air equation of state, and the density is computed from the ideal gas law using the pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_pθ","page":"API Reference","title":"Thermodynamics.PhaseDry_pθ","text":"PhaseDry_pθ(param_set, p, θ_dry)\n\nConstructs a PhaseDry thermodynamic state from pressure and dry potential temperature, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nθ_dry dry potential temperature\n\nThe temperature is computed from the pressure and potential temperature using the Exner function, and the density is computed from the ideal gas law using the pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_pe","page":"API Reference","title":"Thermodynamics.PhaseDry_pe","text":"PhaseDry_pe(param_set, p, e_int)\n\nConstructs a PhaseDry thermodynamic state from pressure and internal energy, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\ne_int specific internal energy\n\nThe temperature is computed from the internal energy using the dry air equation of state, and the density is computed from the ideal gas law using the pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_ph","page":"API Reference","title":"Thermodynamics.PhaseDry_ph","text":" PhaseDry_ph(param_set, p, h)\n\nConstructs a PhaseDry thermodynamic state from pressure and specific enthalpy, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nh specific enthalpy\n\nThe temperature is computed from the specific enthalpy using the dry air equation of state, and the density is computed from the ideal gas law using the pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_ρθ","page":"API Reference","title":"Thermodynamics.PhaseDry_ρθ","text":"PhaseDry_ρθ(param_set, ρ, θ_dry)\n\nConstructs a PhaseDry thermodynamic state from density and dry potential temperature, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\nθ_dry dry potential temperature\n\nThe temperature is computed from the density and potential temperature using the dry air equation of state, and the internal energy is computed from the temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_ρT","page":"API Reference","title":"Thermodynamics.PhaseDry_ρT","text":"PhaseDry_ρT(param_set, ρ, T)\n\nConstructs a PhaseDry thermodynamic state from density and temperature, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\nT temperature\n\nThe internal energy is computed directly from the temperature using the dry air equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseDry_ρp","page":"API Reference","title":"Thermodynamics.PhaseDry_ρp","text":"PhaseDry_ρp(param_set, ρ, p)\n\nConstructs a PhaseDry thermodynamic state from density and pressure, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\np pressure\n\nThe temperature is computed from the ideal gas law using the pressure and density, and the internal energy is computed from the temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil","page":"API Reference","title":"Thermodynamics.PhaseEquil","text":"PhaseEquil{FT} <: AbstractPhaseEquil\n\nA thermodynamic state assuming thermodynamic equilibrium between water phases. This state assumes that the water vapor is in equilibrium with liquid and/or ice, requiring saturation adjustment to compute the temperature and phase partitioning.\n\nThe state stores the density, pressure, internal energy, total specific humidity, and the computed temperature from saturation adjustment.\n\nConstructors\n\nPhaseEquil(param_set, ρ, e_int, q_tot)\n\nFields\n\nρ: density of air (potentially moist)\np: air pressure\ne_int: internal energy\nq_tot: total specific humidity\nT: temperature: computed via saturation_adjustment\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.PhaseEquil_ρeq","page":"API Reference","title":"Thermodynamics.PhaseEquil_ρeq","text":"PhaseEquil_ρeq(param_set, ρ, e_int, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])\n\nConstructs a PhaseEquil thermodynamic state from density, internal energy, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\ne_int specific internal energy\nq_tot total specific humidity\n\nand, optionally\n\nmaxiter maximum iterations for saturation adjustment (default: 8)\nrelative_temperature_tol relative temperature tolerance for saturation adjustment (default: 1e-4)\nsat_adjust_method the numerical method to use for saturation adjustment (default: NewtonsMethod)  See the Thermodynamics for options.\nT_guess initial guess for temperature in saturation adjustment\n\nThe temperature is computed using saturation adjustment to ensure thermodynamic equilibrium, and the pressure is computed from the equation of state using the temperature and density.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_ρTq","page":"API Reference","title":"Thermodynamics.PhaseEquil_ρTq","text":"PhaseEquil_ρTq(param_set, ρ, T, q_tot)\n\nConstructs a PhaseEquil thermodynamic state from density, temperature, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\nT temperature\nq_tot total specific humidity\n\nThe phase partitioning is computed assuming thermodynamic equilibrium at the given temperature, and the pressure and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_pTq","page":"API Reference","title":"Thermodynamics.PhaseEquil_pTq","text":"PhaseEquil_pTq(param_set, p, T, q_tot)\n\nConstructs a PhaseEquil thermodynamic state from pressure, temperature, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nT temperature\nq_tot total specific humidity\n\nThe phase partitioning is computed assuming thermodynamic equilibrium at the given temperature, and the density and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_pθq","page":"API Reference","title":"Thermodynamics.PhaseEquil_pθq","text":"PhaseEquil_pθq(param_set, p, θ_li, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])\n\nConstructs a PhaseEquil thermodynamic state from pressure, liquid-ice potential temperature, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np air pressure\nθ_li liquid-ice potential temperature\nq_tot total specific humidity\n\nand, optionally\n\nmaxiter maximum iterations for saturation adjustment (default: 50)\nrelative_temperature_tol relative temperature tolerance for saturation adjustment (default: 1e-4)\nsat_adjust_method the numerical method to use for saturation adjustment (default: SecantMethod)  See the Thermodynamics for options.\nT_guess initial guess for temperature in saturation adjustment\n\nThe temperature is computed using saturation adjustment with respect to the liquid-ice potential temperature, and the density and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_peq","page":"API Reference","title":"Thermodynamics.PhaseEquil_peq","text":"PhaseEquil_peq(param_set, p, e_int, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])\n\nConstructs a PhaseEquil thermodynamic state from pressure, internal energy, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\ne_int specific internal energy\nq_tot total specific humidity\n\nand, optionally\n\nmaxiter maximum iterations for saturation adjustment (default: 40)\nrelative_temperature_tol relative temperature tolerance for saturation adjustment (default: 1e-4)\nsat_adjust_method the numerical method to use for saturation adjustment (default: SecantMethod)  See the Thermodynamics for options.\nT_guess initial guess for temperature in saturation adjustment\n\nThe temperature is computed using saturation adjustment given pressure and internal energy, and the density is computed from the equation of state using the pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_phq","page":"API Reference","title":"Thermodynamics.PhaseEquil_phq","text":"PhaseEquil_phq(param_set, p, h, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])\n\nConstructs a PhaseEquil thermodynamic state from pressure, specific enthalpy, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nh specific enthalpy\nq_tot total specific humidity\n\nand, optionally\n\nmaxiter maximum iterations for saturation adjustment (default: 40)\nrelative_temperature_tol relative temperature tolerance for saturation adjustment (default: 1e-4)\nsat_adjust_method the numerical method to use for saturation adjustment (default: SecantMethod)  See the Thermodynamics for options.\nT_guess initial guess for temperature in saturation adjustment\n\nThe temperature is computed using saturation adjustment given pressure and specific enthalpy, and the density and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_ρθq","page":"API Reference","title":"Thermodynamics.PhaseEquil_ρθq","text":"PhaseEquil_ρθq(param_set, ρ, θ_li, q_tot[, maxiter, relative_temperature_tol, T_guess])\n\nConstructs a PhaseEquil thermodynamic state from density, liquid-ice potential temperature, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ (moist-)air density\nθ_li liquid-ice potential temperature\nq_tot total specific humidity\n\nand, optionally\n\nmaxiter maximum iterations for saturation adjustment (default: 36)\nrelative_temperature_tol relative temperature tolerance for saturation adjustment (default: 1e-4)\nT_guess initial guess for temperature in saturation adjustment\n\nThe temperature is computed using saturation adjustment with respect to the liquid-ice potential temperature, and the pressure and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseEquil_ρpq","page":"API Reference","title":"Thermodynamics.PhaseEquil_ρpq","text":"PhaseEquil_ρpq(param_set, ρ, p, q_tot[, perform_sat_adjust=true, maxiter, sat_adjust_method, T_guess])\n\nConstructs a PhaseEquil thermodynamic state from density, pressure, and total specific humidity, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\np pressure\nq_tot total specific humidity\n\nand, optionally\n\nperform_sat_adjust Boolean indicating whether to perform saturation adjustment (default: false)\nmaxiter maximum number of iterations to perform in saturation adjustment (default: 5)\nsat_adjust_method the numerical method to use for saturation adjustment (default: NewtonsMethodAD)  See the Thermodynamics for options.\nT_guess initial guess for temperature in saturation adjustment\n\nIf perform_sat_adjust is true, the temperature is computed using saturation adjustment. Otherwise, the temperature is computed directly from the ideal gas law. The internal energy is computed from the temperature and phase partitioning.\n\nTODO: change input argument order: performsatadjust is       unique to this constructor, so it should be last.       (breaking change)\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil","page":"API Reference","title":"Thermodynamics.PhaseNonEquil","text":" PhaseNonEquil{FT} <: ThermodynamicState\n\nA thermodynamic state assuming thermodynamic non-equilibrium between water phases. This state allows for arbitrary phase partitioning without requiring saturation adjustment, enabling direct computation of temperature from the given thermodynamic variables.\n\nThe state stores the internal energy, density, and a complete phase partition specifying the distribution of water substance between vapor, liquid, and ice phases.\n\nConstructors\n\nPhaseNonEquil(param_set, e_int, q::PhasePartition, ρ)\n\nFields\n\ne_int: internal energy\nρ: density of air (potentially moist)\nq: phase partition\n\n\n\n\n\n","category":"type"},{"location":"API/#Thermodynamics.PhaseNonEquil_ρTq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_ρTq","text":"PhaseNonEquil_ρTq(param_set, ρ, T, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from density, temperature, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ (moist-)air density\nT temperature\nq_pt phase partition\n\nThe internal energy is computed from the temperature and phase partition using the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil_pTq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_pTq","text":"PhaseNonEquil_pTq(param_set, p, T, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from pressure, temperature, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nT air temperature\nq_pt phase partition\n\nThe density is computed from the ideal gas law using the pressure and temperature, and the internal energy is computed from the temperature and phase partition.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil_ρθq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_ρθq","text":"PhaseNonEquil_ρθq(param_set, ρ, θ_li, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from density, liquid-ice potential temperature, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ (moist-)air density\nθ_li liquid-ice potential temperature\nq_pt phase partition\n\nand, optionally\n\nmaxiter maximum iterations for non-linear equation solve (default: 10)\nrelative_temperature_tol relative temperature tolerance for non-linear equation solve (default: 1e-2)\n\nThe temperature is computed from the density and liquid-ice potential temperature using a non-linear solver, and the internal energy is computed from the temperature and phase partition.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil_pθq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_pθq","text":"PhaseNonEquil_pθq(param_set, p, θ_li, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from pressure, liquid-ice potential temperature, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nθ_li liquid-ice potential temperature\nq_pt phase partition\n\nThe temperature is computed from the pressure and liquid-ice potential temperature, and the density and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil_peq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_peq","text":"PhaseNonEquil_peq(param_set, p, e_int, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from pressure, internal energy, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\ne_int specific internal energy\nq_pt phase partition\n\nThe temperature is computed from the internal energy and phase partition using the equation of state, and the density is computed from the ideal gas law using the pressure and temperature.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil_phq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_phq","text":"PhaseNonEquil_phq(param_set, p, h, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from pressure, specific enthalpy, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\np pressure\nh specific enthalpy\nq_pt phase partition\n\nThe temperature is computed from the specific enthalpy and phase partition using the equation of state, and the density and internal energy are computed from the equation of state.\n\n\n\n\n\n","category":"function"},{"location":"API/#Thermodynamics.PhaseNonEquil_ρpq","page":"API Reference","title":"Thermodynamics.PhaseNonEquil_ρpq","text":"PhaseNonEquil_ρpq(param_set, ρ, p, q_pt)\n\nConstructs a PhaseNonEquil thermodynamic state from density, pressure, and phase partition, given\n\nparam_set a thermodynamics parameter set, see the Thermodynamics for more details\nρ density\np pressure\nq_pt phase partition\n\nThe temperature is computed from the ideal gas law using the pressure and density, and the internal energy is computed from the temperature and phase partition.\n\n\n\n\n\n","category":"function"}]
}

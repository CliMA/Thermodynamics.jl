<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Thermodynamics.jl</title><meta name="title" content="API Reference · Thermodynamics.jl"/><meta property="og:title" content="API Reference · Thermodynamics.jl"/><meta property="twitter:title" content="API Reference · Thermodynamics.jl"/><meta name="description" content="Documentation for Thermodynamics.jl."/><meta property="og:description" content="Documentation for Thermodynamics.jl."/><meta property="twitter:description" content="Documentation for Thermodynamics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../src/assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="Thermodynamics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Thermodynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Formulation/">Mathematical Formulation</a></li><li><a class="tocitem" href="../HowToGuide/">How-To Guide</a></li><li><a class="tocitem" href="../TemperatureProfiles/">Temperature Profiles</a></li><li><a class="tocitem" href="../TestedProfiles/">Tested Profiles</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Thermodynamics-Parameters"><span>Thermodynamics Parameters</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Thermodynamic-Functions"><span>Thermodynamic Functions</span></a></li><li><a class="tocitem" href="#Temperature-Profiles"><span>Temperature Profiles</span></a></li><li><a class="tocitem" href="#Data-Collection"><span>Data Collection</span></a></li><li><a class="tocitem" href="#Deprecated-Functions"><span>Deprecated Functions</span></a></li><li><a class="tocitem" href="#Thermodynamic-State-Constructors-(Deprecated)"><span>Thermodynamic State Constructors (Deprecated)</span></a></li></ul></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/Thermodynamics.jl/blob/main/docs/src/API.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Thermodynamics"><a class="docs-heading-anchor" href="#Thermodynamics">Thermodynamics</a><a id="Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="Thermodynamics.Thermodynamics"><a class="docstring-binding" href="#Thermodynamics.Thermodynamics"><code>Thermodynamics.Thermodynamics</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">Thermodynamics</code></pre><p>Moist thermodynamic functions for atmospheric modeling, including air pressure, latent heats, saturation vapor pressures, and saturation specific humidities.</p><p><strong>Parameter Sets</strong></p><p>Many functions defined in this module rely on ClimaParams.jl. ClimaParams.jl defines several functions (e.g., many planet parameters). For example, to compute the mole-mass ratio of  dry air and water vapor:</p><pre><code class="language-julia hljs">import ClimaParams as CP
import Thermodynamics.Parameters as TP
FT = Float64
param_set = TP.ThermodynamicsParameters(FT)
Rv_over_Rd = TP.Rv_over_Rd(param_set)</code></pre><p>Because these parameters are widely used throughout this module, <code>param_set</code> is an argument for many Thermodynamics functions.</p><p><strong>Saturation adjustment</strong></p><p>One entry point is <a href="#Thermodynamics.saturation_adjustment"><code>saturation_adjustment</code></a>. It accepts:</p><ul><li><code>method</code>: A root-solving method type from RootSolvers.jl (e.g., <code>RS.NewtonsMethod</code>, <code>RS.SecantMethod</code>).</li><li><code>param_set</code>: The thermodynamics parameter set.</li><li><code>formulation</code>: The thermodynamic formulation (e.g., <a href="#Thermodynamics.ρe"><code>ρe()</code></a>, <a href="#Thermodynamics.ph"><code>ph()</code></a>).</li><li>Thermodynamic state variables appropriate for the formulation.</li></ul><p>Supported methods in RootSolvers.jl:</p><ul><li><code>NewtonsMethod</code>: Newton method with analytic gradients (recommended for <code>ρe</code>).</li><li><code>NewtonsMethodAD</code>: Newton method with automatic differentiation.</li><li><code>SecantMethod</code>: Secant method (derivative-free).</li><li><code>BrentsMethod</code>: Brent&#39;s method (hybrid root-finding).</li></ul><p><strong>Thermodynamic functions</strong></p><p>Many thermodynamic functions (e.g., <a href="#Thermodynamics.air_temperature"><code>air_temperature</code></a>, <a href="#Thermodynamics.air_pressure"><code>air_pressure</code></a>) are dispatched over the independent variables used to compute them. The available independent variable types (subtypes of <a href="#Thermodynamics.IndepVars"><code>IndepVars</code></a>) are:</p><ul><li><a href="#Thermodynamics.ρe"><code>ρe</code></a>: Density, internal energy, and specific humidities</li><li><a href="#Thermodynamics.pe"><code>pe</code></a>: Pressure, internal energy, and specific humidities</li><li><a href="#Thermodynamics.ph"><code>ph</code></a>: Pressure, enthalpy, and specific humidities</li><li><a href="#Thermodynamics.pρ"><code>pρ</code></a>: Pressure, density, and specific humidities</li><li><a href="#Thermodynamics.pθ_li"><code>pθ_li</code></a>: Pressure, liquid-ice potential temperature, and specific humidities</li><li><a href="#Thermodynamics.ρθ_li"><code>ρθ_li</code></a>: Density, liquid-ice potential temperature, and specific humidities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/Thermodynamics.jl#L1-L51">source</a></section></details></article><h2 id="Thermodynamics-Parameters"><a class="docs-heading-anchor" href="#Thermodynamics-Parameters">Thermodynamics Parameters</a><a id="Thermodynamics-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics-Parameters" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thermodynamics.Parameters"><a class="docstring-binding" href="#Thermodynamics.Parameters"><code>Thermodynamics.Parameters</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">Parameters</code></pre><p>Submodule defining thermodynamic parameter types and accessor functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/Parameters.jl#L1-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.Parameters.ThermodynamicsParameters"><a class="docstring-binding" href="#Thermodynamics.Parameters.ThermodynamicsParameters"><code>Thermodynamics.Parameters.ThermodynamicsParameters</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ThermodynamicsParameters</code></pre><p>Parameters for Thermodynamics.jl.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">import ClimaParams as CP
import Thermodynamics.Parameters as TP

FT = Float64;
param_set = TP.ThermodynamicsParameters(FT)

# Alternatively:

toml_dict = CP.create_toml_dict(FT)
param_set = TP.ThermodynamicsParameters(toml_dict)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/Parameters.jl#L13-L31">source</a></section></details></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thermodynamics.Phase"><a class="docstring-binding" href="#Thermodynamics.Phase"><code>Thermodynamics.Phase</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Phase</code></pre><p>A condensed phase, to dispatch over (e.g., in <a href="#Thermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L63-L68">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.Liquid"><a class="docstring-binding" href="#Thermodynamics.Liquid"><code>Thermodynamics.Liquid</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Liquid &lt;: Phase</code></pre><p>A liquid phase, to dispatch over (e.g., in <a href="#Thermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L71-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.Ice"><a class="docstring-binding" href="#Thermodynamics.Ice"><code>Thermodynamics.Ice</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Ice &lt;: Phase</code></pre><p>An ice phase, to dispatch over (e.g., in <a href="#Thermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L79-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.IndepVars"><a class="docstring-binding" href="#Thermodynamics.IndepVars"><code>Thermodynamics.IndepVars</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">IndepVars</code></pre><p>Abstract type to dispatch over the independent variables used to compute a thermodynamic quantity (e.g., in <a href="#Thermodynamics.air_temperature"><code>air_temperature</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L13-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.ρe"><a class="docstring-binding" href="#Thermodynamics.ρe"><code>Thermodynamics.ρe</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ρe &lt;: IndepVars</code></pre><p>Density, internal energy, and specific humidity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L21-L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.pe"><a class="docstring-binding" href="#Thermodynamics.pe"><code>Thermodynamics.pe</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">pe &lt;: IndepVars</code></pre><p>Pressure, internal energy, and specific humidity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L28-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.ph"><a class="docstring-binding" href="#Thermodynamics.ph"><code>Thermodynamics.ph</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ph &lt;: IndepVars</code></pre><p>Pressure, enthalpy, and specific humidity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L35-L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.pρ"><a class="docstring-binding" href="#Thermodynamics.pρ"><code>Thermodynamics.pρ</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">pρ &lt;: IndepVars</code></pre><p>Pressure, density, and specific humidity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L42-L46">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.pθ_li"><a class="docstring-binding" href="#Thermodynamics.pθ_li"><code>Thermodynamics.pθ_li</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">pθ_li &lt;: IndepVars</code></pre><p>Pressure, liquid-ice potential temperature, and specific humidity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L49-L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.ρθ_li"><a class="docstring-binding" href="#Thermodynamics.ρθ_li"><code>Thermodynamics.ρθ_li</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ρθ_li &lt;: IndepVars</code></pre><p>Density, liquid-ice potential temperature, and specific humidity</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/ThermoTypes.jl#L56-L60">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.DryAdiabaticProcess"><a class="docstring-binding" href="#Thermodynamics.DryAdiabaticProcess"><code>Thermodynamics.DryAdiabaticProcess</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DryAdiabaticProcess</code></pre><p>A type for dispatching to isentropic (dry adiabatic) formulas.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_dry_adiabatic.jl#L6-L11">source</a></section></details></article><h2 id="Thermodynamic-Functions"><a class="docs-heading-anchor" href="#Thermodynamic-Functions">Thermodynamic Functions</a><a id="Thermodynamic-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamic-Functions" title="Permalink"></a></h2><h3 id="Air-Properties"><a class="docs-heading-anchor" href="#Air-Properties">Air Properties</a><a id="Air-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Properties" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.gas_constant_air"><a class="docstring-binding" href="#Thermodynamics.gas_constant_air"><code>Thermodynamics.gas_constant_air</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">gas_constant_air(param_set, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The specific gas constant of moist air <code>R_m</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>R_m</code>: specific gas constant of moist air [J/(kg·K)]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L17-L32">source</a></section><section><div><pre><code class="language-julia hljs">gas_constant_air(param_set, ts::ThermodynamicState)</code></pre><p>The specific gas constant of moist air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L21-L25">source</a></section><section><div><pre><code class="language-julia hljs">gas_constant_air(param_set[, q::PhasePartition])</code></pre><p>The specific gas constant of moist air.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L314-L323">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.cp_m"><a class="docstring-binding" href="#Thermodynamics.cp_m"><code>Thermodynamics.cp_m</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">cp_m(param_set, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The isobaric specific heat capacity of moist air <code>cp_m</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q_tot</code>: total specific humidity of water [kg/kg]</li><li><code>q_liq</code>: specific humidity of liquid [kg/kg]</li><li><code>q_ice</code>: specific humidity of ice [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>cp_m</code>: isobaric specific heat capacity [J/(kg·K)]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The specific heat capacities are assumed to be constant (calorically perfect air).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L45-L61">source</a></section><section><div><pre><code class="language-julia hljs">cp_m(param_set, ts::ThermodynamicState)</code></pre><p>The isobaric specific heat capacity of moist air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L33-L37">source</a></section><section><div><pre><code class="language-julia hljs">cp_m(param_set[, q::PhasePartition])</code></pre><p>The isobaric specific heat capacity of moist air.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L328-L337">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.cv_m"><a class="docstring-binding" href="#Thermodynamics.cv_m"><code>Thermodynamics.cv_m</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">cv_m(param_set, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The isochoric specific heat capacity of moist air <code>cv_m</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>cv_m</code>: isochoric specific heat capacity [J/(kg·K)]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The specific heat capacities are assumed to be constant (calorically perfect air).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L74-L90">source</a></section><section><div><pre><code class="language-julia hljs">cv_m(param_set, ts::ThermodynamicState)</code></pre><p>The isochoric specific heat capacity of moist air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L43-L47">source</a></section><section><div><pre><code class="language-julia hljs">cv_m(param_set[, q::PhasePartition])</code></pre><p>The isochoric specific heat capacity of moist air.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without humidity argument, the results are for dry air.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L342-L349">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.soundspeed_air"><a class="docstring-binding" href="#Thermodynamics.soundspeed_air"><code>Thermodynamics.soundspeed_air</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">soundspeed_air(param_set, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The speed of sound in unstratified air.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>c</code>: speed of sound [m/s]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The formula is <code>c = √(γ R_m T)</code> where <code>γ = cp_m/cv_m</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L229-L246">source</a></section><section><div><pre><code class="language-julia hljs">soundspeed_air(param_set, ts::ThermodynamicState)</code></pre><p>The speed of sound in unstratified air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L77-L81">source</a></section><section><div><pre><code class="language-julia hljs">soundspeed_air(param_set, T[, q::PhasePartition])</code></pre><p>The speed of sound in unstratified air.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L354-L367">source</a></section></details></article><h3 id="Air-Humidities"><a class="docs-heading-anchor" href="#Air-Humidities">Air Humidities</a><a id="Air-Humidities-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Humidities" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.vapor_specific_humidity"><a class="docstring-binding" href="#Thermodynamics.vapor_specific_humidity"><code>Thermodynamics.vapor_specific_humidity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vapor_specific_humidity(q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The vapor specific humidity (clamped to be non-negative).</p><p><strong>Arguments</strong></p><ul><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_vap</code>: vapor specific humidity [kg/kg]</li></ul><p>If the specific humidities are not given, the result is zero. The formula is <code>q_vap = q_tot - q_liq - q_ice</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L12-L27">source</a></section><section><div><pre><code class="language-julia hljs">vapor_specific_humidity(param_set, ts::ThermodynamicState)</code></pre><p>The vapor specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L390-L394">source</a></section><section><div><pre><code class="language-julia hljs">vapor_specific_humidity(q::PhasePartition)</code></pre><p>The vapor specific humidity. </p><ul><li><code>q</code> a <code>PhasePartition</code> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L194-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.condensate_specific_humidity"><a class="docstring-binding" href="#Thermodynamics.condensate_specific_humidity"><code>Thermodynamics.condensate_specific_humidity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">condensate_specific_humidity(q_liq=0, q_ice=0)</code></pre><p>The condensate specific humidity.</p><p><strong>Arguments</strong></p><ul><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_cond</code>: condensate specific humidity [kg/kg]</li></ul><p>If the specific humidities are not given, the result is zero. The formula is <code>q_cond = q_liq + q_ice</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L32-L46">source</a></section><section><div><pre><code class="language-julia hljs">condensate_specific_humidity(param_set, ts::ThermodynamicState)</code></pre><p>The condensate specific humidity (liquid + ice).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L590-L594">source</a></section><section><div><pre><code class="language-julia hljs">condensate_specific_humidity(q::PhasePartition{FT})</code></pre><p>The condensate specific humidity (liquid + ice) of the phase  partition <code>q</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L204-L209">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.vol_vapor_mixing_ratio"><a class="docstring-binding" href="#Thermodynamics.vol_vapor_mixing_ratio"><code>Thermodynamics.vol_vapor_mixing_ratio</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vol_vapor_mixing_ratio(param_set, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The molar (volume) mixing ratio of water vapor.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>r_v</code>: molar mixing ratio of water vapor [mol/mol]</li></ul><p>If the specific humidities are not given, the result is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L51-L66">source</a></section><section><div><pre><code class="language-julia hljs">vol_vapor_mixing_ratio(param_set, ts::ThermodynamicState)</code></pre><p>The volume mixing ratio of water vapor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L406-L410">source</a></section><section><div><pre><code class="language-julia hljs">vol_vapor_mixing_ratio(param_set, q::PhasePartition)</code></pre><p>The volume mixing ratio of water vapor.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L230-L237">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.partial_pressure_dry"><a class="docstring-binding" href="#Thermodynamics.partial_pressure_dry"><code>Thermodynamics.partial_pressure_dry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">partial_pressure_dry(param_set, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The partial pressure of dry air.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: air pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>p_d</code>: partial pressure of dry air [Pa]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this equals the total pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L78-L94">source</a></section><section><div><pre><code class="language-julia hljs">partial_pressure_dry(param_set, ts::ThermodynamicState)</code></pre><p>The partial pressure of dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L414-L418">source</a></section><section><div><pre><code class="language-julia hljs">partial_pressure_dry(param_set, p, q::PhasePartition)</code></pre><p>The partial pressure of dry air.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> air pressure</li><li><code>q</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L242-L251">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.partial_pressure_vapor"><a class="docstring-binding" href="#Thermodynamics.partial_pressure_vapor"><code>Thermodynamics.partial_pressure_vapor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">partial_pressure_vapor(param_set, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The partial pressure of water vapor.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: air pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>p_v</code>: partial pressure of water vapor [Pa]</li></ul><p>If the specific humidities are not given, the partial pressure is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L107-L123">source</a></section><section><div><pre><code class="language-julia hljs">partial_pressure_vapor(param_set, ts::ThermodynamicState)</code></pre><p>The partial pressure of water vapor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L433-L437">source</a></section><section><div><pre><code class="language-julia hljs">partial_pressure_vapor(param_set, p, q::PhasePartition)</code></pre><p>The partial pressure of water vapor.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> air pressure</li><li><code>q</code> phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L256-L265">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.vapor_pressure_deficit"><a class="docstring-binding" href="#Thermodynamics.vapor_pressure_deficit"><code>Thermodynamics.vapor_pressure_deficit</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vapor_pressure_deficit(param_set, T, p, q_tot, q_liq, q_ice, phase::Phase)</code></pre><p>The vapor pressure deficit (saturation vapor pressure minus actual vapor pressure,  truncated to be non-negative) over a specific phase (Liquid or Ice).</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: air temperature [K]</li><li><code>p</code>: air pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li><li><code>phase</code>: phase to compute saturation over (<code>Liquid()</code> or <code>Ice()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>VPD</code>: vapor pressure deficit [Pa]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L504-L521">source</a></section><section><div><pre><code class="language-julia hljs">vapor_pressure_deficit(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The vapor pressure deficit (saturation vapor pressure minus actual vapor pressure,  truncated to be non-negative) over liquid water for temperatures above freezing  and over ice for temperatures below freezing.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: air temperature [K]</li><li><code>p</code>: air pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>VPD</code>: vapor pressure deficit [Pa]</li></ul><p>If the specific humidities are not given, the result is the saturation vapor pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L536-L555">source</a></section><section><div><pre><code class="language-julia hljs">vapor_pressure_deficit(param_set, T, p[, q::PhasePartition])</code></pre><p>The vapor pressure deficit (saturation vapor pressure minus actual  vapor pressure, truncated to be non-negative) over liquid water for temperatures  above freezing and over ice for temperatures below freezing.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> air temperature</li><li><code>p</code> air pressure</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>When <code>q</code> is not provided, the vapor pressure deficit is the saturation vapor pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L270-L283">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.relative_humidity"><a class="docstring-binding" href="#Thermodynamics.relative_humidity"><code>Thermodynamics.relative_humidity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_humidity(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The relative humidity (clipped between 0 and 1).</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>p</code>: pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>RH</code>: relative humidity [dimensionless], 0 ≤ RH ≤ 1</li></ul><p>If <code>q_liq</code> and <code>q_ice</code> are zero (or not given), the relative humidity is computed relative to saturation over ice below freezing and over liquid above freezing. If condensate is present, the relative humidity is computed relative to saturation over a mixture of liquid and ice, with the liquid fraction given by the ratio <code>q_liq / (q_liq + q_ice)</code>.</p><p>Note: <code>relative_humidity</code> uses <code>saturation_vapor_pressure(param_set, T, q_liq, q_ice)</code>. In particular, for <code>q_liq == q_ice == 0</code> it includes a small smooth transition around freezing (via <code>liquid_fraction(param_set, T, q_liq, q_ice)</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L216-L240">source</a></section><section><div><pre><code class="language-julia hljs">relative_humidity(param_set, ts::ThermodynamicState)</code></pre><p>The relative humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L455-L459">source</a></section><section><div><pre><code class="language-julia hljs">relative_humidity(param_set, T, p, phase_type, q::PhasePartition)</code></pre><p>The relative humidity (clipped between 0 and 1).</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> pressure</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L288-L299">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.condensate_partition"><a class="docstring-binding" href="#Thermodynamics.condensate_partition"><code>Thermodynamics.condensate_partition</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">condensate_partition(param_set, T, ρ, q_tot)</code></pre><p>Compute the equilibrium liquid and ice specific humidities from the condensate in thermodynamic equilibrium, returning a tuple <code>(q_liq, q_ice)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>(q_liq, q_ice)</code>: tuple of liquid and ice specific humidities [kg/kg]</li></ul><p>The condensate is partitioned into liquid and ice using the temperature-dependent liquid fraction (see <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a>) and the saturation excess (see  <a href="#Thermodynamics.saturation_excess"><code>saturation_excess</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L477-L495">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.has_condensate"><a class="docstring-binding" href="#Thermodynamics.has_condensate"><code>Thermodynamics.has_condensate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">has_condensate(q_c)</code></pre><p>Bool indicating if condensate exists, i.e., q_c &gt; eps.</p><p>We use a threshold of <code>eps</code> rather than <code>0</code> to avoid division by zero in functions such as <code>liquid_fraction</code> and to robustly handle numerical noise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L84-L91">source</a></section><section><div><pre><code class="language-julia hljs">has_condensate(param_set, ts::ThermodynamicState)</code></pre><p>Bool indicating if condensate exists.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L598-L602">source</a></section><section><div><pre><code class="language-julia hljs">has_condensate(q::PhasePartition{FT})</code></pre><p>Bool indicating if condensate exists in the phase partition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L63-L67">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.liquid_fraction"><a class="docstring-binding" href="#Thermodynamics.liquid_fraction"><code>Thermodynamics.liquid_fraction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">liquid_fraction(param_set, T, q_liq, q_ice)</code></pre><p>The fraction of condensate that is liquid.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>λ</code>: liquid fraction [dimensionless], 0 ≤ λ ≤ 1</li></ul><p>The liquid fraction is computed from <code>q_liq</code> and <code>q_ice</code>. If <code>q_liq + q_ice</code> exceeds a small threshold (see <a href="#Thermodynamics.has_condensate"><code>has_condensate</code></a>), <code>q_liq / (q_liq + q_ice)</code> is returned. If there is effectively no condensate, a smooth temperature-dependent partitioning is used (linear ramp from 0 to 1 over ±0.1 K around freezing).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L12-L30">source</a></section><section><div><pre><code class="language-julia hljs">liquid_fraction(param_set, ts::ThermodynamicState)</code></pre><p>The fraction of condensate that is liquid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L606-L610">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.liquid_fraction_ramp"><a class="docstring-binding" href="#Thermodynamics.liquid_fraction_ramp"><code>Thermodynamics.liquid_fraction_ramp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">liquid_fraction_ramp(param_set, T)</code></pre><p>The liquid fraction computed from temperature using a power law interpolation between <code>T_icenuc</code> and <code>T_freeze</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>λ</code>: liquid fraction [dimensionless], 0 ≤ λ ≤ 1</li></ul><p>Edge cases:</p><ul><li>For <code>T &gt; T_freeze</code>, this returns <code>1</code>; for <code>T ≤ T_icenuc</code>, it returns <code>0</code>.</li></ul><p><strong>Reference</strong></p><p>Kaul et al. (2015), &quot;Sensitivities in large-eddy simulations of mixed-phase Arctic stratocumulus clouds using a simple microphysics approach,&quot; <em>Monthly Weather Review</em>, <strong>143</strong>, 4393-4421, doi:<a href="https://doi.org/10.1175/MWR-D-14-00319.1">10.1175/MWR-D-14-00319.1</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L44-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_humidity_to_mixing_ratio"><a class="docstring-binding" href="#Thermodynamics.specific_humidity_to_mixing_ratio"><code>Thermodynamics.specific_humidity_to_mixing_ratio</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_humidity_to_mixing_ratio(q, q_tot)</code></pre><p>Converts specific humidity to mixing ratio (total basis).</p><p><strong>Arguments</strong></p><ul><li><code>q</code>: specific humidity of interest [kg/kg]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>r</code>: mixing ratio [kg/kg]</li></ul><p>Note that this function is singular when <code>q_tot = 1</code>. The formula is <code>r = q / (1 - q_tot)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L136-L150">source</a></section></details></article><h3 id="Air-Energies"><a class="docs-heading-anchor" href="#Air-Energies">Air Energies</a><a id="Air-Energies-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Energies" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.internal_energy"><a class="docstring-binding" href="#Thermodynamics.internal_energy"><code>Thermodynamics.internal_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">internal_energy(param_set, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The internal energy per unit mass.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>e_int</code>: specific internal energy [J/kg]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The internal energy is computed as a mass-weighted sum of the internal energies of each component (dry air, vapor, liquid, ice), referenced to <code>T_0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L19-L37">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy(param_set, ts::ThermodynamicState)</code></pre><p>The internal energy per unit mass.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L227-L231">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy(param_set, T[, q::PhasePartition])</code></pre><p>The internal energy per unit mass. </p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L457-L470">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.internal_energy_dry"><a class="docstring-binding" href="#Thermodynamics.internal_energy_dry"><code>Thermodynamics.internal_energy_dry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">internal_energy_dry(param_set, T)</code></pre><p>The dry air internal energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>e_d</code>: specific internal energy of dry air [J/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L54-L65">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_dry(param_set, ts::ThermodynamicState)</code></pre><p>The dry air internal energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L234-L238">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.internal_energy_vapor"><a class="docstring-binding" href="#Thermodynamics.internal_energy_vapor"><code>Thermodynamics.internal_energy_vapor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">internal_energy_vapor(param_set, T)</code></pre><p>The water vapor internal energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>e_v</code>: specific internal energy of water vapor [J/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L73-L84">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_vapor(param_set, ts::ThermodynamicState)</code></pre><p>The water vapor internal energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L242-L246">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.internal_energy_liquid"><a class="docstring-binding" href="#Thermodynamics.internal_energy_liquid"><code>Thermodynamics.internal_energy_liquid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">internal_energy_liquid(param_set, T)</code></pre><p>The liquid water internal energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>e_l</code>: specific internal energy of liquid water [J/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L93-L104">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_liquid(param_set, ts::ThermodynamicState)</code></pre><p>The liquid water internal energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L250-L254">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.internal_energy_ice"><a class="docstring-binding" href="#Thermodynamics.internal_energy_ice"><code>Thermodynamics.internal_energy_ice</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">internal_energy_ice(param_set, T)</code></pre><p>The ice internal energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>e_i</code>: specific internal energy of ice [J/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L112-L123">source</a></section><section><div><pre><code class="language-julia hljs">internal_energy_ice(param_set, ts::ThermodynamicState)</code></pre><p>The ice internal energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L258-L262">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.enthalpy"><a class="docstring-binding" href="#Thermodynamics.enthalpy"><code>Thermodynamics.enthalpy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enthalpy(e_int, R_m, T)</code></pre><p>The specific enthalpy.</p><p><strong>Arguments</strong></p><ul><li><code>e_int</code>: internal specific energy [J/kg]</li><li><code>R_m</code>: gas constant of moist air [J/(kg·K)], see <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>T</code>: air temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>h</code>: specific enthalpy [J/kg]</li></ul><p>The enthalpy is computed as <code>h = e_int + R_m T</code>, which follows from <code>h = e_int + p v</code> with the ideal gas law <code>p v = R_m T</code> (specific volume v = 1/ρ).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L132-L147">source</a></section><section><div><pre><code class="language-julia hljs">enthalpy(param_set, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The specific enthalpy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>h</code>: specific enthalpy [J/kg]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The enthalpy is computed as a mass-weighted sum of the enthalpies of each component (dry air, vapor, liquid, ice).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L152-L169">source</a></section><section><div><pre><code class="language-julia hljs">enthalpy(param_set, ts)</code></pre><p>The specific enthalpy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L293-L297">source</a></section><section><div><pre><code class="language-julia hljs">enthalpy(param_set, T, q::PhasePartition)</code></pre><p>The specific enthalpy.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L504-L513">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.enthalpy_dry"><a class="docstring-binding" href="#Thermodynamics.enthalpy_dry"><code>Thermodynamics.enthalpy_dry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enthalpy_dry(param_set, T)</code></pre><p>The specific enthalpy of dry air.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>h_d</code>: specific enthalpy of dry air [J/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L180-L191">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.enthalpy_vapor"><a class="docstring-binding" href="#Thermodynamics.enthalpy_vapor"><code>Thermodynamics.enthalpy_vapor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enthalpy_vapor(param_set, T)</code></pre><p>The specific enthalpy of water vapor.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>h_v</code>: specific enthalpy of water vapor [J/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L198-L209">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.enthalpy_liquid"><a class="docstring-binding" href="#Thermodynamics.enthalpy_liquid"><code>Thermodynamics.enthalpy_liquid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enthalpy_liquid(param_set, T)</code></pre><p>The specific enthalpy of liquid.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>h_l</code>: specific enthalpy of liquid [J/kg]</li></ul><p>The specific enthalpy of liquid is equal to the internal energy of liquid because the specific volume of condensed water is neglected (i.e., <code>p v_l ≈ 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L217-L231">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.enthalpy_ice"><a class="docstring-binding" href="#Thermodynamics.enthalpy_ice"><code>Thermodynamics.enthalpy_ice</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">enthalpy_ice(param_set, T)</code></pre><p>The specific enthalpy of ice.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>h_i</code>: specific enthalpy of ice [J/kg]</li></ul><p>The specific enthalpy of ice is equal to the internal energy of ice because the specific volume of condensed water is neglected (i.e., <code>p v_i ≈ 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L235-L249">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.total_energy"><a class="docstring-binding" href="#Thermodynamics.total_energy"><code>Thermodynamics.total_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_energy(param_set, e_kin, e_pot, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The total energy per unit mass.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>e_kin</code>: kinetic energy per unit mass [J/kg]</li><li><code>e_pot</code>: gravitational potential energy (geopotential)per unit mass [J/kg]</li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>e_tot</code>: total specific energy [J/kg]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The total energy is <code>e_tot = e_int + e_kin + e_pot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L252-L271">source</a></section><section><div><pre><code class="language-julia hljs">total_energy(param_set, ts::ThermodynamicState, e_kin, e_pot)</code></pre><p>The total energy per unit mass.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L279-L283">source</a></section><section><div><pre><code class="language-julia hljs">total_energy(param_set, e_kin, e_pot, T[, q::PhasePartition])</code></pre><p>The total energy per unit mass.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_kin</code> kinetic energy per unit mass</li><li><code>e_pot</code> gravitational potential energy per unit mass</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L478-L493">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.total_enthalpy"><a class="docstring-binding" href="#Thermodynamics.total_enthalpy"><code>Thermodynamics.total_enthalpy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_enthalpy(e_tot, R_m, T)</code></pre><p>The total specific enthalpy.</p><p><strong>Arguments</strong></p><ul><li><code>e_tot</code>: total specific energy [J/kg]</li><li><code>R_m</code>: gas constant of moist air [J/(kg·K)], see <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>T</code>: air temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>h_tot</code>: total specific enthalpy [J/kg]</li></ul><p>The total enthalpy is computed as <code>h_tot = e_tot + R_m T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L284-L298">source</a></section><section><div><pre><code class="language-julia hljs">total_enthalpy(param_set, ts, e_tot::Real)</code></pre><p>The total specific enthalpy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L321-L325">source</a></section><section><div><pre><code class="language-julia hljs">total_enthalpy(param_set, e_tot, T[, q::PhasePartition])</code></pre><p>The total specific enthalpy, defined as <code>e_tot + R_m * T</code>.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_tot</code> total specific energy</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L585-L599">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.dry_static_energy"><a class="docstring-binding" href="#Thermodynamics.dry_static_energy"><code>Thermodynamics.dry_static_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">dry_static_energy(param_set, T, e_pot)</code></pre><p>The dry static energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>e_pot</code>: gravitational potential energy per unit mass (geopotential) [J/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s_d</code>: dry static energy [J/kg]</li></ul><p>The dry static energy is the sum of the dry enthalpy and geopotential: <code>s_d = h_d + e_pot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L303-L317">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.vapor_static_energy"><a class="docstring-binding" href="#Thermodynamics.vapor_static_energy"><code>Thermodynamics.vapor_static_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">vapor_static_energy(param_set, T, e_pot)</code></pre><p>The static energy (sensible heat only) of water vapor.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>e_pot</code>: gravitational potential energy per unit mass (geopotential) [J/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s_v</code>: vapor static energy [J/kg]</li></ul><p>The formula is <code>s_v = cp_v * (T - T_0) + e_pot</code>, where <code>T_0</code> is the reference temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L322-L336">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.moist_static_energy"><a class="docstring-binding" href="#Thermodynamics.moist_static_energy"><code>Thermodynamics.moist_static_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">moist_static_energy(param_set, T, e_pot, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The moist static energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>e_pot</code>: gravitational potential energy per unit mass (geopotential) [J/kg]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s_m</code>: moist static energy [J/kg]</li></ul><p>If the specific humidities are not given, the result is for dry air. The moist static energy is the sum of the moist enthalpy and geopotential: <code>s_m = h + e_pot</code>, where <code>h</code> is computed from <a href="#Thermodynamics.enthalpy"><code>enthalpy</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L343-L362">source</a></section><section><div><pre><code class="language-julia hljs">moist_static_energy(param_set, ts, e_pot)</code></pre><p>The moist static energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L308-L312">source</a></section><section><div><pre><code class="language-julia hljs">moist_static_energy(param_set, T, e_pot, q::PhasePartition)</code></pre><p>The moist static energy.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>e_pot</code> gravitational potential energy per unit mass (geopotential)</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L519-L529">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.virtual_dry_static_energy"><a class="docstring-binding" href="#Thermodynamics.virtual_dry_static_energy"><code>Thermodynamics.virtual_dry_static_energy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">virtual_dry_static_energy(param_set, T, e_pot, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The virtual dry static energy.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>e_pot</code>: gravitational potential energy per unit mass (geopotential) [J/kg]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s_vd</code>: virtual dry static energy [J/kg]</li></ul><p>If the specific humidities are not given, the result is for dry air. The virtual dry static energy is <code>s_vd = cp_d * (T_virt - T_0) + e_pot</code>, where <code>T_virt</code> is the virtual temperature (see <a href="#Thermodynamics.virtual_temperature"><code>virtual_temperature</code></a>) and <code>T_0</code> is the reference temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_energies.jl#L375-L394">source</a></section><section><div><pre><code class="language-julia hljs">virtual_dry_static_energy(param_set, ts, e_pot)</code></pre><p>The virtual dry static energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L332-L336">source</a></section><section><div><pre><code class="language-julia hljs">virtual_dry_static_energy(param_set, T, e_pot, q::PhasePartition)</code></pre><p>The virtual dry static energy.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>e_pot</code> gravitational potential energy per unit mass (geopotential)</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L539-L549">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.latent_heat_fusion"><a class="docstring-binding" href="#Thermodynamics.latent_heat_fusion"><code>Thermodynamics.latent_heat_fusion</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">latent_heat_fusion(param_set, T)</code></pre><p>The specific latent heat of fusion <code>L_f</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>L_f</code>: latent heat of fusion [J/kg]</li></ul><p>Because the specific heats are assumed constant, the latent heats are linear functions of temperature by Kirchhoff&#39;s law.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L146-L160">source</a></section><section><div><pre><code class="language-julia hljs">latent_heat_fusion(param_set, ts::ThermodynamicState)</code></pre><p>The specific latent heat of fusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L69-L73">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.latent_heat_sublim"><a class="docstring-binding" href="#Thermodynamics.latent_heat_sublim"><code>Thermodynamics.latent_heat_sublim</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">latent_heat_sublim(param_set, T)</code></pre><p>The specific latent heat of sublimation <code>L_s</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>L_s</code>: latent heat of sublimation [J/kg]</li></ul><p>Because the specific heats are assumed constant, the latent heats are linear functions of temperature by Kirchhoff&#39;s law.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L124-L138">source</a></section><section><div><pre><code class="language-julia hljs">latent_heat_sublim(param_set, ts::ThermodynamicState)</code></pre><p>The specific latent heat of sublimation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L61-L65">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.latent_heat_vapor"><a class="docstring-binding" href="#Thermodynamics.latent_heat_vapor"><code>Thermodynamics.latent_heat_vapor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">latent_heat_vapor(param_set, T)</code></pre><p>The specific latent heat of vaporization <code>L_v</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>L_v</code>: latent heat of vaporization [J/kg]</li></ul><p>Because the specific heats are assumed constant, the latent heats are linear functions of temperature by Kirchhoff&#39;s law.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L102-L116">source</a></section><section><div><pre><code class="language-julia hljs">latent_heat_vapor(param_set, ts::ThermodynamicState)</code></pre><p>The specific latent heat of vaporization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L53-L57">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.latent_heat_mixed"><a class="docstring-binding" href="#Thermodynamics.latent_heat_mixed"><code>Thermodynamics.latent_heat_mixed</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">latent_heat_mixed(param_set, T, λ)</code></pre><p>The specific latent heat of a mixed phase, weighted by the liquid fraction <code>λ</code>.</p><ul><li><code>param_set</code> thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> air temperature</li><li><code>λ</code> liquid fraction</li></ul><p>Because the specific heats are assumed constant, the latent heats are linear functions of  temperature by Kirchhoff&#39;s law.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L190-L201">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.humidity_weighted_latent_heat"><a class="docstring-binding" href="#Thermodynamics.humidity_weighted_latent_heat"><code>Thermodynamics.humidity_weighted_latent_heat</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">humidity_weighted_latent_heat(param_set, q_liq=0, q_ice=0)</code></pre><p>Specific-humidity weighted sum of latent heats of liquid and ice evaluated at reference temperature <code>T_0</code>.</p><ul><li><code>param_set</code> thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q_liq</code> liquid specific humidity</li><li><code>q_ice</code> ice specific humidity</li></ul><p>If <code>q_liq</code> and <code>q_ice</code> are not provided, <code>humidity_weighted_latent_heat</code> is zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_properties.jl#L208-L218">source</a></section><section><div><pre><code class="language-julia hljs">humidity_weighted_latent_heat(param_set::APS, ts::ThermodynamicState)</code></pre><p>Specific-humidity weighted sum of latent heats of liquid and ice evaluated at reference temperature <code>T_0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L167-L171">source</a></section><section><div><pre><code class="language-julia hljs">humidity_weighted_latent_heat(param_set[, q::PhasePartition])</code></pre><p>Specific-humidity weighted sum of latent heats of liquid and ice evaluated at reference temperature  <code>T_0</code>.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, <code>humidity_weighted_latent_heat</code> is zero.</p><p>This is used in the evaluation of the liquid-ice potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L908-L919">source</a></section></details></article><h3 id="Air-Temperatures"><a class="docs-heading-anchor" href="#Air-Temperatures">Air Temperatures</a><a id="Air-Temperatures-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Temperatures" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.air_temperature"><a class="docstring-binding" href="#Thermodynamics.air_temperature"><code>Thermodynamics.air_temperature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_temperature(param_set, e_int, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The air temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_int</code>: specific internal energy of moist air [J/kg]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: air temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air. This method inverts <a href="#Thermodynamics.internal_energy"><code>internal_energy</code></a> by solving for <code>T</code> given <code>e_int</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L9-L26">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, ::ph, h, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The air temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>h</code>: specific enthalpy of moist air [J/kg]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: air temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air. This method inverts <a href="#Thermodynamics.enthalpy"><code>enthalpy</code></a> by solving for <code>T</code> given <code>h</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L57-L74">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, ::pρ, p, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The air temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code>: air pressure [Pa]</li><li><code>ρ</code>: air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: air temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air. This directly applies the ideal gas law: <code>T = p / (R_m ρ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L91-L109">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(
    param_set,
    ::pθ_li,
    p,
    θ_li,
    q_tot=0,
    q_liq=0,
    q_ice=0
)</code></pre><p>The air temperature obtained by inverting the liquid-ice potential temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code>: pressure [Pa]</li><li><code>θ_li</code>: liquid-ice potential temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: air temperature [K]</li></ul><p>If the specific humidities are not given, <code>θ_li</code> is assumed to be the dry-air potential temperature. This inverts <a href="#Thermodynamics.liquid_ice_pottemp_given_pressure"><code>liquid_ice_pottemp_given_pressure</code></a> by solving for <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L123-L150">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, ::ρθ_li, ρ, θ_li, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The air temperature obtained by inverting the liquid-ice potential temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>θ_li</code>: liquid-ice potential temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: air temperature [K]</li></ul><p>If the specific humidities are not given, the results are for dry air.</p><p><strong>Method</strong></p><p>This function uses a second-order Taylor expansion to avoid an iterative inversion. The unsaturated temperature <code>T_unsat</code> is first computed assuming the ideal gas law with potential temperature, then latent heat corrections are applied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L166-L188">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, ::DryAdiabaticProcess, p, θ)</code></pre><p>The air temperature for an isentropic process.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: pressure [Pa]</li><li><code>θ</code>: potential temperature [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>: air temperature [K]</li></ul><p>The temperature is computed using the definition of the dry potential temperature: <code>T = θ * (p/p₀)^κ_d</code>, where <code>p₀</code> is the reference pressure and <code>κ_d = R_d/cp_d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_dry_adiabatic.jl#L67-L82">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, ts::ThermodynamicState)</code></pre><p>The air temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L88-L92">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature(param_set, e_int[, q::PhasePartition])</code></pre><p>The air temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>e_int</code> specific internal energy of moist air</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L804-L817">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.potential_temperature"><a class="docstring-binding" href="#Thermodynamics.potential_temperature"><code>Thermodynamics.potential_temperature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">potential_temperature(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The potential temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>θ</code>: potential temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air.</p><p>Note: if any of <code>q_tot</code>, <code>q_liq</code>, or <code>q_ice</code> are nonzero, the Exner function uses the moist exponent <code>R_m/cp_m</code> (reducing to the dry exponent <code>R_d/cp_d</code> in the dry limit).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L216-L236">source</a></section><section><div><pre><code class="language-julia hljs">potential_temperature(param_set, ts::ThermodynamicState)</code></pre><p>The dry potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L142-L146">source</a></section><section><div><pre><code class="language-julia hljs">potential_temperature(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The dry potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L864-L878">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.potential_temperature_given_pressure"><a class="docstring-binding" href="#Thermodynamics.potential_temperature_given_pressure"><code>Thermodynamics.potential_temperature_given_pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">potential_temperature_given_pressure(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The potential temperature.</p><ul><li><code>param_set</code> thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> pressure</li><li><code>q_tot</code> total specific humidity</li><li><code>q_liq</code> liquid specific humidity</li><li><code>q_ice</code> ice specific humidity</li></ul><p>If the specific humidities are not given, the result is for dry air.</p><p>Note: if any of <code>q_tot</code>, <code>q_liq</code>, or <code>q_ice</code> are nonzero, the Exner function uses the moist exponent <code>R_m/cp_m</code> (reducing to the dry exponent <code>R_d/cp_d</code> in the dry limit).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L248-L264">source</a></section><section><div><pre><code class="language-julia hljs">potential_temperature_given_pressure(param_set, T, p[, q::PhasePartition])</code></pre><p>The dry potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air, i.e., using the adiabatic exponent   for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L883-L898">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.liquid_ice_pottemp"><a class="docstring-binding" href="#Thermodynamics.liquid_ice_pottemp"><code>Thermodynamics.liquid_ice_pottemp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The liquid-ice potential temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>θ_li</code>: liquid-ice potential temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air.</p><p><strong>Reference</strong></p><p>Betts (1973), &quot;Non-precipitating cumulus convection and its parameterization,&quot;  <em>Quarterly Journal of the Royal Meteorological Society</em>, <strong>99</strong>, 178-196, doi:<a href="https://doi.org/10.1002/qj.49709941915">10.1002/qj.49709941915</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L334-L356">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp(param_set, ts::ThermodynamicState)</code></pre><p>The liquid-ice potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L175-L179">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The liquid-ice potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the result is the dry-air potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L957-L971">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.liquid_ice_pottemp_given_pressure"><a class="docstring-binding" href="#Thermodynamics.liquid_ice_pottemp_given_pressure"><code>Thermodynamics.liquid_ice_pottemp_given_pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_given_pressure(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The liquid-ice potential temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>p</code>: pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>θ_li</code>: liquid-ice potential temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air. The latent heats of phase transitions are approximated as constants.</p><p><strong>Reference</strong></p><p>Betts (1973), &quot;Non-precipitating cumulus convection and its parameterization,&quot;  <em>Quarterly Journal of the Royal Meteorological Society</em>, <strong>99</strong>, 178-196, doi:<a href="https://doi.org/10.1002/qj.49709941915">10.1002/qj.49709941915</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L375-L398">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_given_pressure(param_set, T, p[, q::PhasePartition])</code></pre><p>The liquid-ice potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the result is the dry-air potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L927-L940">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.virtual_pottemp"><a class="docstring-binding" href="#Thermodynamics.virtual_pottemp"><code>Thermodynamics.virtual_pottemp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">virtual_pottemp(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The virtual potential temperature.</p><ul><li><code>param_set</code> thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li><li><code>q_liq</code> liquid specific humidity</li><li><code>q_ice</code> ice specific humidity</li></ul><p>If the specific humidities are not given, the result is for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L307-L320">source</a></section><section><div><pre><code class="language-julia hljs">virtual_pottemp(param_set, ts::ThermodynamicState)</code></pre><p>The virtual potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L214-L218">source</a></section><section><div><pre><code class="language-julia hljs">virtual_pottemp(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The virtual potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>The virtual potential temperature is defined as <code>θ_v = (R_m/R_d) * θ</code>, where <code>θ</code> is the potential temperature. It is the potential temperature a dry air parcel would need to have to have the same density as the moist air parcel at the same pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L1093-L1109">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.virtual_temperature"><a class="docstring-binding" href="#Thermodynamics.virtual_temperature"><code>Thermodynamics.virtual_temperature</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">virtual_temperature(param_set, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The virtual temperature.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>T_v</code>: virtual temperature [K]</li></ul><p>If the specific humidities are not given, the result is for dry air. The virtual temperature is defined such that dry air at <code>T_v</code> has the same density as moist air at <code>T</code>, i.e., <code>T_v = T (R_m / R_d)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_temperatures.jl#L276-L294">source</a></section><section><div><pre><code class="language-julia hljs">virtual_temperature(param_set, ts::ThermodynamicState)</code></pre><p>The virtual temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L202-L206">source</a></section><section><div><pre><code class="language-julia hljs">virtual_temperature(param_set, T, q::PhasePartition)</code></pre><p>The virtual temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>The virtual temperature is defined as <code>T_v = (R_m/R_d) * T</code>. It is the temperature a dry air parcel would need to have to have the same density as the moist air parcel at the same pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L1114-L1126">source</a></section></details></article><h3 id="Air-Pressure-and-Density"><a class="docs-heading-anchor" href="#Air-Pressure-and-Density">Air Pressure and Density</a><a id="Air-Pressure-and-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Pressure-and-Density" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.air_pressure"><a class="docstring-binding" href="#Thermodynamics.air_pressure"><code>Thermodynamics.air_pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_pressure(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The air pressure from the equation of state (ideal gas law).</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: air temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>p</code>: air pressure [Pa]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The formula is <code>p = ρ R_m T</code> where <code>R_m</code> is the gas constant of moist air (see <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_pressure_and_density.jl#L7-L25">source</a></section><section><div><pre><code class="language-julia hljs">air_pressure(param_set, ::DryAdiabaticProcess, T, T∞, p∞)</code></pre><p>The air pressure for an isentropic process.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: current temperature [K]</li><li><code>T∞</code>: reference temperature [K]</li><li><code>p∞</code>: reference pressure [Pa]</li></ul><p><strong>Returns</strong></p><ul><li><code>p</code>: air pressure [Pa]</li></ul><p>The pressure is computed using the isentropic relation: <code>p = p∞ * (T/T∞)^(1/κ_d)</code>, where <code>κ_d = R_d/cp_d</code> is the ratio of the gas constant to the isobaric specific heat constant of dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_dry_adiabatic.jl#L44-L61">source</a></section><section><div><pre><code class="language-julia hljs">air_pressure(param_set, ts::ThermodynamicState)</code></pre><p>The air pressure from the equation of state (ideal gas law).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L101-L105">source</a></section><section><div><pre><code class="language-julia hljs">air_pressure(param_set, T, ρ[, q::PhasePartition])</code></pre><p>The air pressure from the equation of state (ideal gas law).</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> air temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L376-L390">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.air_density"><a class="docstring-binding" href="#Thermodynamics.air_density"><code>Thermodynamics.air_density</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_density(param_set, T, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The (moist-)air density from the equation of state (ideal gas law).</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: air temperature [K]</li><li><code>p</code>: pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>ρ</code>: (moist-)air density [kg/m³]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The formula is <code>ρ = p / (R_m T)</code> where <code>R_m</code> is the gas constant of moist air (see <a href="#Thermodynamics.gas_constant_air"><code>gas_constant_air</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_pressure_and_density.jl#L37-L55">source</a></section><section><div><pre><code class="language-julia hljs">air_density(param_set, ts::ThermodynamicState)</code></pre><p>The (moist-)air density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L115-L119">source</a></section><section><div><pre><code class="language-julia hljs">air_density(param_set, T, p[, q::PhasePartition])</code></pre><p>The (moist-)air density from the equation of state (ideal gas law).</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> air temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L396-L410">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.exner"><a class="docstring-binding" href="#Thermodynamics.exner"><code>Thermodynamics.exner</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">exner(param_set, T, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The Exner function <code>Π = (p/p₀)^(R_m/cp_m)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>Π</code>: Exner function [dimensionless]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The pressure is computed internally from the equation of state (see <a href="#Thermodynamics.air_pressure"><code>air_pressure</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_pressure_and_density.jl#L67-L85">source</a></section><section><div><pre><code class="language-julia hljs">exner(param_set, ts::ThermodynamicState)</code></pre><p>The Exner function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L130-L134">source</a></section><section><div><pre><code class="language-julia hljs">exner(param_set, T, ρ[, q::PhasePartition)])</code></pre><p>The Exner function.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L416-L430">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.exner_given_pressure"><a class="docstring-binding" href="#Thermodynamics.exner_given_pressure"><code>Thermodynamics.exner_given_pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">exner_given_pressure(param_set, p, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The Exner function <code>Π = (p/p₀)^(R_m/cp_m)</code>, where <code>p₀</code> is the reference pressure.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code>: pressure [Pa]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>Π</code>: Exner function [dimensionless]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The reference pressure <code>p₀</code> is <code>p_ref_theta</code> from the parameter set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_pressure_and_density.jl#L91-L108">source</a></section><section><div><pre><code class="language-julia hljs">exner_given_pressure(param_set, p[, q::PhasePartition, cpm])</code></pre><p>The Exner function.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L435-L448">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.air_pressure_given_θ"><a class="docstring-binding" href="#Thermodynamics.air_pressure_given_θ"><code>Thermodynamics.air_pressure_given_θ</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_pressure_given_θ(param_set, ::DryAdiabaticProcess, θ, Φ)</code></pre><p>The air pressure for an isentropic process.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>θ</code>: potential temperature [K]</li><li><code>Φ</code>: gravitational potential [J/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>p</code>: air pressure [Pa]</li></ul><p>The pressure is computed using the hydrostatic balance and the definition of potential temperature for an isentropic process: <code>p = p₀ * (1 - Φ/(θ * cp_d))^(1/κ_d)</code>, where <code>p₀</code> is the reference pressure, <code>cp_d</code> is the isobaric specific heat capacity of dry air, and <code>κ_d = R_d/cp_d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_dry_adiabatic.jl#L14-L31">source</a></section></details></article><h3 id="Air-Saturation-Functions"><a class="docs-heading-anchor" href="#Air-Saturation-Functions">Air Saturation Functions</a><a id="Air-Saturation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Saturation-Functions" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.saturation_vapor_pressure"><a class="docstring-binding" href="#Thermodynamics.saturation_vapor_pressure"><code>Thermodynamics.saturation_vapor_pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(param_set, T, ::Liquid)
saturation_vapor_pressure(param_set, T, ::Ice)</code></pre><p>The saturation vapor pressure over a plane surface of condensate.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>Liquid()</code> or <code>Ice()</code> to dispatch over the condensate type</li></ul><p><strong>Returns</strong></p><ul><li><code>p_v^*</code>: saturation vapor pressure [Pa]</li></ul><p>The saturation vapor pressure is computed by integration of the Clausius-Clapeyron relation, assuming constant specific heat capacities in the so-called Rankine-Kirchhoff approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L94-L111">source</a></section><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(param_set, T)
saturation_vapor_pressure(param_set, T, q_liq, q_ice)</code></pre><p>The saturation vapor pressure over liquid, ice, or a mixture of liquid and ice.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>q_liq</code>: (optional) liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: (optional) ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>p_v^*</code>: saturation vapor pressure [Pa]</li></ul><p>If <code>q_liq</code> and <code>q_ice</code> are provided, the saturation vapor pressure is computed from a weighted mean of the latent heats of vaporization and sublimation, with the weights given by the liquid fraction (see <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a>). If <code>q_liq</code> and <code>q_ice</code> are 0, the saturation vapor pressure is that over liquid above freezing and over ice below freezing.</p><p>Otherwise, the liquid fraction below freezing is computed from a temperature dependent parameterization <code>liquid_fraction_ramp(param_set, T)</code>.</p><p>Edge case: the <code>saturation_vapor_pressure(param_set, T, q_liq, q_ice)</code> form includes a small smooth transition around freezing when <code>q_liq == q_ice == 0</code> (via <code>liquid_fraction(param_set, T, q_liq, q_ice)</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L164-L190">source</a></section><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(param_set, ts::ThermodynamicState, ::Liquid)</code></pre><p>The saturation vapor pressure over a plane surface of condensate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L476-L480">source</a></section><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(param_set, ts::ThermodynamicState, ::Ice)</code></pre><p>The saturation vapor pressure over a plane surface of condensate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L497-L501">source</a></section><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(param_set, T, q::PhasePartition)</code></pre><p>The saturation vapor pressure.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L663-L670">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.q_vap_saturation"><a class="docstring-binding" href="#Thermodynamics.q_vap_saturation"><code>Thermodynamics.q_vap_saturation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_vap_saturation(param_set, T, ρ)
q_vap_saturation(param_set, T, ρ, q_liq, q_ice)</code></pre><p>The saturation specific humidity.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: air density [kg/m³]</li><li>(optional) <code>q_liq</code>: liquid specific humidity [kg/kg]</li><li>(optional) <code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_v^*</code>: saturation specific humidity [kg/kg]</li></ul><p>If <code>q_liq</code> and <code>q_ice</code> are provided, the saturation specific humidity is that over a mixture of liquid and ice, computed in a thermodynamically consistent way from the weighted sum of the latent heats of the respective phase transitions. That is, the  saturation vapor pressure and from it the saturation specific humidity are computed  from a weighted mean of the latent heats of vaporization and sublimation, with the  weights given by the liquid fraction (see <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a>). If <code>q_liq</code> and  <code>q_ice</code> are 0, the saturation specific humidity is that over liquid above freezing and  over ice below freezing.</p><p>Otherwise, the fraction of liquid is given by the temperature dependent <code>liquid_fraction_ramp(param_set, T)</code>.</p><p><strong>Reference</strong></p><p>Pressel et al. (2015), &quot;Numerics and subgrid-scale modeling in large eddy simulations of stratocumulus clouds,&quot; <em>Journal of Advances in Modeling Earth Systems</em>, <strong>7</strong>(3), 1199-1220, doi:<a href="https://doi.org/10.1002/2014MS000376">10.1002/2014MS000376</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L228-L260">source</a></section><section><div><pre><code class="language-julia hljs">q_vap_saturation(param_set, T, ρ, phase::Phase)</code></pre><p>The saturation specific humidity.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>phase</code>: the phase to compute saturation over (either <code>Liquid()</code> or <code>Ice()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>q_v^*</code>: saturation specific humidity [kg/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L271-L284">source</a></section><section><div><pre><code class="language-julia hljs">q_vap_saturation(param_set, ts::ThermodynamicState)</code></pre><p>The saturation specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L518-L522">source</a></section><section><div><pre><code class="language-julia hljs">q_vap_saturation(param_set, T, ρ, q::PhasePartition)</code></pre><p>The saturation specific humidity.</p><ul><li><code>param_set</code>: an thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code>: temperature</li><li><code>ρ</code>: air density</li><li><code>q</code>: <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>If the <code>PhasePartition</code> <code>q</code> is given, the saturation specific humidity is that over a mixture of liquid and ice, computed in a thermodynamically consistent way from the weighted sum of the latent heats of the respective phase transitions (Pressel et al., JAMES, 2015).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L680-L694">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.supersaturation"><a class="docstring-binding" href="#Thermodynamics.supersaturation"><code>Thermodynamics.supersaturation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">supersaturation(param_set, q_vap, ρ, T[, phase::Phase = Liquid()])</code></pre><p>The supersaturation over water or ice.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>q_vap</code>: vapor specific humidity [kg/kg]</li><li><code>ρ</code>: air density [kg/m³]</li><li><code>T</code>: air temperature [K]</li><li><code>phase</code>: (optional) liquid or ice phase to dispatch over (default: <code>Liquid()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>S</code>: supersaturation [dimensionless], defined as <code>p_v/p_v^* - 1</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L374-L388">source</a></section><section><div><pre><code class="language-julia hljs">supersaturation(param_set, q_vap, ρ, T, p_v_sat)</code></pre><p>The supersaturation given the saturation vapor pressure.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>q_vap</code>: vapor specific humidity [kg/kg]</li><li><code>ρ</code>: air density [kg/m³]</li><li><code>T</code>: temperature [K]</li><li><code>p_v_sat</code>: saturation vapor pressure [Pa]</li></ul><p><strong>Returns</strong></p><ul><li><code>S</code>: supersaturation [dimensionless], defined as <code>p_v/p_v_sat - 1</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L401-L415">source</a></section><section><div><pre><code class="language-julia hljs">supersaturation(param_set::APS, ts::ThermodynamicState, phase::Phase)</code></pre><p>The supersaturation (pv/pv_sat -1) over water or ice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L565-L569">source</a></section><section><div><pre><code class="language-julia hljs">supersaturation(param_set, q, ρ, T, Liquid())
supersaturation(param_set, q, ρ, T, Ice())</code></pre><p>The supersaturation (pv/pv_sat -1) over water or ice.</p><ul><li><code>param_set</code> - abstract set with earth parameters</li><li><code>q</code> - phase partition</li><li><code>ρ</code> - air density,</li><li><code>T</code> - air temperature</li><li><code>Liquid()</code>, <code>Ice()</code> - liquid or ice phase to dispatch over.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L699-L709">source</a></section><section><div><pre><code class="language-julia hljs">supersaturation(param_set, q::PhasePartition, ρ, T, p_v_sat)</code></pre><p>The supersaturation (pv/pv<em>sat - 1) given the saturation vapor pressure `p</em>v_sat`:</p><ul><li><code>param_set</code>: Thermodynamic parameter set</li><li><code>q</code>: Phase partition</li><li><code>ρ</code>: Air density</li><li><code>T</code>: Temperature</li><li><code>p_v_sat</code>: Saturation vapor pressure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L724-L735">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.saturation_excess"><a class="docstring-binding" href="#Thermodynamics.saturation_excess"><code>Thermodynamics.saturation_excess</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">saturation_excess(param_set, T, ρ, q_tot)
saturation_excess(param_set, T, ρ, q_tot, q_liq, q_ice)</code></pre><p>The saturation excess in equilibrium.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li>(optional) <code>q_liq</code>: liquid specific humidity [kg/kg]</li><li>(optional) <code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_ex</code>: saturation excess [kg/kg]</li></ul><p>The saturation excess is the difference between the total specific humidity <code>q_tot</code> and the saturation specific humidity in equilibrium, and it is defined to be nonzero only if this difference is positive: <code>q_ex = max(0, q_tot - q_v^*)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L422-L442">source</a></section><section><div><pre><code class="language-julia hljs">saturation_excess(param_set, T, ρ, q_tot, p_vap_sat)</code></pre><p>The saturation excess given the saturation vapor pressure.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: temperature [K]</li><li><code>ρ</code>: air density [kg/m³]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>p_vap_sat</code>: saturation vapor pressure [Pa]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_ex</code>: saturation excess [kg/kg]</li></ul><p>The saturation excess is the difference between the total specific humidity <code>q_tot</code> and the saturation specific humidity, and it is defined to be nonzero only if this difference is positive: <code>q_ex = max(0, q_tot - q_v^*)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L453-L471">source</a></section><section><div><pre><code class="language-julia hljs">saturation_excess(param_set, ts::ThermodynamicState)</code></pre><p>The saturation excess in equilibrium.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L551-L555">source</a></section><section><div><pre><code class="language-julia hljs">saturation_excess(param_set, T, ρ, phase_type, q::PhasePartition)</code></pre><p>The saturation excess in equilibrium.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>The saturation excess is the difference between the total specific humidity <code>q.tot</code> and the saturation specific humidity in equilibrium, and it is defined to be nonzero only if this difference is positive.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L748-L762">source</a></section><section><div><pre><code class="language-julia hljs">saturation_excess(param_set, T, ρ, p_vap_sat, q::PhasePartition)</code></pre><p>The saturation excess given the saturation vapor pressure <code>p_vap_sat</code>:</p><ul><li><code>param_set</code>: Thermodynamic parameter set</li><li><code>T</code>: Temperature</li><li><code>ρ</code>: Air density</li><li><code>p_vap_sat</code>: Saturation vapor pressure</li><li><code>q</code>: Phase partition</li></ul><p>The saturation excess is the difference between the total specific humidity <code>q.tot</code> and the saturation specific humidity, and it is defined to be nonzero only if this difference is positive.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L775-L789">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.q_vap_from_RH"><a class="docstring-binding" href="#Thermodynamics.q_vap_from_RH"><code>Thermodynamics.q_vap_from_RH</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_vap_from_RH(param_set, p, T, RH, phase)</code></pre><p>Compute the vapor specific humidity from the relative humidity.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: pressure [Pa]</li><li><code>T</code>: temperature [K]</li><li><code>RH</code>: relative humidity [dimensionless], 0 ≤ RH ≤ 1</li><li><code>phase</code>: the phase to compute saturation over (either <code>Liquid()</code> or <code>Ice()</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>q_vap</code>: vapor specific humidity [kg/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L174-L188">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.q_vap_from_p_vap"><a class="docstring-binding" href="#Thermodynamics.q_vap_from_p_vap"><code>Thermodynamics.q_vap_from_p_vap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_vap_from_p_vap(param_set, T, ρ, p_v)</code></pre><p>Compute the vapor specific humidity from the vapor partial pressure.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>T</code>: air temperature [K]</li><li><code>ρ</code>: (moist-)air density [kg/m³]</li><li><code>p_v</code>: partial pressure of water vapor [Pa]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_vap</code>: vapor specific humidity [kg/kg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L155-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.q_vap_saturation_from_pressure"><a class="docstring-binding" href="#Thermodynamics.q_vap_saturation_from_pressure"><code>Thermodynamics.q_vap_saturation_from_pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_vap_saturation_from_pressure(param_set, q_tot, p, T)
q_vap_saturation_from_pressure(param_set, q_tot, p, T, q_liq, q_ice)</code></pre><p>The saturation specific humidity.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>q_tot</code>: total water specific humidity [kg/kg]</li><li><code>p</code>: air pressure [Pa]</li><li><code>T</code>: air temperature [K]</li><li>(optional) <code>q_liq</code>: liquid specific humidity [kg/kg]</li><li>(optional) <code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>q_v^*</code>: saturation specific humidity [kg/kg]</li></ul><p>If <code>q_liq</code> and <code>q_ice</code> are provided, the saturation vapor pressure is computed from a weighted mean of the latent heats of vaporization and sublimation, with the weights given by the liquid fraction (see <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a>). If <code>q_liq</code> and <code>q_ice</code> are 0, the saturation vapor pressure is that over liquid above freezing and over ice below freezing.</p><p>Otherwise, the liquid fraction is computed from a temperature dependent parameterization <code>liquid_fraction_ramp(param_set, T)</code>.</p><p>The saturation specific humidity is computed as: <span>$q_v^* = (R_d / R_v) * (1 - q_{tot}) * p_v^* / (p - p_v^*)$</span> where <code>p_v^*</code> is the saturation vapor pressure.</p><p>Edge case: this expression assumes <code>p &gt; p_v^*(T)</code>; if <code>p ≤ p_v^*(T)</code> the denominator changes sign.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_saturation_functions.jl#L290-L321">source</a></section></details></article><h3 id="Saturation-Adjustment"><a class="docs-heading-anchor" href="#Saturation-Adjustment">Saturation Adjustment</a><a id="Saturation-Adjustment-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-Adjustment" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.saturation_adjustment"><a class="docstring-binding" href="#Thermodynamics.saturation_adjustment"><code>Thermodynamics.saturation_adjustment</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    ::Type{M},  # RS.RootSolvingMethod type
    param_set,
    ::ρe,
    ρ::Real,
    e_int::Real,
    q_tot::Real,
    maxiter::Int,
    tol,
    [T_guess::Union{Nothing, Real} = nothing],
    [forced_fixed_iters::Bool = false]
)</code></pre><p>Compute the saturation equilibrium temperature <code>T</code> and phase partition <code>(q_liq, q_ice)</code> given density <code>ρ</code>, internal energy <code>e_int</code>, and total specific humidity <code>q_tot</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M</code>: Root-solving method type from RS.jl. Use <code>RS.NewtonsMethod</code>, <code>RS.SecantMethod</code>, <code>RS.BrentsMethod</code>, or <code>RS.NewtonsMethodAD</code>.</li><li><code>param_set</code>: Thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a>.</li><li><code>ρ</code>: Density of moist air [kg/m³].</li><li><code>e_int</code>: Specific internal energy [J/kg].</li><li><code>q_tot</code>: Total specific humidity [kg/kg].</li><li><code>maxiter</code>: Maximum iterations for the solver [dimensionless integer].</li><li><code>tol</code>: Relative tolerance for the temperature solution (or a <code>RS.RelativeSolutionTolerance</code>).</li><li><code>T_guess</code>: Optional initial guess for the temperature [K]. Defaults to <code>nothing</code>.</li><li><code>forced_fixed_iters</code>: Optional boolean to force a fixed number of iterations (<code>maxiter</code>) without checking for convergence. Useful for GPU optimization to avoid branch divergence. When <code>true</code>, <code>T_guess</code> and <code>tol</code> are ignored. Defaults to <code>false</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>:<ul><li><code>T</code>: Temperature [K]</li><li><code>q_liq</code>: Liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: Ice specific humidity [kg/kg]</li><li><code>converged</code>: Boolean flag indicating if the solver converged</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>This function solves for <code>T</code> such that <code>e_int = internal_energy_sat(param_set, T, ρ, q_tot)</code> using root-finding, then computes <code>(q_liq, q_ice)</code> from <a href="#Thermodynamics.condensate_partition"><code>condensate_partition</code></a>.</li><li>For <code>ρe</code> formulation, <code>NewtonsMethod</code> is recommended (fast + analytic derivative available).</li><li>For other formulations, <code>SecantMethod</code> or <code>BrentsMethod</code> are recommended.</li><li><strong>GPU broadcasting</strong>: Pass <code>forced_fixed_iters</code> as a positional Bool.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/saturation_adjustment.jl#L7-L51">source</a></section><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    ::Type{M},  # RS.RootSolvingMethod type
    param_set,
    ::pe,
    p::Real,
    e_int::Real,
    q_tot::Real,
    maxiter::Int,
    tol,
    [T_guess::Union{Nothing, Real}]
)</code></pre><p>Compute the saturation equilibrium temperature <code>T</code> and phase partition <code>(q_liq, q_ice)</code> given pressure <code>p</code>, specific internal energy <code>e_int</code>, and total specific humidity <code>q_tot</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M</code>: Root-solving method type from <code>RootSolvers.jl</code>. Supported types: <code>RS.SecantMethod</code>, <code>RS.BrentsMethod</code>, <code>RS.NewtonsMethod</code>, <code>RS.NewtonsMethodAD</code>.</li><li><code>param_set</code>: Thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a>.</li><li><code>p</code>: Pressure of moist air [Pa].</li><li><code>e_int</code>: Specific internal energy [J/kg].</li><li><code>q_tot</code>: Total specific humidity [kg/kg].</li><li><code>maxiter</code>: Maximum iterations for the solver [dimensionless integer].</li><li><code>tol</code>: Relative tolerance for the temperature solution (or a <code>RS.RelativeSolutionTolerance</code>).</li><li><code>T_guess</code>: Optional initial guess for the temperature [K].</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>:<ul><li><code>T</code>: Temperature [K]</li><li><code>q_liq</code>: Liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: Ice specific humidity [kg/kg]</li><li><code>converged</code>: Boolean flag indicating if the solver converged</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/saturation_adjustment.jl#L246-L279">source</a></section><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    ::Type{M},  # RS.RootSolvingMethod type
    param_set,
    ::ph,
    p::Real,
    h::Real,
    q_tot::Real,
    maxiter::Int,
    tol,
    [T_guess::Union{Nothing, Real}]
)</code></pre><p>Compute the saturation equilibrium temperature <code>T</code> and phase partition <code>(q_liq, q_ice)</code> given pressure <code>p</code>, specific enthalpy <code>h</code>, and total specific humidity <code>q_tot</code>.</p><p>Returns a <code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M</code>: Root-solving method type from <code>RootSolvers.jl</code>. Supported types: <code>RS.SecantMethod</code>, <code>RS.BrentsMethod</code>, <code>RS.NewtonsMethod</code>, <code>RS.NewtonsMethodAD</code>.</li><li><code>param_set</code>: Thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a>.</li><li><code>p</code>: Pressure of moist air [Pa].</li><li><code>h</code>: Specific enthalpy [J/kg].</li><li><code>q_tot</code>: Total specific humidity [kg/kg].</li><li><code>maxiter</code>: Maximum iterations for the solver [dimensionless integer].</li><li><code>tol</code>: Relative tolerance for the temperature solution (or a <code>RS.RelativeSolutionTolerance</code>).</li><li><code>T_guess</code>: Optional initial guess for the temperature [K].</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>:<ul><li><code>T</code>: Temperature [K]</li><li><code>q_liq</code>: Liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: Ice specific humidity [kg/kg]</li><li><code>converged</code>: Boolean flag indicating if the solver converged</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/saturation_adjustment.jl#L326-L361">source</a></section><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    ::Type{M},  # RS.RootSolvingMethod type
    param_set,
    ::pθ_li,
    p::Real,
    θ_li::Real,
    q_tot::Real,
    maxiter::Int,
    tol,
    [T_guess::Union{Nothing, Real}]
)</code></pre><p>Compute the saturation equilibrium temperature <code>T</code> and phase partition <code>(q_liq, q_ice)</code> given pressure <code>p</code>, liquid-ice potential temperature <code>θ_li</code>, and total specific humidity <code>q_tot</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M</code>: Root-solving method type from <code>RootSolvers.jl</code>. Supported types: <code>RS.SecantMethod</code>, <code>RS.BrentsMethod</code>, <code>RS.NewtonsMethod</code>, <code>RS.NewtonsMethodAD</code>.</li><li><code>param_set</code>: Thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a>.</li><li><code>p</code>: Pressure of moist air [Pa].</li><li><code>θ_li</code>: Liquid-ice potential temperature [K].</li><li><code>q_tot</code>: Total specific humidity [kg/kg].</li><li><code>maxiter</code>: Maximum iterations for the solver [dimensionless integer].</li><li><code>tol</code>: Relative tolerance for the temperature solution (or a <code>RS.RelativeSolutionTolerance</code>).</li><li><code>T_guess</code>: Optional initial guess for the temperature [K].</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>:<ul><li><code>T</code>: Temperature [K]</li><li><code>q_liq</code>: Liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: Ice specific humidity [kg/kg]</li><li><code>converged</code>: Boolean flag indicating if the solver converged</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/saturation_adjustment.jl#L409-L442">source</a></section><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    ::Type{M},  # RS.RootSolvingMethod type
    param_set,
    ::ρθ_li,
    ρ::Real,
    θ_li::Real,
    q_tot::Real,
    maxiter::Int,
    tol,
    [T_guess::Union{Nothing, Real}]
)</code></pre><p>Compute the saturation equilibrium temperature <code>T</code> and phase partition <code>(q_liq, q_ice)</code> given density <code>ρ</code>, liquid-ice potential temperature <code>θ_li</code>, and total specific humidity <code>q_tot</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M</code>: Root-solving method type from <code>RootSolvers.jl</code>. Supported types: <code>RS.SecantMethod</code>, <code>RS.BrentsMethod</code>, <code>RS.NewtonsMethod</code>, <code>RS.NewtonsMethodAD</code>.</li><li><code>param_set</code>: Thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a>.</li><li><code>ρ</code>: Density of moist air [kg/m³].</li><li><code>θ_li</code>: Liquid-ice potential temperature [K].</li><li><code>q_tot</code>: Total specific humidity [kg/kg].</li><li><code>maxiter</code>: Maximum iterations for the solver [dimensionless integer].</li><li><code>tol</code>: Relative tolerance for the temperature solution (or a <code>RS.RelativeSolutionTolerance</code>).</li><li><code>T_guess</code>: Optional initial guess for the temperature [K].</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>:<ul><li><code>T</code>: Temperature [K]</li><li><code>q_liq</code>: Liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: Ice specific humidity [kg/kg]</li><li><code>converged</code>: Boolean flag indicating if the solver converged</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/saturation_adjustment.jl#L502-L535">source</a></section><section><div><pre><code class="language-julia hljs">saturation_adjustment(
    ::Type{M},  # RS.RootSolvingMethod type
    param_set,
    ::pρ,
    p::Real,
    ρ::Real,
    q_tot::Real,
    maxiter::Int,
    tol,
    [T_guess::Union{Nothing, Real}]
)</code></pre><p>Compute the saturation equilibrium temperature <code>T</code> and phase partition <code>(q_liq, q_ice)</code> given pressure <code>p</code>, density <code>ρ</code>, and total specific humidity <code>q_tot</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M</code>: Root-solving method type from <code>RootSolvers.jl</code>. Supported types: <code>RS.SecantMethod</code>, <code>RS.BrentsMethod</code>, <code>RS.NewtonsMethod</code>, <code>RS.NewtonsMethodAD</code>.</li><li><code>param_set</code>: Thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a>.</li><li><code>p</code>: Pressure of moist air [Pa].</li><li><code>ρ</code>: Density of moist air [kg/m³].</li><li><code>q_tot</code>: Total specific humidity [kg/kg].</li><li><code>maxiter</code>: Maximum iterations for the solver [dimensionless integer].</li><li><code>tol</code>: Relative tolerance for the temperature solution (or a <code>RS.RelativeSolutionTolerance</code>).</li><li><code>T_guess</code>: Optional initial guess for the temperature [K].</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> <code>(; T, q_liq, q_ice, converged)</code>:<ul><li><code>T</code>: Temperature [K]</li><li><code>q_liq</code>: Liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: Ice specific humidity [kg/kg]</li><li><code>converged</code>: Boolean flag indicating if the solver converged</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/saturation_adjustment.jl#L592-L625">source</a></section><section><div><pre><code class="language-julia hljs">saturation_adjustment(args...)</code></pre><p>Legacy wrapper for <code>saturation_adjustment</code> with <code>phase_type</code> argument. Forwards to <code>saturation_adjustment(..., ::ρeq, ...)</code> with arguments <code>(ρ, e_int)</code> swapped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_saturation_adjustment.jl#L82-L87">source</a></section></details></article><h3 id="Air-Entropies"><a class="docs-heading-anchor" href="#Air-Entropies">Air Entropies</a><a id="Air-Entropies-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Entropies" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.entropy"><a class="docstring-binding" href="#Thermodynamics.entropy"><code>Thermodynamics.entropy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">entropy(param_set, p, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The specific entropy in thermodynamic equilibrium.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: pressure [Pa]</li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s</code>: specific entropy [J/(kg·K)]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), this reduces to the dry-air expression. The entropy is computed as a mass-weighted sum of the entropies of each component (dry air, vapor, liquid, ice).</p><p><strong>Reference</strong></p><p>Pressel et al. (2015), &quot;Numerics and subgrid-scale modeling in large eddy simulations of stratocumulus clouds,&quot; <em>Journal of Advances in Modeling Earth Systems</em>, <strong>7</strong>(3), 1199-1220, doi:<a href="https://doi.org/10.1002/2015MS000496">10.1002/2015MS000496</a>. (Their Eqs. (29)-(33))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_entropies.jl#L7-L30">source</a></section><section><div><pre><code class="language-julia hljs">entropy(param_set, ts)</code></pre><p>The specific entropy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L155-L159">source</a></section><section><div><pre><code class="language-julia hljs">entropy(param_set, p, T, q::PhasePartition)</code></pre><p>The specific entropy.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul><p>The specific entropy is computed from equations (29)-(33) of [<a href="../References/#Pressel2015">7</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L614-L625">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.entropy_dry"><a class="docstring-binding" href="#Thermodynamics.entropy_dry"><code>Thermodynamics.entropy_dry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">entropy_dry(param_set, p, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The specific entropy of dry air at its partial pressure.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: total air pressure [Pa]</li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s_d</code>: specific entropy of dry air [J/(kg·K)]</li></ul><p>In the dry limit (<code>q_tot = q_liq = q_ice = 0</code>, the default), the dry-air partial pressure equals the total pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_entropies.jl#L39-L56">source</a></section><section><div><pre><code class="language-julia hljs">entropy_dry(param_set, p, T, q::PhasePartition)</code></pre><p>The dry air specific entropy.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L630-L639">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.entropy_vapor"><a class="docstring-binding" href="#Thermodynamics.entropy_vapor"><code>Thermodynamics.entropy_vapor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">entropy_vapor(param_set, p, T, q_tot=0, q_liq=0, q_ice=0)</code></pre><p>The specific entropy of water vapor at its partial pressure.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: total air pressure [Pa]</li><li><code>T</code>: temperature [K]</li><li><code>q_tot</code>: total specific humidity [kg/kg]</li><li><code>q_liq</code>: liquid specific humidity [kg/kg]</li><li><code>q_ice</code>: ice specific humidity [kg/kg]</li></ul><p><strong>Returns</strong></p><ul><li><code>s_v</code>: specific entropy of water vapor [J/(kg·K)]</li></ul><p>Note: the entropy of water vapor diverges logarithmically as <code>q_tot → 0</code> (since <code>p_v → 0</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_entropies.jl#L75-L92">source</a></section><section><div><pre><code class="language-julia hljs">entropy_vapor(param_set, p, T, q::PhasePartition)</code></pre><p>The specific entropy of water vapor.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L644-L653">source</a></section></details></article><h2 id="Temperature-Profiles"><a class="docs-heading-anchor" href="#Temperature-Profiles">Temperature Profiles</a><a id="Temperature-Profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Temperature-Profiles" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thermodynamics.TemperatureProfiles.TemperatureProfile"><a class="docstring-binding" href="#Thermodynamics.TemperatureProfiles.TemperatureProfile"><code>Thermodynamics.TemperatureProfiles.TemperatureProfile</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TemperatureProfile</code></pre><p>Abstract type for temperature or virtual temperature reference profiles  that can be used in atmosphere models.</p><p>Instances of this type are required to be callable objects with the  following signature</p><pre><code class="nohighlight hljs">T,p = (::TemperatureProfile)(param_set::APS, z::FT) where {FT}</code></pre><p>where <code>T</code> is the temperature or virtual temperature (K), and <code>p</code> is  the pressure (Pa).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/TemperatureProfiles.jl#L10-L23">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile"><a class="docstring-binding" href="#Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile"><code>Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DecayingTemperatureProfile{FT} &lt;: TemperatureProfile{FT}</code></pre><p>Virtual temperature profile that decays smoothly with height <code>z</code> from <code>T_virt_surf</code> to <code>T_min_ref</code> over height scale <code>H_t</code> (default: density scale height with <code>T_virt_surf</code>).</p><p class="math-container">\[T_{\text{v}}(z) = \max(T_{\text{v, sfc}} − (T_{\text{v, sfc}} - T_{\text{v, min}}) \tanh(z/H_{\text{t}}), T_{\text{v, min}})\]</p><p><strong>Fields</strong></p><ul><li><code>T_virt_surf</code>: Virtual temperature at surface (K)</li><li><code>T_min_ref</code>: Minimum virtual temperature at the top of the atmosphere (K)</li><li><code>H_t</code>: Height scale over which virtual temperature drops (m)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/TemperatureProfiles.jl#L92-L107">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.TemperatureProfiles.IsothermalProfile"><a class="docstring-binding" href="#Thermodynamics.TemperatureProfiles.IsothermalProfile"><code>Thermodynamics.TemperatureProfiles.IsothermalProfile</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">IsothermalProfile(param_set, T_virt)
IsothermalProfile(param_set, ::Type{FT&lt;:Real})</code></pre><p>Uniform virtual temperature profile implemented as a special case  of <a href="#Thermodynamics.TemperatureProfiles.DecayingTemperatureProfile"><code>DecayingTemperatureProfile</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/TemperatureProfiles.jl#L26-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.TemperatureProfiles.DryAdiabaticProfile"><a class="docstring-binding" href="#Thermodynamics.TemperatureProfiles.DryAdiabaticProfile"><code>Thermodynamics.TemperatureProfiles.DryAdiabaticProfile</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DryAdiabaticProfile{FT} &lt;: TemperatureProfile{FT}</code></pre><p>Temperature profile with uniform potential temperature <code>θ</code> up to  the height where a minimum temperature is reached.</p><p><strong>Fields</strong></p><ul><li><code>T_surface</code>: Surface temperature (K)</li><li><code>T_min_ref</code>: Minimum temperature (K)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/TemperatureProfiles.jl#L41-L51">source</a></section></details></article><h2 id="Data-Collection"><a class="docs-heading-anchor" href="#Data-Collection">Data Collection</a><a id="Data-Collection-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Collection" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thermodynamics.DataCollection"><a class="docstring-binding" href="#Thermodynamics.DataCollection"><code>Thermodynamics.DataCollection</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">DataCollection</code></pre><p>This module is designed to help judge the accuracy and performance for a particular formulation, tolerance, and or solver configuration, by providing tools to collect various statistics when <code>saturation_adjustment</code> is called.</p><p><strong>Example:</strong></p><pre><code class="nohighlight hljs">import Thermodynamics as TD
import RootSolvers as RS

function do_work()
    # Calls TD.saturation_adjustment()..., possibly many times
end

TD.solution_type() = RS.VerboseSolution()
do_work()
TD.DataCollection.print_summary()</code></pre><div class="admonition is-category-warn" id="Warn-e6f2f3c054aba8c7"><header class="admonition-header">Warn<a class="admonition-anchor" href="#Warn-e6f2f3c054aba8c7" title="Permalink"></a></header><div class="admonition-body"><p>This data collection was designed for unthreaded single processor runs, and may not work correctly for threaded / multi-processor runs.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/DataCollection.jl#L1-L25">source</a></section></details></article><h2 id="Deprecated-Functions"><a class="docs-heading-anchor" href="#Deprecated-Functions">Deprecated Functions</a><a id="Deprecated-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Deprecated-Functions" title="Permalink"></a></h2><p>These functions are deprecated and will be removed in a future release.</p><h3 id="Backward-Compatibility-Wrappers"><a class="docs-heading-anchor" href="#Backward-Compatibility-Wrappers">Backward Compatibility Wrappers</a><a id="Backward-Compatibility-Wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#Backward-Compatibility-Wrappers" title="Permalink"></a></h3><p>These wrappers exist for backward compatibility with older versions of the package.</p><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_enthalpy"><a class="docstring-binding" href="#Thermodynamics.specific_enthalpy"><code>Thermodynamics.specific_enthalpy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_enthalpy(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.enthalpy"><code>enthalpy</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L678-L682">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_enthalpy_dry"><a class="docstring-binding" href="#Thermodynamics.specific_enthalpy_dry"><code>Thermodynamics.specific_enthalpy_dry</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_enthalpy_dry(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.enthalpy_dry"><code>enthalpy_dry</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L685-L689">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_enthalpy_vapor"><a class="docstring-binding" href="#Thermodynamics.specific_enthalpy_vapor"><code>Thermodynamics.specific_enthalpy_vapor</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_enthalpy_vapor(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.enthalpy_vapor"><code>enthalpy_vapor</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L692-L696">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_enthalpy_liquid"><a class="docstring-binding" href="#Thermodynamics.specific_enthalpy_liquid"><code>Thermodynamics.specific_enthalpy_liquid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_enthalpy_liquid(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.enthalpy_liquid"><code>enthalpy_liquid</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L699-L703">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_enthalpy_ice"><a class="docstring-binding" href="#Thermodynamics.specific_enthalpy_ice"><code>Thermodynamics.specific_enthalpy_ice</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_enthalpy_ice(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.enthalpy_ice"><code>enthalpy_ice</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L706-L710">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.dry_pottemp"><a class="docstring-binding" href="#Thermodynamics.dry_pottemp"><code>Thermodynamics.dry_pottemp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">dry_pottemp(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.potential_temperature"><code>potential_temperature</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L714-L718">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.total_specific_enthalpy"><a class="docstring-binding" href="#Thermodynamics.total_specific_enthalpy"><code>Thermodynamics.total_specific_enthalpy</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_specific_enthalpy(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.total_enthalpy"><code>total_enthalpy</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L722-L726">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.q_vap_saturation_generic"><a class="docstring-binding" href="#Thermodynamics.q_vap_saturation_generic"><code>Thermodynamics.q_vap_saturation_generic</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_vap_saturation_generic(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.q_vap_saturation"><code>q_vap_saturation</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L730-L734">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.latent_heat_liq_ice"><a class="docstring-binding" href="#Thermodynamics.latent_heat_liq_ice"><code>Thermodynamics.latent_heat_liq_ice</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">latent_heat_liq_ice(args...)</code></pre><p>Deprecated: Use <a href="#Thermodynamics.humidity_weighted_latent_heat"><code>humidity_weighted_latent_heat</code></a> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L738-L742">source</a></section></details></article><h3 id="Other-Deprecated-Functions"><a class="docs-heading-anchor" href="#Other-Deprecated-Functions">Other Deprecated Functions</a><a id="Other-Deprecated-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Deprecated-Functions" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Thermodynamics.air_temperature_given_hq"><a class="docstring-binding" href="#Thermodynamics.air_temperature_given_hq"><code>Thermodynamics.air_temperature_given_hq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_temperature_given_hq(param_set, h, q_tot=0, q_liq=0, q_ice=0)</code></pre><div class="admonition is-category-warn" id="Deprecated-14b6407936e43853"><header class="admonition-header">Deprecated<a class="admonition-anchor" href="#Deprecated-14b6407936e43853" title="Permalink"></a></header><div class="admonition-body"><p>This function is deprecated and will be removed in a future release. Please use <a href="#Thermodynamics.air_temperature"><code>air_temperature</code></a> with the <a href="#Thermodynamics.ph"><code>ph</code></a> type instead.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_temperatures.jl#L6-L12">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature_given_hq(param_set, h[, q::PhasePartition]s)</code></pre><p>The air temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>h</code> specific enthalpy of moist air</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L822-L835">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.air_temperature_given_pρq"><a class="docstring-binding" href="#Thermodynamics.air_temperature_given_pρq"><code>Thermodynamics.air_temperature_given_pρq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_temperature_given_pρq(param_set, p, ρ, q_tot=0, q_liq=0, q_ice=0)</code></pre><div class="admonition is-category-warn" id="Deprecated-d3473ec920d9354f"><header class="admonition-header">Deprecated<a class="admonition-anchor" href="#Deprecated-d3473ec920d9354f" title="Permalink"></a></header><div class="admonition-body"><p>This function is deprecated and will be removed in a future release. Please use <a href="#Thermodynamics.air_temperature"><code>air_temperature</code></a> with the <a href="#Thermodynamics.pρ"><code>pρ</code></a> type instead.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_temperatures.jl#L23-L29">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature_given_pρq(param_set, p, ρ[, q::PhasePartition])</code></pre><p>The air temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> air pressure</li><li><code>ρ</code> air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L840-L854">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.air_temperature_given_pθq"><a class="docstring-binding" href="#Thermodynamics.air_temperature_given_pθq"><code>Thermodynamics.air_temperature_given_pθq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_temperature_given_pθq(param_set, p, θ_li, q_tot=0, q_liq=0, q_ice=0)</code></pre><div class="admonition is-category-warn" id="Deprecated-64431f27e0563bad"><header class="admonition-header">Deprecated<a class="admonition-anchor" href="#Deprecated-64431f27e0563bad" title="Permalink"></a></header><div class="admonition-body"><p>This function is deprecated and will be removed in a future release. Please use <a href="#Thermodynamics.air_temperature"><code>air_temperature</code></a> with the <a href="#Thermodynamics.pθ_li"><code>pθ_li</code></a> type instead.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_temperatures.jl#L41-L47">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature_given_pθq(
    param_set,
    p,
    θ_li,
    [q::PhasePartition]
)</code></pre><p>The air temperature obtained by inverting the liquid-ice potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>θ_li</code> liquid-ice potential temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the <code>θ_li</code> is assumed to be the dry-air potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L976-L994">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.air_temperature_given_ρθq"><a class="docstring-binding" href="#Thermodynamics.air_temperature_given_ρθq"><code>Thermodynamics.air_temperature_given_ρθq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_temperature_given_ρθq(param_set, ρ, θ_li, q_tot=0, q_liq=0, q_ice=0)</code></pre><div class="admonition is-category-warn" id="Deprecated-98244095c56d6e3f"><header class="admonition-header">Deprecated<a class="admonition-anchor" href="#Deprecated-98244095c56d6e3f" title="Permalink"></a></header><div class="admonition-body"><p>This function is deprecated and will be removed in a future release. Please use <a href="#Thermodynamics.air_temperature"><code>air_temperature</code></a> with the <a href="#Thermodynamics.ρθ_li"><code>ρθ_li</code></a> type instead.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_temperatures.jl#L67-L73">source</a></section><section><div><pre><code class="language-julia hljs">air_temperature_given_ρθq(param_set, ρ, θ_li[, q::PhasePartition])</code></pre><p>The air temperature obtained by inverting the liquid-ice potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>θ_li</code> liquid-ice potential temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the results are for dry air.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L1011-L1025">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.air_temperature_given_ρθq_nonlinear"><a class="docstring-binding" href="#Thermodynamics.air_temperature_given_ρθq_nonlinear"><code>Thermodynamics.air_temperature_given_ρθq_nonlinear</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">air_temperature_given_ρθq_nonlinear(param_set, ρ, θ_li, maxiter, tol, q::PhasePartition)</code></pre><p>Computes temperature <code>T</code>.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>θ_li</code> liquid-ice potential temperature</li></ul><p>and, optionally,</p><ul><li><code>maxiter</code> maximum iterations for non-linear equation solve</li><li><code>tol</code> absolute tolerance for non-linear equation iterations. Can be one of:<ul><li><code>RelativeSolutionTolerance()</code> to stop when <code>|x_2 - x_1|/x_1 &lt; tol</code></li><li><code>ResidualTolerance()</code> to stop when <code>|f(x)| &lt; tol</code></li></ul></li><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>.When <code>q</code> is not provided, the results are for dry air,</li></ul><p>The temperature <code>T</code> is found by finding the root of <code>T - air_temperature_given_pθq(param_set,                                air_pressure(param_set, T, ρ, q),                                θ_li,                                q) = 0</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L1132-L1153">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.saturated"><a class="docstring-binding" href="#Thermodynamics.saturated"><code>Thermodynamics.saturated</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">saturated(param_set, ts::ThermodynamicState)</code></pre><p>Checks if the thermodynamic state <code>ts</code> is saturated or supersaturated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L579-L583">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.total_specific_humidity"><a class="docstring-binding" href="#Thermodynamics.total_specific_humidity"><code>Thermodynamics.total_specific_humidity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">total_specific_humidity(param_set, ts::ThermodynamicState)</code></pre><p>The total specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L348-L352">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.liquid_specific_humidity"><a class="docstring-binding" href="#Thermodynamics.liquid_specific_humidity"><code>Thermodynamics.liquid_specific_humidity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">liquid_specific_humidity(param_set, ts::ThermodynamicState)</code></pre><p>The liquid specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L362-L366">source</a></section><section><div><pre><code class="language-julia hljs">liquid_specific_humidity(q::PhasePartition)</code></pre><p>The liquid specific humidity.</p><ul><li><code>q</code> a <code>PhasePartition</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L176-L182">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.ice_specific_humidity"><a class="docstring-binding" href="#Thermodynamics.ice_specific_humidity"><code>Thermodynamics.ice_specific_humidity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ice_specific_humidity(param_set, ts::ThermodynamicState)</code></pre><p>The ice specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L376-L380">source</a></section><section><div><pre><code class="language-julia hljs">ice_specific_humidity(q::PhasePartition)</code></pre><p>The ice specific humidity.</p><ul><li><code>q</code> a <code>PhasePartition</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L185-L191">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.mixing_ratios"><a class="docstring-binding" href="#Thermodynamics.mixing_ratios"><code>Thermodynamics.mixing_ratios</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mixing_ratios(param_set, ts::ThermodynamicState)</code></pre><p>The mixing ratios, stored in a <code>PhasePartition</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L398-L402">source</a></section><section><div><pre><code class="language-julia hljs">mixing_ratios(q::PhasePartition)</code></pre><p>The mixing ratios returned in a  <code>PhasePartition</code> with the fields</p><ul><li><code>r.tot</code> total mixing ratio</li><li><code>r.liq</code> liquid mixing ratio</li><li><code>r.ice</code> ice mixing ratio</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L213-L221">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.specific_volume"><a class="docstring-binding" href="#Thermodynamics.specific_volume"><code>Thermodynamics.specific_volume</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">specific_volume(param_set, ts::ThermodynamicState)</code></pre><p>The (moist-)air specific volume.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L122-L126">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.q_vap_from_RH_liquid"><a class="docstring-binding" href="#Thermodynamics.q_vap_from_RH_liquid"><code>Thermodynamics.q_vap_from_RH_liquid</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">q_vap_from_RH_liquid(param_set, p, T, RH)</code></pre><p>Compute the vapor specific humidity from the relative humidity over liquid.</p><p><strong>Arguments</strong></p><ul><li><code>param_set</code>: thermodynamics parameter set, see <a href="#Thermodynamics"><code>Thermodynamics</code></a></li><li><code>p</code>: pressure [Pa]</li><li><code>T</code>: temperature [K]</li><li><code>RH</code>: relative humidity [dimensionless], 0 ≤ RH ≤ 1</li></ul><p><strong>Returns</strong></p><ul><li><code>q_vap</code>: vapor specific humidity [kg/kg]</li></ul><p>This function is deprecated. Use <code>q_vap_from_RH</code> with <code>Liquid()</code> instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/air_humidities.jl#L196-L211">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.temperature_and_humidity_given_TᵥρRH"><a class="docstring-binding" href="#Thermodynamics.temperature_and_humidity_given_TᵥρRH"><code>Thermodynamics.temperature_and_humidity_given_TᵥρRH</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">temperature_and_humidity_given_TᵥρRH(param_set, T_virt, ρ, RH, phase_type, maxiter, tol)</code></pre><p>Compute temperature and total specific humidity given virtual temperature, density, and relative humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L17-L21">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.liquid_ice_pottemp_sat"><a class="docstring-binding" href="#Thermodynamics.liquid_ice_pottemp_sat"><code>Thermodynamics.liquid_ice_pottemp_sat</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_sat(param_set, ts::ThermodynamicState)</code></pre><p>The liquid potential temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L188-L192">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_sat(param_set, T, ρ, phase_type[, q::PhasePartition, cpm])</code></pre><p>The saturated liquid ice potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a>. </li></ul><p>When <code>q</code> is not provided, the air assumed to be dry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L1043-L1058">source</a></section><section><div><pre><code class="language-julia hljs">liquid_ice_pottemp_sat(param_set, T, ρ, phase_type, q_tot)</code></pre><p>The saturated liquid ice potential temperature.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>q_tot</code> total specific humidity</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L1071-L1081">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhasePartition_equil"><a class="docstring-binding" href="#Thermodynamics.PhasePartition_equil"><code>Thermodynamics.PhasePartition_equil</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhasePartition_equil(param_set, ts::ThermodynamicState)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_state_methods.jl#L619-L623">source</a></section><section><div><pre><code class="language-julia hljs">PhasePartition_equil(param_set, T, ρ, q_tot, phase_type)
PhasePartition_equil(param_set, T, ρ, q_tot, p_vap_sat, λ)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a> object.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li><li><code>p_vap_sat</code> saturation vapor pressure</li><li><code>λ</code> liquid fraction</li></ul><p>The residual <code>q.tot - q.liq - q.ice</code> is the vapor specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L82-L97">source</a></section><section><div><pre><code class="language-julia hljs">PhasePartition_equil(param_set, T, ρ, q_tot, phase_type)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a> object.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>ρ</code> air density</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>If the specific humidity <code>q_tot</code> exceeds the saturation specific humidity <code>q_vap_sat</code> (computed using <code>ρ</code>, <code>T</code> and the saturation vapor pressure), the condensate is partitioned into liquid and ice. The fraction of liquid is given by the temperature dependent <code>liquid_fraction_ramp(param_set, T)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L105-L120">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhasePartition_equil_given_p"><a class="docstring-binding" href="#Thermodynamics.PhasePartition_equil_given_p"><code>Thermodynamics.PhasePartition_equil_given_p</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhasePartition_equil_given_p(param_set, T, p, q_tot, phase_type)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#Thermodynamics.PhasePartition"><code>PhasePartition</code></a> object using the <a href="#Thermodynamics.liquid_fraction"><code>liquid_fraction</code></a> function.</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>T</code> temperature</li><li><code>p</code> air pressure</li><li><code>q_tot</code> total specific humidity</li><li><code>phase_type</code> a thermodynamic state type</li></ul><p>The residual <code>q.tot - q.liq - q.ice</code> is the vapor specific humidity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_phase_partition_methods.jl#L140-L152">source</a></section></details></article><h2 id="Thermodynamic-State-Constructors-(Deprecated)"><a class="docs-heading-anchor" href="#Thermodynamic-State-Constructors-(Deprecated)">Thermodynamic State Constructors (Deprecated)</a><a id="Thermodynamic-State-Constructors-(Deprecated)-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamic-State-Constructors-(Deprecated)" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Thermodynamics.ThermodynamicState"><a class="docstring-binding" href="#Thermodynamics.ThermodynamicState"><code>Thermodynamics.ThermodynamicState</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ThermodynamicState{FT}</code></pre><p>A thermodynamic state representing the complete thermodynamic properties of a moist air parcel. All <code>ThermodynamicState</code> subtypes provide access to functions to compute all other thermodynamic properties through the equation of state and thermodynamic relations.</p><p>The state can be initialized using various thermodynamic formulations (via its subtypes), each representing different assumptions about phase equilibrium and the specific variables used to define the state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L31-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhasePartition"><a class="docstring-binding" href="#Thermodynamics.PhasePartition"><code>Thermodynamics.PhasePartition</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PhasePartition</code></pre><p>Represents the mass fractions of the moist air mixture (the partitioning of water substance  between vapor, liquid, and ice phases).</p><p>The total specific humidity <code>q_tot</code> represents the total water content, while <code>q_liq</code> and <code>q_ice</code> represent the liquid and ice specific humidities, respectively. The vapor specific humidity is computed as <code>q_vap = q_tot - q_liq - q_ice</code>.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhasePartition(q_tot::Real[, q_liq::Real[, q_ice::Real]])
PhasePartition(param_set::APS, ts::ThermodynamicState)</code></pre><p>See also <a href="#Thermodynamics.PhasePartition_equil"><code>PhasePartition_equil</code></a></p><p><strong>Fields</strong></p><ul><li><code>tot</code>: total specific humidity</li><li><code>liq</code>: liquid water specific humidity (default: <code>0</code>)</li><li><code>ice</code>: ice specific humidity (default: <code>0</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_PhasePartitionTypes.jl#L11-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry"><a class="docstring-binding" href="#Thermodynamics.PhaseDry"><code>Thermodynamics.PhaseDry</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry{FT} &lt;: AbstractPhaseDry</code></pre><p>A dry thermodynamic state representing air with no water vapor (<code>q_tot = 0</code>). This state assumes the air parcel contains only dry air components.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhaseDry(param_set, e_int, ρ)</code></pre><p><strong>Fields</strong></p><ul><li><code>e_int</code>: internal energy</li><li><code>ρ</code>: density of dry air</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L50-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_ρe"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_ρe"><code>Thermodynamics.PhaseDry_ρe</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_ρe(param_set, ρ, e_int)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from density and internal energy, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> air density</li><li><code>e_int</code> specific internal energy</li></ul><p>This constructor directly stores the provided density and internal energy without any additional computations, assuming the air is completely dry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L174-L184">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_pT"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_pT"><code>Thermodynamics.PhaseDry_pT</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_pT(param_set, p, T)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from pressure and temperature, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li></ul><p>The internal energy is computed from the temperature using the dry air equation of state, and the density is computed from the ideal gas law using the pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L190-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_pθ"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_pθ"><code>Thermodynamics.PhaseDry_pθ</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_pθ(param_set, p, θ_dry)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from pressure and dry potential temperature, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>θ_dry</code> dry potential temperature</li></ul><p>The temperature is computed from the pressure and potential temperature using the Exner function, and the density is computed from the ideal gas law using the pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L273-L283">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_pe"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_pe"><code>Thermodynamics.PhaseDry_pe</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_pe(param_set, p, e_int)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from pressure and internal energy, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>e_int</code> specific internal energy</li></ul><p>The temperature is computed from the internal energy using the dry air equation of state, and the density is computed from the ideal gas law using the pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L208-L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_ph"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_ph"><code>Thermodynamics.PhaseDry_ph</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs"> PhaseDry_ph(param_set, p, h)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from pressure and specific enthalpy, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>h</code> specific enthalpy</li></ul><p>The temperature is computed from the specific enthalpy using the dry air equation of state, and the density is computed from the ideal gas law using the pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L231-L241">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_ρθ"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_ρθ"><code>Thermodynamics.PhaseDry_ρθ</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_ρθ(param_set, ρ, θ_dry)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from density and dry potential temperature, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>θ_dry</code> dry potential temperature</li></ul><p>The temperature is computed from the density and potential temperature using the dry air equation of state, and the internal energy is computed from the temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L250-L260">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_ρT"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_ρT"><code>Thermodynamics.PhaseDry_ρT</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_ρT(param_set, ρ, T)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from density and temperature, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>T</code> temperature</li></ul><p>The internal energy is computed directly from the temperature using the dry air equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L297-L306">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseDry_ρp"><a class="docstring-binding" href="#Thermodynamics.PhaseDry_ρp"><code>Thermodynamics.PhaseDry_ρp</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseDry_ρp(param_set, ρ, p)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseDry"><code>PhaseDry</code></a> thermodynamic state from density and pressure, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>p</code> pressure</li></ul><p>The temperature is computed from the ideal gas law using the pressure and density, and the internal energy is computed from the temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L313-L323">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil"><code>Thermodynamics.PhaseEquil</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil{FT} &lt;: AbstractPhaseEquil</code></pre><p>A thermodynamic state assuming thermodynamic equilibrium between water phases. This state assumes that the water vapor is in equilibrium with liquid and/or ice, requiring saturation adjustment to compute the temperature and phase partitioning.</p><p>The state stores the density, pressure, internal energy, total specific humidity, and the computed temperature from saturation adjustment.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhaseEquil(param_set, ρ, e_int, q_tot)</code></pre><p><strong>Fields</strong></p><ul><li><code>ρ</code>: density of air (potentially moist)</li><li><code>p</code>: air pressure</li><li><code>e_int</code>: internal energy</li><li><code>q_tot</code>: total specific humidity</li><li><code>T</code>: temperature: computed via <a href="#Thermodynamics.saturation_adjustment"><code>saturation_adjustment</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L80-L101">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_ρeq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_ρeq"><code>Thermodynamics.PhaseEquil_ρeq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_ρeq(param_set, ρ, e_int, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from density, internal energy, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>e_int</code> specific internal energy</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for saturation adjustment (default: 8)</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment (default: 1e-4)</li><li><code>sat_adjust_method</code> the numerical method to use for saturation adjustment (default: NewtonsMethod)  See the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>The temperature is computed using saturation adjustment to ensure thermodynamic equilibrium, and the pressure is computed from the equation of state using the temperature and density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L337-L354">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_ρTq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_ρTq"><code>Thermodynamics.PhaseEquil_ρTq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_ρTq(param_set, ρ, T, q_tot)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from density, temperature, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>T</code> temperature</li><li><code>q_tot</code> total specific humidity</li></ul><p>The phase partitioning is computed assuming thermodynamic equilibrium at the given temperature, and the pressure and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L459-L470">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_pTq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_pTq"><code>Thermodynamics.PhaseEquil_pTq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_pTq(param_set, p, T, q_tot)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from pressure, temperature, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> temperature</li><li><code>q_tot</code> total specific humidity</li></ul><p>The phase partitioning is computed assuming thermodynamic equilibrium at the given temperature, and the density and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L486-L497">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_pθq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_pθq"><code>Thermodynamics.PhaseEquil_pθq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_pθq(param_set, p, θ_li, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from pressure, liquid-ice potential temperature, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> air pressure</li><li><code>θ_li</code> liquid-ice potential temperature</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for saturation adjustment (default: 50)</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment (default: 1e-4)</li><li><code>sat_adjust_method</code> the numerical method to use for saturation adjustment (default: SecantMethod)  See the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>The temperature is computed using saturation adjustment with respect to the liquid-ice potential temperature, and the density and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L680-L697">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_peq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_peq"><code>Thermodynamics.PhaseEquil_peq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_peq(param_set, p, e_int, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from pressure, internal energy, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>e_int</code> specific internal energy</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for saturation adjustment (default: 40)</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment (default: 1e-4)</li><li><code>sat_adjust_method</code> the numerical method to use for saturation adjustment (default: SecantMethod)  See the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>The temperature is computed using saturation adjustment given pressure and internal energy, and the density is computed from the equation of state using the pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L514-L531">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_phq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_phq"><code>Thermodynamics.PhaseEquil_phq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_phq(param_set, p, h, q_tot[, maxiter, relative_temperature_tol, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from pressure, specific enthalpy, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>h</code> specific enthalpy</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for saturation adjustment (default: 40)</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment (default: 1e-4)</li><li><code>sat_adjust_method</code> the numerical method to use for saturation adjustment (default: SecantMethod)  See the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>The temperature is computed using saturation adjustment given pressure and specific enthalpy, and the density and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L565-L582">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_ρθq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_ρθq"><code>Thermodynamics.PhaseEquil_ρθq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_ρθq(param_set, ρ, θ_li, q_tot[, maxiter, relative_temperature_tol, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from density, liquid-ice potential temperature, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>θ_li</code> liquid-ice potential temperature</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for saturation adjustment (default: 36)</li><li><code>relative_temperature_tol</code> relative temperature tolerance for saturation adjustment (default: 1e-4)</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>The temperature is computed using saturation adjustment with respect to the liquid-ice potential temperature, and the pressure and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L412-L427">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseEquil_ρpq"><a class="docstring-binding" href="#Thermodynamics.PhaseEquil_ρpq"><code>Thermodynamics.PhaseEquil_ρpq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseEquil_ρpq(param_set, ρ, p, q_tot[, perform_sat_adjust=true, maxiter, sat_adjust_method, T_guess])</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from density, pressure, and total specific humidity, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>p</code> pressure</li><li><code>q_tot</code> total specific humidity</li></ul><p>and, optionally</p><ul><li><code>perform_sat_adjust</code> Boolean indicating whether to perform saturation adjustment (default: false)</li><li><code>maxiter</code> maximum number of iterations to perform in saturation adjustment (default: 5)</li><li><code>sat_adjust_method</code> the numerical method to use for saturation adjustment (default: NewtonsMethodAD)  See the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for options.</li><li><code>T_guess</code> initial guess for temperature in saturation adjustment</li></ul><p>If <code>perform_sat_adjust</code> is true, the temperature is computed using saturation adjustment. Otherwise, the temperature is computed directly from the ideal gas law. The internal energy is computed from the temperature and phase partitioning.</p><p>TODO: change input argument order: perform<em>sat</em>adjust is       unique to this constructor, so it should be last.       (breaking change)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L617-L639">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil"><code>Thermodynamics.PhaseNonEquil</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs"> PhaseNonEquil{FT} &lt;: ThermodynamicState</code></pre><p>A thermodynamic state assuming thermodynamic non-equilibrium between water phases. This state allows for arbitrary phase partitioning without requiring saturation adjustment, enabling direct computation of temperature from the given thermodynamic variables.</p><p>The state stores the internal energy, density, and a complete phase partition specifying the distribution of water substance between vapor, liquid, and ice phases.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs">PhaseNonEquil(param_set, e_int, q::PhasePartition, ρ)</code></pre><p><strong>Fields</strong></p><ul><li><code>e_int</code>: internal energy</li><li><code>ρ</code>: density of air (potentially moist)</li><li><code>q</code>: phase partition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L121-L141">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_ρTq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_ρTq"><code>Thermodynamics.PhaseNonEquil_ρTq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_ρTq(param_set, ρ, T, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from density, temperature, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>T</code> temperature</li><li><code>q_pt</code> phase partition</li></ul><p>The internal energy is computed from the temperature and phase partition using the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L740-L750">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_pTq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_pTq"><code>Thermodynamics.PhaseNonEquil_pTq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_pTq(param_set, p, T, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from pressure, temperature, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>T</code> air temperature</li><li><code>q_pt</code> phase partition</li></ul><p>The density is computed from the ideal gas law using the pressure and temperature, and the internal energy is computed from the temperature and phase partition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L828-L839">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_ρθq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_ρθq"><code>Thermodynamics.PhaseNonEquil_ρθq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_ρθq(param_set, ρ, θ_li, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from density, liquid-ice potential temperature, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> (moist-)air density</li><li><code>θ_li</code> liquid-ice potential temperature</li><li><code>q_pt</code> phase partition</li></ul><p>and, optionally</p><ul><li><code>maxiter</code> maximum iterations for non-linear equation solve (default: 10)</li><li><code>relative_temperature_tol</code> relative temperature tolerance for non-linear equation solve (default: 1e-2)</li></ul><p>The temperature is computed from the density and liquid-ice potential temperature using a non-linear solver, and the internal energy is computed from the temperature and phase partition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L763-L777">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_pθq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_pθq"><code>Thermodynamics.PhaseNonEquil_pθq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_pθq(param_set, p, θ_li, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from pressure, liquid-ice potential temperature, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>θ_li</code> liquid-ice potential temperature</li><li><code>q_pt</code> phase partition</li></ul><p>The temperature is computed from the pressure and liquid-ice potential temperature, and the density and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L802-L813">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_peq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_peq"><code>Thermodynamics.PhaseNonEquil_peq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_peq(param_set, p, e_int, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from pressure, internal energy, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>e_int</code> specific internal energy</li><li><code>q_pt</code> phase partition</li></ul><p>The temperature is computed from the internal energy and phase partition using the equation of state, and the density is computed from the ideal gas law using the pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L853-L864">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_phq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_phq"><code>Thermodynamics.PhaseNonEquil_phq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_phq(param_set, p, h, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from pressure, specific enthalpy, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>p</code> pressure</li><li><code>h</code> specific enthalpy</li><li><code>q_pt</code> phase partition</li></ul><p>The temperature is computed from the specific enthalpy and phase partition using the equation of state, and the density and internal energy are computed from the equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L878-L889">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Thermodynamics.PhaseNonEquil_ρpq"><a class="docstring-binding" href="#Thermodynamics.PhaseNonEquil_ρpq"><code>Thermodynamics.PhaseNonEquil_ρpq</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PhaseNonEquil_ρpq(param_set, ρ, p, q_pt)</code></pre><p>Constructs a <a href="#Thermodynamics.PhaseNonEquil"><code>PhaseNonEquil</code></a> thermodynamic state from density, pressure, and phase partition, given</p><ul><li><code>param_set</code> a thermodynamics parameter set, see the <a href="#Thermodynamics"><code>Thermodynamics</code></a> for more details</li><li><code>ρ</code> density</li><li><code>p</code> pressure</li><li><code>q_pt</code> phase partition</li></ul><p>The temperature is computed from the ideal gas law using the pressure and density, and the internal energy is computed from the temperature and phase partition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/Thermodynamics.jl/blob/0b5ee762315de8ecec03e4e2e0a729881611dca6/src/depr_air_states.jl#L904-L915">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../TestedProfiles/">« Tested Profiles</a><a class="docs-footer-nextpage" href="../References/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 13 January 2026 19:51">Tuesday 13 January 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
